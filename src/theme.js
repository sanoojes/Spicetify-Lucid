(async () => { while (!Spicetify.React || !Spicetify.ReactDOM) { await new Promise((resolve) => setTimeout(resolve, 10));}"use strict";var Lucid=(()=>{var Io=Object.defineProperty,To=Object.defineProperties;var Lo=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var De=(t,o,e)=>o in t?Io(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,s=(t,o)=>{for(var e in o||(o={}))ut.call(o,e)&&De(t,e,o[e]);if(ye)for(var e of ye(o))dt.call(o,e)&&De(t,e,o[e]);return t},p=(t,o)=>To(t,Lo(o));var mt=(t,o)=>{var e={};for(var r in t)ut.call(t,r)&&o.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&ye)for(var r of ye(t))o.indexOf(r)<0&&dt.call(t,r)&&(e[r]=t[r]);return e};var c=(t,o,e)=>De(t,typeof o!="symbol"?o+"":o,e);var B={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")},$r={defaultMerge:B.defaultMerge};function Bo(t,o){return o}function Mo(t,o){return t.filter(e=>e!==void 0)}var gt;(function(t){t[t.NOT=0]="NOT",t[t.RECORD=1]="RECORD",t[t.ARRAY=2]="ARRAY",t[t.SET=3]="SET",t[t.MAP=4]="MAP",t[t.OTHER=5]="OTHER"})(gt||(gt={}));function ht(t){return typeof t!="object"||t===null?0:Array.isArray(t)?2:Ro(t)?1:t instanceof Set?3:t instanceof Map?4:5}function Po(t){let o=new Set;for(let e of t)for(let r of[...Object.keys(e),...Object.getOwnPropertySymbols(e)])o.add(r);return o}function Oo(t,o){return typeof t=="object"&&Object.prototype.propertyIsEnumerable.call(t,o)}function bt(t){var r;let o=0,e=(r=t[0])==null?void 0:r[Symbol.iterator]();return{[Symbol.iterator](){return{next(){var i;do{if(e===void 0)return{done:!0,value:void 0};let a=e.next();if(a.done===!0){o+=1,e=(i=t[o])==null?void 0:i[Symbol.iterator]();continue}return{done:!1,value:a.value}}while(!0)}}}}}var ft=["[object Object]","[object Module]"];function Ro(t){if(!ft.includes(Object.prototype.toString.call(t)))return!1;let{constructor:o}=t;if(o===void 0)return!0;let e=o.prototype;return!(e===null||typeof e!="object"||!ft.includes(Object.prototype.toString.call(e))||!e.hasOwnProperty("isPrototypeOf"))}function Ao(t,o,e){let r={};for(let i of Po(t)){let a=[];for(let d of t)Oo(d,i)&&a.push(d[i]);if(a.length===0)continue;let l=o.metaDataUpdater(e,{key:i,parents:t}),u=yt(a,o,l);u!==B.skip&&(i==="__proto__"?Object.defineProperty(r,i,{value:u,configurable:!0,enumerable:!0,writable:!0}):r[i]=u)}return r}function Fo(t){return t.flat()}function Ho(t){return new Set(bt(t))}function Uo(t){return new Map(bt(t))}function $o(t){return t.at(-1)}var ve={mergeRecords:Ao,mergeArrays:Fo,mergeSets:Ho,mergeMaps:Uo,mergeOthers:$o};function Se(...t){return Vo({})(...t)}function Vo(t,o){let e=No(t,r);function r(...i){return yt(i,e,o)}return r}function No(t,o){var e,r,i;return{defaultMergeFunctions:ve,mergeFunctions:s(s({},ve),Object.fromEntries(Object.entries(t).filter(([a,l])=>Object.hasOwn(ve,a)).map(([a,l])=>l===!1?[a,ve.mergeOthers]:[a,l]))),metaDataUpdater:(e=t.metaDataUpdater)!=null?e:Bo,deepmerge:o,useImplicitDefaultMerging:(r=t.enableImplicitDefaultMerging)!=null?r:!1,filterValues:t.filterValues===!1?void 0:(i=t.filterValues)!=null?i:Mo,actions:B}}function yt(t,o,e){var a,l;let r=(l=(a=o.filterValues)==null?void 0:a.call(o,t,e))!=null?l:t;if(r.length===0)return;if(r.length===1)return Ge(r,o,e);let i=ht(r[0]);if(i!==0&&i!==5){for(let u=1;u<r.length;u++)if(ht(r[u])!==i)return Ge(r,o,e)}switch(i){case 1:return Do(r,o,e);case 2:return Go(r,o,e);case 3:return zo(r,o,e);case 4:return Ko(r,o,e);default:return Ge(r,o,e)}}function Do(t,o,e){let r=o.mergeFunctions.mergeRecords(t,o,e);return r===B.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeRecords!==o.defaultMergeFunctions.mergeRecords?o.defaultMergeFunctions.mergeRecords(t,o,e):r}function Go(t,o,e){let r=o.mergeFunctions.mergeArrays(t,o,e);return r===B.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeArrays!==o.defaultMergeFunctions.mergeArrays?o.defaultMergeFunctions.mergeArrays(t):r}function zo(t,o,e){let r=o.mergeFunctions.mergeSets(t,o,e);return r===B.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeSets!==o.defaultMergeFunctions.mergeSets?o.defaultMergeFunctions.mergeSets(t):r}function Ko(t,o,e){let r=o.mergeFunctions.mergeMaps(t,o,e);return r===B.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeMaps!==o.defaultMergeFunctions.mergeMaps?o.defaultMergeFunctions.mergeMaps(t):r}function Ge(t,o,e){let r=o.mergeFunctions.mergeOthers(t,o,e);return r===B.defaultMerge||o.useImplicitDefaultMerging&&r===void 0&&o.mergeFunctions.mergeOthers!==o.defaultMergeFunctions.mergeOthers?o.defaultMergeFunctions.mergeOthers(t):r}function vt(t,o){if(!o)return t;let e=o.split(/[.\[\]'"]/).filter(Boolean),r=t;for(let i of e)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}var ze=class{constructor(o,e={}){c(this,"state");c(this,"subscribers",[]);c(this,"options");if(this.options=s({persist:!1,localStorageKey:"storeState"},e),this.options.persist&&this.options.localStorageKey){let r=localStorage.getItem(this.options.localStorageKey);if(!r){this.state=o;return}try{let i=JSON.parse(r);this.state=Se(o,i)}catch(i){console.error("Error parsing stored state from localStorage:",i),this.state=o}}else this.state=o}getState(){return this.state}setState(o,e){let r=s({},this.state),i=o(this.state,e);this.updateStateAndNotify(i,r)}updateStateAndNotify(o,e){o!==this.state&&(this.state=o,this.notifySubscribers(e),this.options.persist&&this.persist())}subscribe(o,e){let r={subscriber:o,path:e};return this.subscribers.push(r),()=>{this.subscribers=this.subscribers.filter(i=>i!==r)}}notifySubscribers(o){for(let e of this.subscribers){let{subscriber:r,path:i}=e,a=vt(o,i),l=vt(this.state,i);if(JSON.stringify(a)!==JSON.stringify(l)){let u=performance.now();try{r(this.state)}catch(n){console.error(`Subscriber at path "${i}" threw an error:`,n)}let d=performance.now()-u;d>10&&console.warn(`Slow subscriber at path "${i}" took ${d.toFixed(2)}ms. Subscriber: ${r}`)}}}persist(){try{if(this.options.localStorageKey)localStorage.setItem(this.options.localStorageKey,JSON.stringify(this.state));else throw new Error("localStorage key not found!")}catch(o){console.error("Error saving state to localStorage:",o)}}},G=ze;function f(t){return t!==null&&typeof t=="object"}function _e(t){return f(t)&&(t.blur===void 0||typeof t.blur=="number")&&(t.brightness===void 0||typeof t.brightness=="number")&&(t.contrast===void 0||typeof t.contrast=="number")&&(t.grayscale===void 0||typeof t.grayscale=="string")&&(t.hueRotate===void 0||typeof t.hueRotate=="string")&&(t.invert===void 0||typeof t.invert=="string")&&(t.opacity===void 0||typeof t.opacity=="number")&&(t.saturate===void 0||typeof t.saturate=="number")&&(t.sepia===void 0||typeof t.sepia=="string")}function Z(t){return f(t)&&typeof t.hex=="string"&&typeof t.alpha=="number"}function Wo(t){return f(t)&&typeof t.url=="string"}function qo(t){return f(t)&&Array.isArray(t.selectedIds)&&t.selectedIds.every(o=>typeof o=="number")&&f(t.slideshow)&&typeof t.slideshow.isSlideshow=="boolean"&&typeof t.slideshow.timeDelay=="number"}function Yo(t){return!f(t)||typeof t.isCustom!="boolean"||t.type!=="url"&&t.type!=="local"||!f(t.options)?!1:t.type==="url"?Wo(t.options.url):t.type==="local"?qo(t.options.local):!1}function Zo(t){return f(t)&&Yo(t.customImage)&&(t.filter===void 0||_e(t.filter))}function Jo(t){return f(t)&&Z(t.color)}function Xo(t){return f(t)&&_e(t.filter)}function Qo(t){return f(t)&&Zo(t.static)&&Jo(t.solid)&&Xo(t.animated)}function jo(t){return f(t)&&typeof t.mode=="string"&&(t.mode==="static"||t.mode==="solid"||t.mode==="animated")&&Qo(t.options)}function er(t){return f(t)&&typeof t.thickness=="number"&&Z(t.color)&&typeof t.style=="string"}function tr(t){return f(t)&&(t.mode==="compact"||t.mode==="normal")&&(t.position==="bottom left"||t.position==="bottom right"||t.position==="top left"||t.position==="top right")&&typeof t.blur=="number"&&typeof t.size=="number"&&typeof t.isCustomBg=="boolean"&&Z(t.color)}function or(t){return f(t)?["normal","expanded","npv"].every(e=>{let r=t[e];return f(r)&&typeof r.isScaling=="boolean"&&typeof r.isScroll=="boolean"&&(r.filter===null||_e(r.filter))}):!1}function rr(t){return f(t)&&(t.type==="npv"||t.type==="normal")&&or(t.options)}function ir(t){return f(t)&&typeof t.panelGap=="number"&&typeof t.hideHomeHeader=="boolean"&&typeof t.style=="string"&&rr(t.umv)}function nr(t){return f(t)&&typeof t.isDynamic=="boolean"&&typeof t.isCustom=="boolean"&&typeof t.isTonal=="boolean"&&Z(t.customColor)}function ar(t){return f(t)&&_e(t.backdropFilter)&&typeof t.height=="number"&&typeof t.paddingX=="number"&&Z(t.bgColor)&&typeof t.bgOpacity=="number"&&typeof t.borderRadius=="number"}function sr(t){return f(t)?["compact","normal"].every(e=>ar(t[e])):!1}function lr(t){return f(t)&&(t.type==="compact"||t.type==="normal")&&sr(t.options)&&typeof t.isFloating=="boolean"&&typeof t.hideIcons=="boolean"}function cr(t){return f(t)&&(t.type==="default"||t.type==="starry"||t.type==="none")}function Ee(t){return f(t)&&(t.position==="context-menu"||t.position==="nav")&&jo(t.background)&&er(t.border)&&ir(t.pages)&&nr(t.color)&&f(t.control)&&typeof t.control.height=="number"&&f(t.font)&&typeof t.font.fontFamily=="string"&&(typeof t.font.fontUrl=="string"||t.font.fontUrl===null)&&typeof t.font.isGoogleFonts=="boolean"&&cr(t.grains)&&lr(t.playbar)&&tr(t.rightSidebar)}var J="https://raw.githubusercontent.com/sanoojes/Spicetify-Lucid/refs/heads/main",X="https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main",Q="2.1.1",j="lucid-guided-tour",St=[`${J}/src/workers/getColor.js`,`${X}/src/workers/getColor.js`],we="LUCID_COLOR_SCRIPT_CACHE",_t="#1bc858",Ce="LUCID_GUIDE_SCRIPT_CACHE",Et=[`${J}/src/guidedTour.js`,`${X}/src/guidedTour.js`],wt="lucid-theme-settings",V="lucid-current-version",Ct=[`${J}/changelog.json`,`${X}/changelog.json`],ke="lucid-changelog-data",xe="LucidIDB",kt=[`${J}/src/icons.css`,`${X}/src/icons.css`,`${J}/styles/icons.css`,`${X}/styles/icons.css`];var Ke={showChangelog:!0,position:"nav",background:{mode:"static",options:{static:{isCustomImage:!1,filter:{blur:32,brightness:60,saturate:150}},solid:{color:{hex:"#1a211c",alpha:100}},animated:{filter:{blur:32,brightness:60,saturate:150}}}},color:{customColor:{hex:"#00ffa1",alpha:100},isTonal:!0,isCustom:!1,isDynamic:!1,extractorOptions:{pixels:36e4,distance:.1,hueDistance:.2,lightnessDistance:.2,saturationDistance:.2}},pages:{panelGap:8,hideHomeHeader:!1,style:"card",imageStyle:"default",umv:{type:"normal",options:{expanded:{isScroll:!1,isScaling:!0,filter:{blur:0}},custom:{url:"https://picsum.photos/1920/1080?random",isScroll:!1,isScaling:!0,filter:{blur:8}},normal:{isScroll:!1,isScaling:!0,filter:{blur:8}},npv:{isScroll:!1,isScaling:!0,filter:{blur:8}}}}},border:{thickness:1,color:{hex:"#454545",alpha:50},style:"solid"},control:{height:40},font:{fontFamily:"Poppins",fontUrl:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",isGoogleFonts:!0},grains:{type:"starry"},rightSidebar:{isCustomBg:!1,mode:"normal",position:"bottom right",blur:16,size:240,color:{hex:"#1a211c",alpha:50}},playbar:{type:"normal",hideIcons:!0,options:{normal:{height:80,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}},compact:{height:64,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}}},isFloating:!0},customImage:{type:"url",options:{url:{data:"https://picsum.photos/1920/1080?random"},local:null}}};var b=(t,o=!1,e)=>{for(;!Spicetify.showNotification;)setTimeout(b,500);console.debug(`Notification: ${t} (Error: ${o}, Timeout: ${e})`),Spicetify.showNotification(t,o,e)};var We=class extends G{constructor(o=Ke,e={persist:!0,localStorageKey:wt}){super(o,e)}setChangelog(o){this.setState(e=>p(s({},e),{showChangelog:o}))}setPages(o){this.setState(e=>p(s({},e),{pages:s(s({},e.pages),o)}))}setUMV(o){this.setState(e=>p(s({},e),{pages:p(s({},e.pages),{umv:s(s({},e.pages.umv),o)})}))}setUMVOption(o,e){this.setState(r=>p(s({},r),{pages:p(s({},r.pages),{umv:p(s({},r.pages.umv),{options:p(s({},r.pages.umv.options),{[o]:s(s({},r.pages.umv.options[o]),e)})})})}))}setUMVFilter(o,e){this.setState(r=>p(s({},r),{pages:p(s({},r.pages),{umv:p(s({},r.pages.umv),{options:p(s({},r.pages.umv.options),{[o]:p(s({},r.pages.umv.options[o]),{filter:s(s({},r.pages.umv.options[o].filter),e)})})})})}))}setCustomImageType(o){this.setState(e=>p(s({},e),{customImage:p(s({},e.customImage),{type:o})}))}setCustomImageOptions(o,e){this.setState(r=>p(s({},r),{customImage:p(s({},r.customImage),{options:p(s({},r.customImage.options),{[o]:s(s({},r.customImage.options[o]),e)})})}))}setPosition(o){this.setState(e=>p(s({},e),{position:o}))}setBackgroundMode(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{mode:o})}))}setStaticBackgroundOptions(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{static:s(s({},e.background.options.static),o)})})}))}setStaticBackgroundFilter(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{static:p(s({},e.background.options.static),{filter:s(s({},e.background.options.static.filter),o)})})})}))}setAnimatedBackgroundFilter(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{animated:p(s({},e.background.options.animated),{filter:s(s({},e.background.options.animated.filter),o)})})})}))}setStaticBgFilter(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{static:p(s({},e.background.options.static),{filter:s(s({},e.background.options.static.filter),o)})})})}))}setSolidBackgroundColor(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{solid:p(s({},e.background.options.solid),{color:s(s({},e.background.options.solid.color),o)})})})}))}setAnimatedBackgroundOptions(o){this.setState(e=>p(s({},e),{background:p(s({},e.background),{options:p(s({},e.background.options),{animated:o})})}))}setBorder(o){this.setState(e=>p(s({},e),{border:s(s({},e.border),o)}))}setBorderColor(o){this.setState(e=>p(s({},e),{border:p(s({},e.border),{color:s(s({},e.border.color),o)})}))}setControlHeight(o){this.setState(e=>p(s({},e),{control:p(s({},e.control),{height:o})}))}setFont(o){this.setState(e=>p(s({},e),{font:s(s({},e.font),o)}))}setGrains(o){this.setState(e=>p(s({},e),{grains:s(s({},e.grains),o)}))}setRightSidebar(o){this.setState(e=>p(s({},e),{rightSidebar:s(s({},e.rightSidebar),o)}))}setColor(o){this.setState(e=>p(s({},e),{color:s(s({},e.color),o)}))}setColorExtractorOptions(o){this.setState(e=>p(s({},e),{color:p(s({},e.color),{extractorOptions:s(s({},e.color.extractorOptions),o)})}))}setPageStyle(o){this.setState(e=>p(s({},e),{pages:p(s({},e.pages),{style:o})}))}setPageImageStyle(o){this.setState(e=>p(s({},e),{pages:p(s({},e.pages),{imageStyle:o})}))}setPlaybar(o){this.setState(e=>p(s({},e),{playbar:s(s({},e.playbar),o)}))}setPlaybarOptions(o,e){this.setState(r=>p(s({},r),{playbar:p(s({},r.playbar),{options:p(s({},r.playbar.options),{[o]:s(s({},r.playbar.options[o]),e)})})}))}setPlaybarFilter(o,e){this.setState(r=>p(s({},r),{playbar:p(s({},r.playbar),{options:p(s({},r.playbar.options),{[o]:p(s({},r.playbar.options[o]),{backdropFilter:s(s({},r.playbar.options[o].backdropFilter),e)})})})}))}setRightSidebarColor(o){this.setState(e=>p(s({},e),{rightSidebar:p(s({},e.rightSidebar),{color:s(s({},e.rightSidebar.color),o)})}))}setGrainsType(o){this.setState(e=>p(s({},e),{grains:p(s({},e.grains),{type:o})}))}setDynamicColor(o){this.setState(e=>p(s({},e),{color:p(s({},e.color),{isDynamic:o})}))}setIsCustomColor(o){this.setState(e=>p(s({},e),{color:p(s({},e.color),{isCustom:o})}))}setCustomColor(o){this.setState(e=>p(s({},e),{color:p(s({},e.color),{customColor:s(s({},e.color.customColor),o)})}))}setTonalColor(o){this.setState(e=>p(s({},e),{color:p(s({},e.color),{isTonal:o})}))}resetState(){try{this.setState(()=>Ke),localStorage.removeItem(j),localStorage.removeItem(Ce),localStorage.removeItem(we),localStorage.removeItem(ke),localStorage.removeItem(V),window.location.reload()}catch(o){b("Error reseting settings.",!0,5e3),console.error("Error reseting settings.",o)}}exportSettings(){let o=qe.getState();return JSON.stringify(o,null,0)}importSettings(o){try{let e=JSON.parse(o);Ee(e)?(qe.setState(r=>Se(r,e)),b("Settings imported successfully!",!1,5e3)):(console.error("Invalid settings format."),b("Import failed: Invalid settings format.",!0,5e3))}catch(e){console.error("Error importing settings:",e),b("Import failed: Unable to parse settings JSON.",!0,5e3)}}},qe=new We,g=qe;function m(t,o){let e=document.createElement(t);if(!o)return e;if(o.attributes)for(let[u,d]of Object.entries(o.attributes))d?e.setAttribute(u,d):e.removeAttribute(u);o.style&&Object.assign(e.style,o.style);let l=o,{style:r,attributes:i}=l,a=mt(l,["style","attributes"]);return Object.assign(e,a),e}var xt=t=>{let o=document.getElementById(t);return o||(o=document.createElement(t),document.body.appendChild(o)),o},S=t=>{let o=document.querySelector(`#style-${t}`);return o||(o=m("style",{id:`style-${t}`}),document.body.appendChild(o)),o};var It=()=>{let t=document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image");return(t==null?void 0:t.src)||""},Tt=async()=>{var r,i;for(;!((r=Spicetify.Player)!=null&&r.data);)await new Promise(a=>setTimeout(a,50));let t=(i=Spicetify.Player.data)==null?void 0:i.item;return!t||!t.metadata?(console.error("No item or metadata found in Spicetify Player data."),""):[t.metadata.image_xlarge_url,t.metadata.image_large_url,t.metadata.image_url,t.metadata.image_small_url].find(a=>a)||It()||It()},Lt=async(t,o,e=3)=>{for(let r=0;r<=e;r++)try{return await Spicetify.GraphQL.Request(p(s({},t),{operation:"query",value:null}),o)}catch(i){if(i instanceof Error&&i.message.includes("DUPLICATE_REQUEST_ERROR")&&r<e){console.warn(`Retrying ${t.name}... (${r+1}/${e})`),await new Promise(a=>setTimeout(a,1e3));continue}throw console.error(`Error in ${t.name}:`,i),i}return null},pr=t=>Lt({name:"getAlbum",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d"},{uri:t,locale:null,offset:0,limit:50}),ur=t=>Lt({name:"queryArtistOverview",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497"},{uri:t,includePrerelease:!0,locale:null}),dr=t=>{let o=t.match(/\/(playlist|artist|album|user|show)\/([^/]+)/);if(!o)return console.warn("No valid type or ID found in pathname:",t),null;let[,e,r]=o;return`spotify:${e}:${r}`},Bt=async t=>{var i,a,l,u,d,n,h,y,D,be,Y,ct,pt;let o=dr(t);if(!o)return null;let[,e,r]=o.split(":");try{switch(e){case"playlist":case"show":return((i=(await Spicetify.Platform.PlaylistAPI.getMetadata(o)).images[0])==null?void 0:i.url)||null;case"artist":{let _=await ur(o),E=(l=(a=_==null?void 0:_.data)==null?void 0:a.artistUnion)==null?void 0:l.visuals;return((d=(u=E==null?void 0:E.headerImage)==null?void 0:u.sources[0])==null?void 0:d.url)||((h=(n=E==null?void 0:E.avatarImage)==null?void 0:n.sources[0])==null?void 0:h.url)||null}case"album":{let _=await pr(o),E=(be=(D=(y=_==null?void 0:_.data)==null?void 0:y.albumUnion)==null?void 0:D.coverArt)==null?void 0:be.sources;return((Y=E==null?void 0:E[2])==null?void 0:Y.url)||((ct=E==null?void 0:E[0])==null?void 0:ct.url)||null}case"user":{let _=await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${r}`).send();return((pt=_==null?void 0:_.body)==null?void 0:pt.image_url)||null}default:return null}}catch(_){return console.error(`Error fetching ${e} artwork:`,_),null}};function Mt(t){let o=t.match(/url\(["']?(.*?)["']?\)/);return o?o[1]:null}function M(t,o,e=100){let r=t.map(i=>document.querySelector(i));r.every(i=>i)?o(r):e>0&&setTimeout(M,300,t,o,--e)}var w=new G({url:null});async function Pt(){try{let t=await Tt();w.setState(()=>({url:t}))}catch(t){console.error("Error updating NPV state:",t),w.setState(()=>({url:null}))}}Pt();Spicetify.Player.addEventListener("songchange",Pt);var ee=class extends HTMLElement{constructor(e){super();c(this,"imgElement");c(this,"transitionDuration",.5);c(this,"filter","blur(0px)");c(this,"transitionTimingFunction","ease-in-out");e&&(this.imageSrc=e),Object.assign(this.style,{width:"100%",height:"100%",display:"block",willChange:"transform"}),this.imgElement=m("img",{className:"umv-img",style:{filter:this.filter,opacity:"1",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}}),this.append(this.imgElement)}setFilter(e){this.style.filter=e}set imageSrc(e){if(!e){this.style.opacity="0";return}if(this.style.opacity="1",e.trim()===""||this.imgElement.src===e)return;let r=new Image;r.onload=()=>{this._performTransition(e)},r.onerror=()=>{console.error("Failed to load image:",e)},r.src=e}_performTransition(e){if(this.imgElement.src===e)return;let r=this.imgElement,i=m("img",{className:"umv-img",style:{width:"100%",height:"100%",objectPosition:"center",position:"absolute",top:"0",left:"0",objectFit:"cover",filter:this.filter,opacity:"0",transform:"scale(1.05)",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}, transform ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}});i.src=e,this.appendChild(i),requestAnimationFrame(()=>{i.style.opacity="1",i.style.transform="scale(1)"}),r.style.opacity="0",r.style.transform="scale(0.95)",setTimeout(()=>{this.imgElement.remove(),this.imgElement=i},this.transitionDuration*1e3)}hideImage(){this.imgElement.style.opacity="0"}unhideImage(){this.imgElement.style.opacity="1"}};customElements.define("umv-image",ee);var mr=".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]",gr="umv-overrides",hr=".Root__main-view",Ot=".under-main-view",fr=".main-entityHeader-gradient, .XUwMufC5NCgIyRMyGXLD",br=`
  .under-main-view { display: none; }
  umv-container {
    width: 100%;
    display: block;
    position: absolute;
    inset: 0px;
    height: 50cqh;
    -webkit-mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    transform: translate3d(0px, 0px, 0px) scale(1);
    will-change: transform;
  }
  umv-container[source="expanded"] {
    height: calc(100cqh - var(--umv-offset, 526px));
    transform: translate3d(0px, 0px, 0px) scale(1);
    -webkit-mask-image: none;
    mask-image: none;
  }
  .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset) - 1rem);
  }
  body[npb-is-floating] .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset));
  }
  .main-entityHeader-container{ height: 40cqh; }
  .main-entityHeader-backgroundColor,.main-actionBarBackground-background { background: none !important;}
  .playlist-playlist-playlistContent,.EmeHQXR87mUskYK6xEde { background-color: rgba(var(--clr-surface-1-rgb),.5) !important; }
`,te=class extends HTMLElement{constructor(){super();c(this,"umvImage");c(this,"scrollElem");c(this,"mainViewElement");c(this,"_source");c(this,"_imageUrl");c(this,"_settings");c(this,"_isNpv",!1);c(this,"isArtist",!1);c(this,"options");c(this,"pageUrl");c(this,"umvArtUrl");c(this,"pageArtUrl");c(this,"unlistenHistory");c(this,"unobserveUMV");c(this,"unsubscribeNPV");let e=S(gr);e.textContent=br,this.mainViewElement=null,this.umvImage=new ee,this.append(this.umvImage),this._source="normal",this._imageUrl=null,this.pageUrl="",this._settings=null,this.settings=g.getState().pages.umv,g.subscribe(r=>{this.settings=r.pages.umv},"pages.umv"),this.scrollElem=null,this.umvArtUrl=null,this.pageArtUrl=null,this.unsubscribeNPV=null}connectedCallback(){var e,r,i;M([hr],([a])=>{this.mainViewElement=a}),M([mr],([a])=>{this.scrollElem=a,this._scrollEventCb=this._scrollEventCb.bind(this),this._listenScrollChange()}),this._listenForUMVChange(),this.updateImageUrlFromPage(((i=(r=(e=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:e.History)==null?void 0:r.location)==null?void 0:i.pathname)||"/")}disconnectedCallback(){this.scrollElem&&this.scrollElem.removeEventListener("scroll",this._scrollEventCb),this.unobserveUMV&&this.unobserveUMV(),this.unlistenHistory&&this.unlistenHistory(),this.unsubscribeNPV&&(this.unsubscribeNPV(),this.unsubscribeNPV=null)}set settings(e){this._settings=e,this.options=e.options[this._source],e.type==="npv"?this.isNpv=!0:this.isNpv=!1,this._scrollEventCb()}get settings(){var e;return(e=this._settings)!=null?e:g.getState().pages.umv}set isNpv(e){var r;if(this._isNpv=e,!e){(r=this.unsubscribeNPV)==null||r.call(this),this.unsubscribeNPV=null,this._updateImageBasedOnUrls();return}this._updateImageBasedOnUrls(),this.unsubscribeNPV=w.subscribe(()=>{this._updateImageBasedOnUrls()})}get isNpv(){return this._isNpv}set source(e){var r,i,a,l;this._source=e,this.setAttribute("source",e),this.isArtist=(i=(r=document.body.getAttribute("path"))==null?void 0:r.startsWith("artist",1))!=null?i:!1,this.options=this.settings.options[e],this.umvImage.setFilter(`blur(${(l=(a=this.settings.options[e].filter)==null?void 0:a.blur)!=null?l:0}px)`),this._scrollEventCb()}get source(){return this._source}set imageUrl(e){e!==this._imageUrl&&(this._imageUrl=e,this.umvImage.imageSrc=e)}async updateImageUrlFromPage(e){try{let r=null;if(r==="/"){this.pageArtUrl=null,this._updateImageBasedOnUrls();return}e&&(r=await Bt(e)),this.pageArtUrl=r,this._updateImageBasedOnUrls()}catch(r){console.error("Error updating image URL from page:",r),console.error("URL that caused the error:",e)}}_listenForPageChanges(){var e,r,i,a,l,u;this.pageUrl=((i=(r=(e=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:e.History)==null?void 0:r.location)==null?void 0:i.pathname)||"/",this.unlistenHistory=(u=(l=(a=Spicetify.Platform)==null?void 0:a.History)==null?void 0:l.listen(d=>{d!=null&&d.pathname&&(this.pageUrl=d.pathname,this.umvArtUrl=null,this.pageArtUrl=null,this.updateImageUrlFromPage(d.pathname))}))!=null?u:()=>{console.error("Error unloading History listener. Spicetify.Platform?.History might be undefined.")}}_observeUMVImage(){let e=document.querySelector(Ot);if(!e)return console.warn(`Element "${Ot}" not found. UMV observation will not work.`),null;let r=()=>{let a=e.querySelector(fr);if(a){let l=Mt(a.style.backgroundImage);l?this.umvArtUrl=l:this.umvArtUrl=null,this._updateImageBasedOnUrls()}else this.umvArtUrl=null,this._updateImageBasedOnUrls()},i=new MutationObserver(r);i.observe(e,{childList:!0,subtree:!0}),this.unobserveUMV=()=>i.disconnect()}_listenForUMVChange(){this._listenForPageChanges(),this._observeUMVImage()}_scrollEventCb(e){var a,l,u,d,n,h;if(!this.settings)return;let r=(d=(u=(a=this.scrollElem)==null?void 0:a.scrollTop)!=null?u:(l=e==null?void 0:e.target)==null?void 0:l.scrollTop)!=null?d:0,i=this.settings.options[this.source];r<100&&document.body.style.setProperty("--changing-pixels",`${Math.random().toFixed(1)}px`),requestAnimationFrame(()=>{var Y;i.isScaling?this.umvImage.style.transform=`scale(${Math.round(Math.min(100+r/10,175))}%)`:this.umvImage.style.transform="scale(1)",i.isScroll?this.style.transform=`translate3d(0px,-${Math.min(r,window.innerHeight)}px,0px)`:this.style.transform="translate3d(0px,0px,0px)";let y=Math.min(r/10+(((Y=i.filter)==null?void 0:Y.blur)||0),this.isArtist?r/10:32),D=Math.max(60,100-r/window.innerHeight*40),be=Math.max(70,100-r/window.innerHeight*30);this.umvImage.setFilter(`blur(${y}px) brightness(${D}%) opacity(${be}%)`)}),r>window.innerHeight/5?(n=this.mainViewElement)==null||n.style.setProperty("--top-bar-opacity","1"):(h=this.mainViewElement)==null||h.style.setProperty("--top-bar-opacity","0")}_listenScrollChange(){this.scrollElem&&this.scrollElem.addEventListener("scroll",this._scrollEventCb)}_updateImageBasedOnUrls(){if(this.umvArtUrl){this.imageUrl=this.umvArtUrl,this.source="expanded";return}if(this.settings.type==="custom"){this.source="custom",this.imageUrl=this.settings.options.custom.url;return}if(this.isNpv&&this.pageArtUrl){this.imageUrl=w.getState().url,this.source="npv";return}if(this.pageArtUrl){this.imageUrl=this.pageArtUrl,this.source="normal";return}this.imageUrl=null,this.source="normal"}};customElements.define("umv-container",te);function yr(){for(let t of kt)if(!document.querySelector(`link[href="${t}"]`)){let e=m("link",{rel:"stylesheet",href:t});document.head.appendChild(e)}}var Rt=()=>{try{yr();let t=(r,i=!1)=>i?o.get(r).replace(/[{0}{1}«»”“]/g,"").trim():o.get(r),o=Spicetify.Locale;if(!o)return;let e={home:t("view.web-player-home"),browse:t("browse"),pause:t("pause"),play:t("play"),close:t("close"),openMiniPlayer:t("miniplayer.open"),createPlaylist:t("contextmenu.create-playlist"),createButton:t("web-player.your-library-x.create.button-label"),fullscreen:t("npv.full-screen"),closeBtn:t("close_button_action"),duration:t("sort.duration"),search:t("navbar.search"),queue:t("playback-control.queue"),searchPlaylist:t("playlist.search_in_playlist"),download:t("download.download"),copyTrackLink:t("context-menu.copy-track-link"),moreContext:t("more.label.context",!0),downloadContext:t("contextmenu.download"),friendActivity:t("buddy-feed.friend-activity"),whatsNew:t("web-player.whats-new-feed.button-label"),skipForward:t("playback-control.skip-forward"),skipBack:t("playback-control.skip-back"),disableShuffle:t("playback-control.disable-shuffle"),enableShuffle:t("playback-control.enable-shuffle"),disableShuffleGeneric:t("web-player.smart-shuffle.button-disable-shuffle-generic"),disableShuffleSpecific:t("web-player.smart-shuffle.button-disable-shuffle-specific",!0),enableShuffleGeneric:t("web-player.smart-shuffle.button-enable-shuffle-generic"),enableShuffleSpecific:t("web-player.smart-shuffle.button-enable-shuffle-specific",!0),enableSmartShuffleSpecific:t("web-player.smart-shuffle.button-enable-smart-shuffle-specific",!0),enableSmartShuffleGeneric:t("web-player.smart-shuffle.button-enable-smart-shuffle-generic"),enableRepeat:t("playback-control.enable-repeat"),enableRepeatOne:t("playback-control.enable-repeat-one"),disableRepeat:t("playback-control.disable-repeat")};S("lucid-icon-patch").innerHTML=`
 .main-yourLibraryX-navLink[aria-label="${e.home}"] path,
 button[aria-label="${e.home}"] path {
 	d: var(--home-icon-24);
 }
 .main-yourLibraryX-navLink[aria-label="${e.home}"].active path,
 .main-globalNav-navLinkActive[aria-label="${e.home}"] path {
 	d: var(--home-filled-icon-24);
 }
 .main-topBar-buddyFeed[aria-label*="${e.whatsNew}"] svg,
 .main-topBar-buddyFeed[aria-label*="${e.friendActivity}"] svg {
 	transform: scale(1.1);
 }
 
 .main-topBar-buddyFeed[aria-label*="${e.friendActivity}"] svg path {
 	d: var(--people-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${e.friendActivity}"] .Svg-img-icon-small-textBase path {
 	d: var(--people-filled-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${e.whatsNew}"] svg path {
 	d: var(--bell-icon);
 }
 .main-topBar-buddyFeed .Svg-img-icon-small[aria-label*="${e.whatsNew}"] .Svg-img-icon-small-textBase path {
 	d: var(--bell-filled-icon);
 }
 .player-controls__left button[aria-label*="${e.disableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.disableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.disableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.enableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.enableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.enableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.enableSmartShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${e.enableSmartShuffleSpecific}"] path:nth-of-type(n+2),
 .Root__globalNav button[aria-label="${e.browse}"] path:nth-of-type(n + 2) {
 	display: none;
 }
 .Root__globalNav .main-globalNav-navLink.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-icon-24);
 	transform: scale(3) !important;
 }
 .Root__globalNav .main-globalNav-navLinkActive.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-filled-icon-24);
 }
 .Root__globalNav .IconContainer-leading:first-child svg path,
 .Root__globalNav .IconContainer-leading:has(button[aria-label*="${e.search}"]) div > svg path {
 	d: var(--search-icon-24);
 }
 .Root__globalNav button[aria-label="${e.browse}"] path {
 	d: var(--compass-icon-24);
 }
 .Root__globalNav button[aria-label="${e.browse}"].j4xi27AJ3oy5qZ8CGhhQ path {
 	d: var(--compass-filled-icon-24);
 }
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"] path,
 .player-controls__buttons .player-controls__left button[aria-label*="${e.skipBack}"] path {
   fill: var(--clr-on-surface);
   d: var(--prev-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"] path,
 .player-controls__buttons .player-controls__right button[aria-label="${e.skipForward}"] path {
   fill: var(--clr-on-surface);
   d: var(--next-icon)}
 
 .player-controls__left button[aria-label*="${e.disableShuffle}"],
 .player-controls__left button[aria-label*="${e.disableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${e.disableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${e.enableShuffle}"],
 .player-controls__left button[aria-label*="${e.enableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${e.enableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${e.enableSmartShuffleGeneric}"],
 .player-controls__left button[aria-label*="${e.enableSmartShuffleSpecific}"],
 .player-controls__right button[aria-label="${e.enableRepeat}"],
 .player-controls__right button[aria-label="${e.enableRepeatOne}"],
 .player-controls__right button[aria-label="${e.disableRepeat}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px}
 
 .player-controls__right button[aria-label="${e.enableRepeat}"] path {
 	d: var(--disable-repeat-icon)}
 .player-controls__right button[aria-label="${e.enableRepeatOne}"] path {
   d: var(--repeat-icon)}
 
 .player-controls__right button[aria-label="${e.disableRepeat}"] path {
   d: var(--repeat-one-icon)}
 
 .player-controls__left button[aria-label*="${e.enableShuffle}"] path,
 .player-controls__left button[aria-label*="${e.enableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${e.enableShuffleGeneric}"] path {
 	d: var(--disable-shuffle-icon)}
 
 .player-controls__left button[aria-label*="${e.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${e.disableShuffle}"] path,
 .player-controls__left button[aria-label*="${e.enableSmartShuffleGeneric}"] path,
 .player-controls__left button[aria-label*="${e.enableSmartShuffleSpecific}"] path {
 	d: var(--shuffle-icon)}
 
 .player-controls__left button[aria-label*="${e.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${e.disableShuffleGeneric}"] path {
 	d: var(--smart-shuffle-icon)}
 
 .main-actionBar-ActionBarRow button[aria-label*="${e.enableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.enableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.enableShuffleGeneric}"] path {
   d: var(--disable-shuffle-icon-24, var(--disable-shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${e.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.disableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.enableSmartShuffleGeneric}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.enableSmartShuffleSpecific}"] path {
   d: var(--shuffle-icon-24, var(--shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${e.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${e.disableShuffleGeneric}"] path {
   d: var(--smart-shuffle-icon-24, var(--smart-shuffle-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${e.play}"] svg[viewBox="0 0 24 24"] path {
   d: var(--play-icon-24, var(--play-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${e.pause}"] svg[viewBox="0 0 24 24"] path {
   d: var(--pause-icon-24, var(--pause-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${e.play}"] svg[viewBox="0 0 16 16"] path {
   d: var(--play-icon)}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${e.pause}"] svg[viewBox="0 0 16 16"] path {
   d: var(--pause-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"],
 .player-controls__buttons .player-controls__right button[aria-label="${e.skipForward}"],
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"],
 .player-controls__buttons .player-controls__left button[aria-label*="${e.skipBack}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px;
 	color: var(--subtext-color)}
 
 .player-controls__buttons button[aria-label="${e.play}"] path {
   fill: var(--clr-on-surface);
   d: var(--play-icon)}
 
 
 .player-controls__buttons button[aria-label="${e.pause}"] path {
   fill: var(--clr-on-surface);
   d: var(--pause-icon)}
 
 .player-controls__buttons > button,
 .player-controls__buttons button[data-testid=control-button-playpause] { --encore-graphic-size-decorative-smaller: 1.5rem; --encore-control-size-smaller: 1.5rem; }
 .player-controls__buttons button[data-testid=control-button-playpause],
 .player-controls__buttons button[data-testid=control-button-playpause]:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span { background: none !important; }
 
 .x-downloadButton-DownloadButton button[aria-label="${e.download}"] path,
 .x-downloadButton-DownloadButton button[aria-label="${e.downloadContext}"] path {
   d: var(--download-icon-24)}
   
 svg path[d="M3 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm6.5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM16 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],
 .Root__right-sidebar button[aria-label*="${e.moreContext}"] path{
   d: var(--more-horizontal-icon)}
 
 .main-actionBar-ActionBar button[aria-label*="${e.moreContext}"] path {
   d: var(--more-horizontal-icon-24)}
 
 x-filterBox-expandButton[aria-label*="${e.search}"] path,
 x-filterBox-expandButton[aria-label*="${e.searchPlaylist}"] path,
 .x-filterBox-searchIcon path {
   d: var(--search-icon)}
 
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 16 16"] path{
   d: var(--share-icon)}
 
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${e.copyTrackLink}"] svg[viewBox="0 0 24 24"] path{
   d: var(--share-icon-24)}
 
 svg path[d="M15 14.5H5V13h10v1.5zm0-5.75H5v-1.5h10v1.5zM15 3H5V1.5h10V3zM3 3H1V1.5h2V3zm0 11.5H1V13h2v1.5zm0-5.75H1v-1.5h2v1.5z"],
 button[aria-controls="sort-and-view-picker"] path,
 .x-sortBox-sortDropdown path {
   d: var(--text-bullet-list-icon)}
 
 svg path[d="M15.5 13.5H.5V12h15v1.5zm0-4.75H.5v-1.5h15v1.5zm0-4.75H.5V2.5h15V4z"]{
   d: var(--list-icon)}
 
 div[data-testid="PanelHeader_CloseButton"] button path,
 .Root__right-sidebar button[aria-label="${e.closeBtn}"] path,
 .Root__right-sidebar button[aria-label="${e.close}"] path{
   d: var(--dismiss-icon)}
 
 .main-trackList-trackListRowGrid button[aria-label="${e.duration}"] path{
   d: var(--clock-icon)}
 
 button[aria-label="${e.createPlaylist}"] path,
 button[aria-label="${e.createButton}"] path,
 svg path[d="M15.25 8a.75.75 0 0 1-.75.75H8.75v5.75a.75.75 0 0 1-1.5 0V8.75H1.5a.75.75 0 0 1 0-1.5h5.75V1.5a.75.75 0 0 1 1.5 0v5.75h5.75a.75.75 0 0 1 .75.75z"]{
   d: var(--add-icon)}
 
 svg path[d="M6.53 9.47a.75.75 0 0 1 0 1.06l-2.72 2.72h1.018a.75.75 0 0 1 0 1.5H1.25v-3.579a.75.75 0 0 1 1.5 0v1.018l2.72-2.72a.75.75 0 0 1 1.06 0zm2.94-2.94a.75.75 0 0 1 0-1.06l2.72-2.72h-1.018a.75.75 0 1 1 0-1.5h3.578v3.579a.75.75 0 0 1-1.5 0V3.81l-2.72 2.72a.75.75 0 0 1-1.06 0z"],
 button[data-testid="fullscreen-mode-button"] path,
 button[aria-label="${e.fullscreen}"] path{
   d: var(--arrow-maximize-icon);
 }
 
 svg path[d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"],
 button[data-testid="control-button-queue"] path,
 button[aria-label="${e.queue}"] path{
   /* d: var(--queue-icon); */ /* TODO: add new queue icon */
 }
 
 
 button[aria-label="${e.openMiniPlayer}"] path,
 button[data-testid="pip-toggle-button"] path{
   d: var(--pip-icon);
 }
 `}catch(t){console.error("Error patching icons.",t),b("Error patching icons.",!0,5e3)}};function At(t){try{let e=new URL(t).searchParams.get("family");return e?e.split(":")[0].split(";")[0].replace(/\+/g," "):null}catch(o){return console.error("Error parsing Google Fonts URL:",o),null}}function Ht(){Ft(),g.subscribe(t=>{Ft(t.font)})}function Ft(t=g.getState().font){let o=S("lucid-font"),e=document.head.querySelector("#lucid-custom-font");if(t.isGoogleFonts&&t.fontUrl){e?e.href!==t.fontUrl&&(e.href=t.fontUrl):(e=m("link",{id:"lucid-custom-font",rel:"preload",href:t.fontUrl,as:"style",crossOrigin:"anonymous"}),document.head.appendChild(e));let i=document.head.querySelector("#lucid-custom-font-style");i?i.href!==t.fontUrl&&(i.href=t.fontUrl):(i=m("link",{id:"lucid-custom-font-style",rel:"stylesheet",href:t.fontUrl,crossOrigin:"anonymous"}),document.head.appendChild(i))}else{e&&e.remove();let i=document.head.querySelector("#lucid-custom-font-style");i&&i.remove()}let r=t.isGoogleFonts&&t.fontUrl?At(t.fontUrl):t.fontFamily;o.innerText=`:root,* { --custom-font: "${r}"; font-family: var(--custom-font) !important; }`}var Ie=null,Te=null;function Ye(t=g.getState().pages){let o=`playlist-${t.style}`;Ie!==o&&(Ie?document.body.classList.replace(Ie,o):document.body.classList.add(o),Ie=o);let e=`playlist-image-${t.imageStyle}`;Te!==e&&(Te?document.body.classList.replace(Te,e):document.body.classList.add(e),Te=e),t.hideHomeHeader?document.body.classList.remove("hide-home-header"):document.body.classList.add("hide-home-header"),document.body.style.setProperty("--custom-panel-gap",`${t.panelGap}px`)}g.subscribe(t=>{Ye(t.pages)},"pages");function Ut(t){try{let o=new Blob([t],{type:"application/javascript"}),e=URL.createObjectURL(o),r=new Worker(e,{credentials:"omit"});return r.onerror=i=>{console.error("Worker encountered an error:",i.message||i)},r.onmessage=i=>{console.debug("Worker initialized:",i.data)},r}catch(o){return console.error("Error loading worker:",o),null}}async function z(t,o,e=864e5){let r=JSON.parse(localStorage.getItem(o)||"null");if(r!=null&&r.script&&(!navigator.onLine||Date.now()-r.timestamp<e))return r.script;let i=null;for(let a of t)try{let l=await fetch(a);if(l.ok){i=await l.text();break}}catch(l){}if(!i){if(r!=null&&r.script)return r.script;throw new Error("Failed to fetch guide script from all sources.")}return localStorage.setItem(o,JSON.stringify({script:i,timestamp:Date.now()})),i}var P=null,Le=null,vr=S("clr-lucid");function $t(t){P&&P.postMessage({type:"color",options:t})}function Vt(t){P&&P.postMessage({type:"image",options:t})}function Nt(t){return t.replace("spotify:image:","https://i.scdn.co/image/")}async function Ze(t=g.getState().color){var o;if(await Sr(),Le==null||Le(),t.isDynamic){let e=w.getState().url;e&&Vt({url:Nt(e),isTonal:t.isTonal,isDark:!0,extractorOptions:(o=t==null?void 0:t.extractorOptions)!=null?o:{}}),Le=w.subscribe(r=>{var i;r.url&&Vt({url:Nt(r.url),isTonal:t.isTonal,isDark:!0,extractorOptions:(i=t==null?void 0:t.extractorOptions)!=null?i:{}})});return}if(t.isCustom){$t({hex:t.customColor.hex,isTonal:t.isTonal,isDark:!0});return}$t({hex:_t,isTonal:t.isTonal,isDark:!0})}async function Sr(){let t=await z(St,we);if(P=Ut(t),!P){document.body.removeAttribute("color-from-worker"),console.error("Failed to initialize worker from both endpoints."),b("Failed to initialize the color worker. If this issue persists, please report it. (Dynamic and custom colors may not function properly.)",!0,5e3);return}document.body.setAttribute("color-from-worker","true"),P.onmessage=o=>{let{message:e,data:r}=o.data||{};r?(console.debug(e,`
Event Data:`,o.data),vr.textContent=`:root,body{${r.style}}`):console.error(e!=null?e:"Color not applied")},P.onerror=o=>{console.error("Worker encountered an error:",o.message||o)}}var _r=t=>Spicetify.URI.isPlaylistV1OrV2(t)?"playlist":Spicetify.URI.isArtist(t)?"artist":Spicetify.URI.isAlbum(t)?"album":Spicetify.URI.isGenre(t)?"genre":Spicetify.URI.isShow(t)?"show":Spicetify.URI.isSearch(t)?"search":Spicetify.URI.isProfile(t)?"profile":Spicetify.URI.isConcert(t)||Spicetify.URI.isArtistConcerts(t)?"concert":"other";function Dt(t){document.body.setAttribute("path",t),document.body.setAttribute("page-type",_r(t))}function Gt(){var t,o,e,r,i;Dt(((e=(o=(t=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:t.History)==null?void 0:o.location)==null?void 0:e.pathname)||"/"),(i=(r=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:r.History)==null||i.listen(a=>{!a||!a.pathname||Dt(a.pathname)})}var Be=()=>{var t,o;return Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:(o=(t=Spicetify.Platform)==null?void 0:t.PlatformData)!=null&&o.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1};function Er(){let t=Math.round(window.outerHeight/window.innerHeight*100)/100,o=Math.round(window.innerHeight/window.outerHeight*100)/100;return{zoom:t,inverseZoom:o}}var Wt,zt=((Wt=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:Wt.version)>="1.2.46";function wr(t){let{zoom:o,inverseZoom:e}=Er(),r=zt&&t>32?Math.max(32,Math.round(t/(2*o))):t/o,i=Math.round(135*e),a=zt?(t/o-Math.min(32/o,t))/2:0,l=S("transparent-controls");l.textContent=`
    body::after {
      content: "";
      height: var(--control-height, ${r}px);
      width: var(--control-width, ${i}px);
      position: fixed;
      top: ${a}px;
      right: 0;
      -webkit-backdrop-filter: brightness(2.1);
      backdrop-filter: brightness(2.1);
    }
  `}async function Cr(t){var o,e,r,i,a,l;await((r=(e=(o=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:o.ControlMessageAPI)==null?void 0:e._updateUiClient)==null?void 0:r.updateTitlebarHeight({height:t})),await((l=(a=(i=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:i.UpdateAPI)==null?void 0:a._updateUiClient)==null?void 0:l.updateTitlebarHeight({height:t})),await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${t}px`})}function Je(t=g.getState().control.height){Cr(t).then(()=>wr(t)).catch(o=>console.error("Failed to update titlebar:",o))}function Kt(){let t=setInterval(()=>Je(),300);setTimeout(()=>{clearInterval(t)},1e4)}var qt=()=>{Be()&&(Je(),Kt(),window.addEventListener("resize",Kt),g.subscribe(t=>Je(t.control.height),"control"))};var O=t=>{if(t<0||t>100)throw new Error("Alpha value must be between 0 and 100");let o=t/100,r=Math.round(o*255).toString(16).toUpperCase();return r.length===1&&(r=`0${r}`),r};function Yt(t=g.getState().playbar){var r,i,a,l,u,d,n,h;let o=t.options[t.type],e=S("lucid-playbar");e.textContent=`
    :root,
    .Root__now-playing-bar{
        --npb-height: ${(r=o.height)!=null?r:80}px;
        --npb-blur: ${(i=o.backdropFilter.blur)!=null?i:32}px;
        --npb-padding-x: ${(a=o.paddingX)!=null?a:8}px;
        --npb-saturate: ${(l=o.backdropFilter.saturate)!=null?l:150}%;
        --npb-brightness: ${(u=o.backdropFilter.brightness)!=null?u:80}%;
        --npb-border-radius: ${(d=o.borderRadius)!=null?d:8}px;
        --npb-image-radius: ${(n=o.imageRadius)!=null?n:16}px;
        --npb-bg-opacity: ${(h=o.bgOpacity)!=null?h:50}%;
        --npb-bg-color: ${o.bgColor.hex?o.bgColor.hex+O(o.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${o.bgColor.alpha}%)`} ;
    }`,t.isFloating?document.body.setAttribute("npb-is-floating","floating"):document.body.removeAttribute("npb-is-floating"),document.body.setAttribute("npb-type",t.type)}var C=document.querySelector(".Root__now-playing-bar");M([".Root__now-playing-bar"],([t])=>{C=t,Xe()});var Me=g.getState().playbar.hideIcons;function Xe(){if(!C)return;let t=C.offsetWidth;C.style.setProperty("--width",`${t}px`),Qe(Me||t<1e3)}function Qe(t=g.getState().playbar.hideIcons){C&&(t?C.setAttribute("hide-icons","true"):C.removeAttribute("hide-icons"))}function Zt(){window.addEventListener("resize",Xe),Yt(),Qe(Me||((C==null?void 0:C.clientWidth)||0)<900),g.subscribe(t=>{Me=t.playbar.hideIcons,Qe(Me||((C==null?void 0:C.clientWidth)||0)<900),Yt(t.playbar)},"playbar"),Xe()}var L=new G({isFloating:!1,position:{top:16,left:16}},{persist:!0,localStorageKey:"lucid-modal-position"});var Jt='<svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z" fill="currentColor"/></svg>',Xt='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"/></svg>',Qt='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M25.12,6.946c-2.424-1.948-6.257-2.278-6.419-2.292c-0.256-0.022-0.499,0.123-0.604,0.357 c-0.004,0.008-0.218,0.629-0.425,1.228c2.817,0.493,4.731,1.587,4.833,1.647c0.478,0.278,0.638,0.891,0.359,1.368 C22.679,9.572,22.344,9.75,22,9.75c-0.171,0-0.343-0.043-0.501-0.135C21.471,9.598,18.663,8,15.002,8 C11.34,8,8.531,9.599,8.503,9.615C8.026,9.892,7.414,9.729,7.137,9.251C6.86,8.775,7.021,8.164,7.497,7.886 c0.102-0.06,2.023-1.158,4.848-1.65c-0.218-0.606-0.438-1.217-0.442-1.225c-0.105-0.235-0.348-0.383-0.604-0.357 c-0.162,0.013-3.995,0.343-6.451,2.318C3.564,8.158,1,15.092,1,21.087c0,0.106,0.027,0.209,0.08,0.301 c1.771,3.11,6.599,3.924,7.699,3.959c0.007,0,0.013,0,0.019,0.001c0.194,0,0.377-0.093,0.492-0.25l1.19-1.612 c-2.61-0.629-3.99-1.618-4.073-1.679c-0.444-0.327-0.54-0.953-0.213-1.398c0.326-0.443,0.95-0.541,1.394-0.216 C7.625,20.217,10.172,22,15,22c4.847,0,7.387-1.79,7.412-1.808c0.444-0.322,1.07-0.225,1.395,0.221 c0.324,0.444,0.23,1.066-0.212,1.392c-0.083,0.061-1.456,1.048-4.06,1.677l1.175,1.615c0.115,0.158,0.298,0.25,0.492,0.25 c0.007,0,0.013,0,0.019-0.001c1.101-0.035,5.929-0.849,7.699-3.959c0.053-0.092,0.08-0.195,0.08-0.301 C29,15.092,26.436,8.158,25.12,6.946z M11,19c-1.105,0-2-1.119-2-2.5S9.895,14,11,14s2,1.119,2,2.5S12.105,19,11,19z M19,19 c-1.105,0-2-1.119-2-2.5s0.895-2.5,2-2.5s2,1.119,2,2.5S20.105,19,19,19z"/></svg>',Pe='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z" fill="currentColor"/></svg>',jt='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z" fill="currentColor"/></svg>',eo='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 0-5.06 0L14 4.94l-.013-.013a1.75 1.75 0 0 0-2.475 0l-.585.586a1.75 1.75 0 0 0 0 2.474l.012.013-6.78 6.78a2.25 2.25 0 0 0-.659 1.591v.688l-1.28 2.347c-.836 1.533.841 3.21 2.374 2.374l2.347-1.28h.688a2.25 2.25 0 0 0 1.59-.659L16 13.061l.012.012a1.75 1.75 0 0 0 2.475 0l.586-.585a1.75 1.75 0 0 0 0-2.475L19.061 10l1.97-1.97a3.578 3.578 0 0 0 0-5.06ZM12 9.06 14.94 12l-6.78 6.78a.75.75 0 0 1-.531.22H6.75a.75.75 0 0 0-.359.092l-2.515 1.372a.234.234 0 0 1-.159.032.264.264 0 0 1-.138-.075.264.264 0 0 1-.075-.138.234.234 0 0 1 .033-.159l1.372-2.515A.75.75 0 0 0 5 17.25v-.879a.75.75 0 0 1 .22-.53L12 9.061Z" fill="currentColor"/></svg>',je='<svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>';var to="https://github.com/sanoojes/Spicetify-Lucid",oo="https://discord.gg/PWEyKduwJh";var kr=(t="base")=>`encore-internal-color-text-${t}`,R=(t="variable-text",o="base")=>`encore-text ${t==="variable-text"?`encore-${t}`:`encore-text-${t}`} ${kr(o)}`;var k=class extends HTMLElement{constructor(e){var r,i,a,l;super();c(this,"customClass","");c(this,"_type","primary");c(this,"_isIcon",!1);c(this,"onChange");c(this,"_handleClick",()=>{!this.disabled&&this.onChange&&this.onChange()});e&&(this.type=(r=e.type)!=null?r:this.type,this.customClass=(i=e.customClass)!=null?i:this.customClass,this.disabled=(a=e.disabled)!=null?a:this.disabled,this.isIcon=(l=e.isIcon)!=null?l:this._isIcon,this.onChange=e.onChange,e.textContent&&(this.textContent=e.textContent),e.innerHTML&&(this.innerHTML=e.innerHTML),e.ariaLabel&&(this.ariaLabel=e.ariaLabel),e.style&&Object.assign(this.style,e.style)),this.addEventListener("click",this._handleClick)}connectedCallback(){this.classList.add("lucid-button"),this._updateClasses(),this.setAttribute("role","button")}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}_updateClasses(){this.className=`lucid-button ${this.customClass}`,this.classList.toggle("icon",this._isIcon),this.classList.toggle("disabled",this.disabled);for(let e of this.classList)["primary","secondary","tertiary","danger"].includes(e)&&this.classList.remove(e);if(this.classList.add(this.type),this._isIcon&&this.type==="icon"){let e=R("body-small-bold");e&&this.classList.add(e)}}set isIcon(e){this._isIcon=e,e?(this.classList.add("icon"),this.setAttribute("is-icon","true")):(this.classList.remove("icon"),this.removeAttribute("is-icon")),this._updateClasses()}get isIcon(){return this._isIcon}set type(e){this._type=e,this.setAttribute("type",e),this._updateClasses()}get type(){return this._type}set disabled(e){e?(this.setAttribute("disabled","true"),this.setAttribute("aria-disabled","true")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")),this._updateClasses()}get disabled(){return this.hasAttribute("disabled")}};customElements.define("custom-button",k);var K=class K extends HTMLElement{constructor(){super();c(this,"_modalElem");c(this,"_bodyElem");c(this,"_scrollElem");c(this,"_closeBtn");c(this,"_githubBtn");c(this,"_discordBtn");c(this,"_headerWrapperElem");c(this,"_headerElem");c(this,"_bgElem");c(this,"_previouslyFocusedElement",null);this._bgElem=m("div",{className:"modal-backdrop"}),this._bgElem.addEventListener("click",()=>this.close()),this._modalElem=m("div",{className:"modal",role:"dialog",ariaModal:"true"}),this._headerWrapperElem=m("div",{className:"modal-header-container"}),this._headerElem=m("h2",{className:`modal-header ${R("title-small")}`,id:"modal-header"});let e=m("div",{className:"modal-header-buttons"});this._closeBtn=this.createIconButton("close","Close Button",Jt,()=>this.close()),this._githubBtn=this.createIconButton("github","Github Button",Xt,()=>window.open(to)),this._discordBtn=this.createIconButton("discord","Discord Button",Qt,()=>window.open(oo)),e.append(this._discordBtn,this._githubBtn,this._closeBtn),this._headerWrapperElem.append(this._headerElem,e),this._modalElem.appendChild(this._headerWrapperElem),this._bodyElem=m("div",{className:"modal-body"}),this._scrollElem=m("div",{className:"modal-scroll"}),this._bodyElem.appendChild(this._scrollElem),this._modalElem.appendChild(this._bodyElem),this.append(this._bgElem,this._modalElem)}createIconButton(e,r,i,a){let l=new k;return l.customClass=e,l.ariaLabel=r,l.innerHTML=i.toString(),l.type="icon",l.addEventListener("click",a),l}resetPosition(){this._modalElem.style.transform="translate3d(-50%,-50%,0px)"}get scrollElem(){return this._scrollElem}set isOpen(e){e?this.setAttribute("open","true"):this.removeAttribute("open")}get isOpen(){return!!this.getAttribute("open")}setHeader(e){this._headerElem.innerHTML=e.toString()}open(){this.isOpen=!0,this._previouslyFocusedElement=document.activeElement,this._bgElem.classList.add("modal-backdrop--open"),this._modalElem.classList.add("modal--open"),this._closeBtn.focus(),this.resetPosition(),K.zIndexCounter+=1,this._bgElem.style.zIndex=String(K.zIndexCounter),this._modalElem.style.zIndex=String(K.zIndexCounter),this.dispatchEvent(new Event("open"))}close(){this.isOpen=!1,this._bgElem.classList.remove("modal-backdrop--open"),this._modalElem.classList.remove("modal--open"),this.removeAttribute("open"),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null),this.dispatchEvent(new Event("close"))}setContent(e){this._scrollElem.textContent="",typeof e=="string"?this._scrollElem.textContent=e:this._scrollElem.append(e)}};c(K,"zIndexCounter",1e3);var N=K;customElements.define("lucid-modal",N);var W=class extends N{constructor(){super();c(this,"dragging",!1);c(this,"startX",0);c(this,"startY",0);c(this,"initialLeft",0);c(this,"initialTop",0);c(this,"setPosition",(e,r)=>{L.setState(i=>({isFloating:i.isFloating,position:{top:e,left:r}}))});c(this,"handlePointerDown",e=>{if(!this.isFloating)return;this.dragging=!0,this.startX=e.clientX,this.startY=e.clientY;let r=this._modalElem.getBoundingClientRect();this.initialLeft=r.left,this.initialTop=r.top,this.setAttribute("dragging","true"),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp)});c(this,"handlePointerMove",e=>{if(!this.dragging)return;let r=e.clientX-this.startX,i=e.clientY-this.startY,a=this.initialLeft+r,l=this.initialTop+i,u=this._modalElem.getBoundingClientRect(),d=u.width,n=u.height;a=Math.max(0,Math.min(a,window.innerWidth-d-16)),l=Math.max(0,Math.min(l,window.innerHeight-n-16)),this._modalElem.style.transform=`translate3d(${a}px,${l}px,0px)`,this.setPosition(l,a)});c(this,"handlePointerUp",e=>{this.dragging=!1,this.removeAttribute("dragging"),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)});super.setHeader("Lucid Settings")}makeFloating(){let e=L.getState().position;e&&e.top!==void 0&&e.left!==void 0&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`),this.setAttribute("floating","true"),this._modalElem.classList.add("modal--floating"),this._bgElem.classList.add("modal-backdrop--floating"),this._headerWrapperElem.addEventListener("pointerdown",this.handlePointerDown)}removeFloating(){this.removeAttribute("floating"),this.resetPosition(),this._bgElem.classList.remove("modal-backdrop--floating"),this._modalElem.classList.remove("modal--floating"),this._headerWrapperElem.removeEventListener("pointerdown",this.handlePointerDown)}set isFloating(e){e?(this.setAttribute("is-floating","true"),this.makeFloating()):(this.removeAttribute("is-floating"),this.removeFloating())}get isFloating(){return!!this.getAttribute("is-floating")}open(){if(super.open(),this.isFloating){let e=L.getState().position;e&&e.top!==void 0&&e.left!==void 0&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`)}}};customElements.define("lucid-settings-modal",W);window.Modal=N;window.FloatingModal=W;var A=null;function et(t,o){var e,r,i;A&&(A instanceof Spicetify.Topbar.Button?(e=A.element)==null||e.remove():A.deregister(),A=null),t==="context-menu"?(r=Spicetify==null?void 0:Spicetify.Menu)!=null&&r.Item?(A=new Spicetify.Menu.Item("Lucid Settings",!1,o,je),A.register()):console.error("Context menu unavailable.Try Switching to Nav."):t==="nav"&&((i=Spicetify==null?void 0:Spicetify.Topbar)!=null&&i.Button?A=new Spicetify.Topbar.Button("Lucid Settings",je,o,!1,!0):console.error("Nav bar unavailable.Try Switching to Context Menu."))}var F=null,I=null,xr=100,Ir=150,v=m("div",{id:"tooltip",role:"tooltip",ariaHidden:"true",style:{position:"fixed",display:"block",padding:"0.5rem 1rem",border:"1px solid var(--border-color, var(--clr-surface-0))",color:"var(--clr-on-surface, #fafafa)",backgroundColor:"rgba(var(--clr-surface-0-rgb, var(--spice-rgb-main)), 0.85)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(var(--clr-shadow-rgb), 0.25)",backdropFilter:"blur(10px)",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s ease-out",pointerEvents:"auto",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-5px) scale(0.95)",maxWidth:`${window.innerWidth/2}px`,fontSize:"0.875rem",textAlign:"center"}}),oe=m("span",{className:"tooltip-content",style:{display:"inline-block",transition:"opacity 0.3s ease"}});v.appendChild(oe);document.body.appendChild(v);v.addEventListener("mouseenter",()=>{I&&(clearTimeout(I),I=null)});v.addEventListener("mouseleave",()=>{ro()});function Tr(t,o){o&&(I&&(clearTimeout(I),I=null),F&&(clearTimeout(F),F=null),F=setTimeout(()=>{typeof o=="string"?oe.innerHTML=`<span style="font-weight: 500; color: inherit;">${o}</span>`:(oe.innerHTML="",oe.appendChild(o)),v.style.visibility="visible",v.style.opacity="1",v.style.transform="translateY(0) scale(1)",v.setAttribute("aria-hidden","false");let e,r;if(t.target instanceof HTMLElement){let i=t.target.getBoundingClientRect();e=i.left+i.width/2-v.offsetWidth/2,r=i.top-v.offsetHeight}else e=t.clientX+10,r=t.clientY+10;e=Math.max(0,Math.min(e,window.innerWidth-v.offsetWidth)),v.style.left=`${e}px`,v.style.top=`${r}px`,v.style.maxWidth=`${window.innerWidth/2}px`,F=null},xr))}function ro(){v.matches(":hover")||oe.matches(":hover")||(F&&(clearTimeout(F),F=null),I&&(clearTimeout(I),I=null),I=setTimeout(()=>{v.style.opacity="0",v.style.transform="translateY(-5px) scale(0.95)",v.style.visibility="hidden",v.setAttribute("aria-hidden","true"),I=null},Ir))}var Oe=class{constructor(o){c(this,"elem");c(this,"content");c(this,"mouseoverHandler");c(this,"mouseoutHandler");c(this,"open",!1);this.content=o,this.elem=m("div",{className:"tooltip-wrapper",innerHTML:`<span class="icon" style="height:24px; width:24px;">${jt}</span>`,style:{cursor:"help",display:"inline-flex"},ariaLabel:typeof o=="string"?o:void 0,ariaHasPopup:"true"}),this.mouseoverHandler=e=>{this.open=!0,Tr(e,this.content)},this.mouseoutHandler=()=>{!this.elem.matches(":hover")&&this.open&&(ro(),this.open=!1)},this.elem.addEventListener("mouseenter",this.mouseoverHandler),this.elem.addEventListener("mouseleave",this.mouseoutHandler)}dispose(){this.elem.removeEventListener("mouseenter",this.mouseoverHandler),this.elem.removeEventListener("mouseleave",this.mouseoutHandler),this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem)}};var re=class extends HTMLElement{constructor(){super();c(this,"_options",[]);c(this,"_value","");c(this,"_isOpen",!1);c(this,"_highlightedIndex",-1);c(this,"_trigger");c(this,"_selectedValueSpan");c(this,"_optionsList");c(this,"shadow");this.shadow=this.attachShadow({mode:"open"}),this.handleDocumentClick=this.handleDocumentClick.bind(this)}set options(e){this._options=e,this.renderOptions()}get options(){return this._options}set value(e){this._value=e,this.updateSelected()}get value(){return this._value}connectedCallback(){this.render(),document.addEventListener("click",this.handleDocumentClick)}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick)}render(){this.shadow.innerHTML=`
        <style>.option,.trigger{cursor:pointer;transition:background 225ms ease-in-out}.select-container{width:100%;min-width:6rem;position:relative}.options,.options::before{width:100%;position:absolute}.trigger{padding:.5rem .75rem;background-color:var(--clr-surface-2);width:100%;display:flex;align-items:center;text-align:left;line-height:1px;justify-content:space-between;color:var(--clr-on-surface);border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem)}.options{list-style:none;padding:0;margin:0;border:1px solid #ccc;scrollbar-width:thin;background:rgba(var(--clr-surface-1-rgb),.5);z-index:10;max-height:200px;overflow-y:auto;border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem);-webkit-backdrop-filter:blur(8px) saturate(150%);backdrop-filter:blur(8px) saturate(150%)}.options.hidden{display:none}.option{padding:.5rem}.option:last-child{border-bottom:none}.option.highlighted,.option[aria-selected=true]{background:rgba(var(--clr-surface-2-rgb),.7)}.option:hover,.trigger:hover,.trigger[aria-expanded=true]{background:rgba(var(--clr-surface-3-rgb),.75)}.icon{color:var(--clr-on-surface,var(--spice-text));height:20px;width:20px}.trigger,.option{font-size: .85rem;font-weight:500;font-family:inherit;color: var(--clr-on-surface,var(--spice-text,#fafafa))}</style>
        <div class="select-container">
          <button type="button" class="trigger" aria-haspopup="listbox" aria-expanded="false">
            <span class="selected-value"></span>
            <span class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5.79681 7C4.95612 7 4.49064 7.97434 5.01887 8.62834L8.83333 13.351C9.43371 14.0943 10.5668 14.0943 11.1672 13.351L14.9816 8.62834C15.5098 7.97434 15.0444 7 14.2037 7H5.79681Z" fill="currentColor"/>
              </svg>
            </span>
          </button>
          <ul class="options hidden" role="listbox" tabindex="-1"></ul>
        </div>
      `,this._trigger=this.shadow.querySelector(".trigger"),this._selectedValueSpan=this.shadow.querySelector(".selected-value"),this._optionsList=this.shadow.querySelector(".options"),this._trigger.addEventListener("click",()=>this.checkboxOptions()),this._trigger.addEventListener("keydown",e=>this.handleTriggerKeydown(e)),this._optionsList.addEventListener("click",e=>this.handleOptionClick(e)),this._optionsList.addEventListener("keydown",e=>this.handleOptionsKeydown(e)),this.renderOptions(),this.updateSelected()}renderOptions(){if(this._optionsList){this._optionsList.innerHTML="";for(let[e,r]of this._options.entries()){let i=m("li",{role:"option",className:"option",textContent:r.label,ariaSelected:r.value===this._value?"true":"false"});i.setAttribute("data-index",e.toString()),i.setAttribute("data-value",r.value),this._optionsList.appendChild(i)}}}updateSelected(){if(!this._selectedValueSpan)return;let e=this._options.find(i=>i.value===this._value);this._selectedValueSpan.textContent=e?e.label:"Select an option";let r=Array.from(this._optionsList.children);for(let i of r){let a=i.getAttribute("data-value");i.setAttribute("aria-selected",a===this._value?"true":"false")}}checkboxOptions(){this._isOpen=!this._isOpen,this._isOpen?this.openOptions():this.closeOptions()}openOptions(){this._optionsList.classList.remove("hidden"),this._trigger.setAttribute("aria-expanded","true"),this._highlightedIndex=this._options.findIndex(e=>e.value===this._value),this._highlightedIndex===-1&&(this._highlightedIndex=0),this.highlightOption(this._highlightedIndex),this._optionsList.focus()}closeOptions(){this._isOpen=!1,this._optionsList.classList.add("hidden"),this._trigger.setAttribute("aria-expanded","false"),this._highlightedIndex=-1}handleTriggerKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.openOptions();break;case"Enter":case" ":e.preventDefault(),this.checkboxOptions();break}}handleOptionsKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.moveHighlight(1);break;case"ArrowUp":e.preventDefault(),this.moveHighlight(-1);break;case"Enter":e.preventDefault(),this.selectHighlighted();break;case"Escape":e.preventDefault(),this.closeOptions(),this._trigger.focus();break}}handleOptionClick(e){let r=e.target;if(r&&r.getAttribute("role")==="option"){let i=Number.parseInt(r.getAttribute("data-index")||"0",10);this._highlightedIndex=i,this.selectHighlighted()}}moveHighlight(e){let r=this._options.length;r!==0&&(this._highlightedIndex=(this._highlightedIndex+e+r)%r,this.highlightOption(this._highlightedIndex))}highlightOption(e){let r=this._optionsList.querySelectorAll(".option"),i=0;for(let a of r)i===e?(a.classList.add("highlighted"),a.scrollIntoView({block:"nearest"})):a.classList.remove("highlighted"),i++}selectHighlighted(){if(this._highlightedIndex>=0&&this._highlightedIndex<this._options.length){let e=this._options[this._highlightedIndex];this._value=e.value,this.updateSelected(),this.closeOptions(),this._trigger.focus(),this.dispatchEvent(new Event("change",{bubbles:!0}))}}handleDocumentClick(e){this.contains(e.target)||this.closeOptions()}};customElements.define("accessible-select",re);function io(t,o){if(t===o)return!0;let e=Object.keys(t),r=Object.keys(o);if(e.length!==r.length)return!1;for(let i of e)if(t[i]!==o[i])return!1;return!0}var ie=class extends HTMLElement{constructor(){super(...arguments);c(this,"_inputOptions");c(this,"_renderedOptions",null);c(this,"_inputElement",null);c(this,"_previewElement",null)}set inputOptions(e){this._inputOptions=e,this.render()}get inputOptions(){return this._inputOptions}connectedCallback(){this.render()}removeContent(){this._inputElement=null,this._previewElement=null,this.innerHTML=""}render(){if(this._renderedOptions&&io(this._renderedOptions,this._inputOptions))return;this.removeContent();let e=(r,i,a)=>{let l=this._inputElement,u=l.value,d=a?a(u):u;if(!r){i==null||i(d);return}let n=r(d);n.isValid?(l.classList.remove("error","shake-error"),i==null||i(d)):(l.classList.remove("shake-error"),l.offsetWidth,l.classList.add("error","shake-error"),n.message&&b(n.message,!0,2e3))};switch(this._inputOptions.type){case"button":{let{buttonType:r,onClick:i,contents:a}=this._inputOptions;this._inputElement=new k,this._inputElement.type=r||"primary",i&&(this._inputElement.onclick=i),this._inputElement.innerHTML=(a==null?void 0:a.toString())||"Button",this.append(this._inputElement);break}case"number":{let{type:r,step:i,value:a,onChange:l,validator:u}=this._inputOptions;this._inputElement=m("input",{type:r,step:(i==null?void 0:i.toString())||"1",value:a==null?void 0:a.toString(),className:"input number"});let d=new k;d.innerHTML=Pe,d.type="icon",d.onclick=()=>e(u,l,n=>Number.parseFloat(n)),this.append(this._inputElement,d);break}case"text":{let{type:r,value:i,onChange:a,validator:l}=this._inputOptions;this._inputElement=m("input",{type:r,value:i,className:"input text"});let u=new k;u.innerHTML=Pe,u.type="icon",u.onclick=()=>e(l,a),this.append(this._inputElement,u);break}case"checkbox":{let{onChange:r,checked:i,type:a}=this._inputOptions;this._inputElement=m("input",{checked:i,type:a,className:"checkbox custom"}),this._inputElement.onchange=l=>r==null?void 0:r(l.target.checked),this.append(this._inputElement);break}case"select":{let{options:r,value:i,onChange:a}=this._inputOptions;this._inputElement=new re,r&&(this._inputElement.options=r),i&&(this._inputElement.value=i),this._inputElement.onchange=l=>a==null?void 0:a(l.target.value),this.append(this._inputElement);break}case"color":{let{value:r,onChange:i}=this._inputOptions;this._inputElement=m("input",{type:"color",value:r,className:"input color"});let a=new k;a.innerHTML=eo,a.type="icon",a.onclick=async()=>{if(!("EyeDropper"in window)&&window.EyeDropper){b("EyeDropper API is not supported in this browser.",!0,3e3);return}try{if(!window.EyeDropper)return;let n=(await new window.EyeDropper().open()).sRGBHex;this._inputElement.value=n,i==null||i(n)}catch(u){u instanceof Error&&u.message!=="No color selected"&&(console.error("EyeDropper Error:",u),b("Failed to pick color with EyeDropper.",!0,3e3))}};let l=new k;l.innerHTML=Pe,l.type="icon",l.onclick=()=>{e(()=>({isValid:!0}),i)},window.EyeDropper?this.append(this._inputElement,a,l):this.append(this._inputElement,l);break}case"image":{let{onChange:r}=this._inputOptions;this._inputElement=m("input",{type:"file",accept:"image/*",className:"input image",style:{display:"none",visibility:"hidden"}}),this._previewElement=m("img",{className:"image-preview",style:{borderRadius:"0.5rem"}}),this._previewElement.src="",this.prepend(this._previewElement),this._inputElement.onchange=i=>{var u;let l=(u=i.target.files)==null?void 0:u[0];if(l){let d=new FileReader;d.onload=n=>{var y;let h=(y=n.target)==null?void 0:y.result;r==null||r(h),this._previewElement&&(this._previewElement.src=h)},d.readAsDataURL(l)}else r==null||r(null),this._previewElement&&(this._previewElement.src="")},this.append(new k({type:"primary",textContent:"Select Image",onChange:()=>{var i;(i=this._inputElement)==null||i.click()}}),this._inputElement);break}default:console.error("Unsupported input options:",this._inputOptions)}this._renderedOptions=this._inputOptions}};customElements.define("custom-input",ie);var ne=class extends HTMLElement{constructor(){super(...arguments);c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_settings",[]);c(this,"sectionElements",[])}connectedCallback(){!this.sectionElements.length&&this._settings.length&&this.createSectionElements(),this.render(),this.updateVisibility()}set options(e){this._settings=e,this.updateSectionElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML=""}createSectionElements(){this.sectionElements=[];for(let e of this._settings){let r=new ae;r.options=e,this.sectionElements.push(r)}}updateSectionElements(){let e=new Map;for(let i of this.sectionElements){let a=i._name;e.set(a,i)}let r=[];for(let i of this._settings){let a=i.name,l=e.get(a);l||(l=new ae),l.options=i,r.push(l)}this.sectionElements=r}render(){!this._settings||this._settings.length===0||this.rendered||(this.clear(),this.append(...this.sectionElements),this.rendered=!0)}};customElements.define("settings-main",ne);var ae=class extends HTMLElement{constructor(){super();c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_headerElement");c(this,"_groupsWrapperElement");c(this,"_name","");c(this,"_groups",[]);c(this,"groupElements",[]);this._headerElement=m("div",{className:"header-wrapper",style:{textAlign:"center"}}),this._groupsWrapperElement=m("div",{style:{marginTop:".25rem",display:"flex",flexDirection:"column",gap:".5rem",width:"100%"}})}connectedCallback(){!this.groupElements.length&&this._groups.length&&this.createGroupElements(),this.render(),this.updateVisibility()}set options(e){this._name=e.name,this._groups=e.groups,this._isRender=e.render,this.updateGroupElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="block",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._headerElement.innerHTML="",this._groupsWrapperElement.innerHTML=""}createGroupElements(){this.groupElements=[];for(let e of this._groups){let r=new se;r.options=e,this.groupElements.push(r)}}updateGroupElements(){let e=new Map;for(let i of this.groupElements)e.set(i._key,i);let r=[];for(let i of this._groups){let a=e.get(i.key);a||(a=new se),a.options=i,r.push(a)}this.groupElements=r}render(){!this._groups||this._groups.length===0||this.rendered||(this.dataset.tabId=this._name.toLowerCase(),this.clear(),this._headerElement.append(m("h3",{textContent:this._name,className:R("title-small"),style:{fontSize:"1.25rem"}})),this._groupsWrapperElement.append(...this.groupElements),this.append(this._headerElement,this._groupsWrapperElement),this.rendered=!0)}};customElements.define("setting-section",ae);var se=class extends HTMLElement{constructor(){super();c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_nameContainerElement");c(this,"_fieldsContainerElement");c(this,"_showName",!0);c(this,"_name","Section");c(this,"_fields",[]);c(this,"_key","");c(this,"fieldElements",[]);this._nameContainerElement=m("div"),this._fieldsContainerElement=m("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}})}connectedCallback(){!this.fieldElements.length&&this._fields.length&&this.createFieldElements(),this.render(),this.updateVisibility()}set options(e){var r;this._name=e.name,this._fields=e.fields,this._isRender=e.render,this._key=e.key,this._showName=(r=e.showName)!=null?r:!0,this.updateFieldElements(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._nameContainerElement.innerHTML="",this._fieldsContainerElement.innerHTML=""}createFieldElements(){var e;this.fieldElements=[];for(let r of this._fields){let i=new le;i.isRender=(e=r.render)!=null?e:!0,i.inputOptions=r.inputOptions,i.label=r.label,i.fieldKey=r.key,r.tooltip&&(i.tooltip=r.tooltip),this.fieldElements.push(i)}}updateFieldElements(){var i,a;let e=new Map;for(let l of this.fieldElements)e.set(l.fieldKey,l);let r=[];for(let l of this._fields){let u=e.get(l.key);u?(u.isRender=(i=l.render)!=null?i:!0,u.inputOptions=l.inputOptions,l.tooltip&&(u.tooltip=l.tooltip)):(u=new le,u.isRender=(a=l.render)!=null?a:!0,u.inputOptions=l.inputOptions,u.label=l.label,u.fieldKey=l.key,l.tooltip&&(u.tooltip=l.tooltip)),r.push(u)}this.fieldElements=r}render(){!this._fields||this._fields.length===0||this.rendered||(this.dataset.groupId=this._name.toLowerCase(),this.clear(),this._name&&this._showName&&(this._nameContainerElement.append(m("h4",{textContent:this._name,className:R("body-small-bold"),style:{fontSize:".8rem",marginLeft:".25rem",lineHeight:"normal"}})),this.append(this._nameContainerElement)),this._fieldsContainerElement.append(...this.fieldElements),this.append(this._fieldsContainerElement),this.rendered=!0)}};customElements.define("setting-group",se);var le=class extends HTMLElement{constructor(){super();c(this,"_isRender");c(this,"rendered");c(this,"_labelContainer");c(this,"_inputElement");c(this,"_tooltipInstance");c(this,"_label");c(this,"_fieldKey","");c(this,"inputOptions");this._isRender=!1,this.rendered=!1,this._label="Section",this._tooltipInstance=null,this.inputOptions=null,this._inputElement=new ie,this._labelContainer=m("div",{className:"label-wrapper",style:{display:"flex",gap:"0.5rem",alignItems:"center"}})}connectedCallback(){this.rendered||this.render(),this.updateVisibility()}disconnectedCallback(){var e;(e=this._tooltipInstance)==null||e.dispose()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}set tooltip(e){e&&(this._tooltipInstance||(this._tooltipInstance=new Oe(e)),this._tooltipInstance.content=e)}clear(){this.innerHTML=""}render(){!this.inputOptions||this.rendered||(this.dataset.fieldId=this._label.toLowerCase(),this._labelContainer.append(m("p",{textContent:this._label,className:R("body-small")})),this._tooltipInstance&&this._labelContainer.append(this._tooltipInstance.elem),this._inputElement.inputOptions=this.inputOptions,this.append(this._labelContainer,this._inputElement),this.rendered=!0)}set label(e){this._label=e,this.rendered&&this.render()}get label(){return this._label}set fieldKey(e){this._fieldKey=e}get fieldKey(){return this._fieldKey}};customElements.define("setting-field",le);var tt=t=>{let o="Invalid URL";try{let e=new URL(t);return["http:","https:"].includes(e.protocol)?{isValid:!0}:{isValid:!1,message:o}}catch(e){return{isValid:!1,message:o}}},ce=(t,o,e)=>{let r=`Enter a number between ${o} and ${e}.`;return typeof t!="number"||Number.isNaN(t)?{isValid:!1,message:r}:t<o||t>e?{isValid:!1,message:r}:{isValid:!0}},H=t=>ce(t,0,512),U=t=>ce(t,0,256),x=t=>ce(t,0,200),pe=t=>ce(t,0,100),no=t=>ce(t,0,10),ao=t=>{if(!t||t.trim()==="")return{isValid:!1,message:"URL cannot be empty."};try{let o=new URL(t);return!o.hostname.endsWith("fonts.googleapis.com")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Hostname is not a Google Fonts domain."}:o.protocol!=="http:"&&o.protocol!=="https:"?{isValid:!1,message:"Protocol must be HTTP or HTTPS."}:!o.pathname.startsWith("/css")&&!o.pathname.startsWith("/earlyaccess")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Path is not a typical Google Fonts CSS path."}:o.hostname.endsWith("fonts.googleapis.com")&&!o.searchParams.has("family")?{isValid:!1,message:"URL does not contain the 'family' parameter."}:{isValid:!0}}catch(o){return{isValid:!1,message:"Invalid URL format."}}};async function so(t,o="Text copied to clipboard!"){if(navigator.clipboard)try{await navigator.clipboard.writeText(t),console.debug(o),b(o,!1,5e3)}catch(e){console.error("Error copying to clipboard:",e),b(`Error copying to clipboard: ${e instanceof Error?e.message:e}`,!0,5e3)}else console.error("Error copying text (navigator.clipboard not found)"),b("Error copying text (navigator.clipboard not found)",!0,5e3)}async function Re(t=!1){(!localStorage.getItem(j)||t)&&(await Lr(),setTimeout(()=>{window!=null&&window.guide?(window.guide.open(),localStorage.setItem(j,"true")):console.error("Guide script loaded, but window.guide is not available.")},1e3))}async function Lr(){let t="guideScript",o=document.getElementById(t);if(o){console.debug("Guide script already mounted.");return}try{b("Please wait. Guided Tour is loading.",!1,1e3);let e=await z(Et,Ce);if(o=m("script",{id:t,type:"text/javascript",defer:!0}),!o)return;o.textContent=e,document.body.appendChild(o),console.debug("Mounted Guide script.")}catch(e){console.error("Failed to load guide script:",e),b("Failed to load Guided Tour.",!0)}}var ot={},Br=(t,o,e)=>new Promise((r,i)=>{let a=indexedDB.open(t,o);a.onerror=l=>{console.error(`IndexedDB error (db: ${t}): ${a.error}`,l),i(a.error)},a.onsuccess=l=>{let u=l.target.result;r(u)},a.onupgradeneeded=l=>{let u=l.target.result;for(let d in e)if(!u.objectStoreNames.contains(d)){let n=u.createObjectStore(d,{keyPath:e[d][0].name});for(let h of e[d])n.createIndex(h.name,h.name,{unique:h.unique})}}}),rt=(t,o,e)=>(ot[t]||(ot[t]=Br(t,o,e)),ot[t]),lo=async(t,o,e,r,i=1)=>{let a=await rt(t,i,r);return new Promise((l,u)=>{if(!a.objectStoreNames.contains(o)){u(new Error(`Object store "${o}" not found in database "${t}"`));return}let n=a.transaction(o,"readonly").objectStore(o),h;e==="all"?h=n.getAll():h=n.get(e),h.onerror=()=>{console.error(`Error getting element from store "${o}" with key "${e}" in db "${t}": ${h.error}`),u(h.error)},h.onsuccess=y=>l(y.target.result)})},co=async(t,o,e,r,i=1)=>{let a=await rt(t,i,r);return new Promise((l,u)=>{if(!a.objectStoreNames.contains(o)){u(new Error(`Object store "${o}" not found in database "${t}"`));return}let h=a.transaction(o,"readwrite").objectStore(o).add(e);h.onerror=y=>{console.error(`Error adding element to store "${o}" in db "${t}": ${h.error}`,y),u(h.error)},h.onsuccess=()=>{l()}})},po=async(t,o,e,r,i,a=1)=>{let l=await rt(t,a,i);return new Promise((u,d)=>{if(!l.objectStoreNames.contains(o)){d(new Error(`Object store "${o}" not found in database "${t}"`));return}let y=l.transaction(o,"readwrite").objectStore(o).put(r);y.onerror=D=>{console.error(`Error editing element in store "${o}" with key "${e}" in db "${t}": ${y.error}`,D),d(y.error)},y.onsuccess=()=>{u()}})};var it=1,Ae="images",nt={[Ae]:[{name:"uuid",unique:!0}]},mo="image1",uo={uuid:mo,name:"Local Image 1",data:""},go=(t,o)=>{let e=new CustomEvent("lucid-local-image-change",{detail:{operation:t,payload:o}});window.dispatchEvent(e)},ue=async()=>await lo(xe,Ae,"all",nt,it),ho=async t=>{await po(xe,Ae,mo,t,nt,it),go("edit",t)},at=async()=>{try{await ue()?console.debug("Image already Exists."):(await co(xe,Ae,uo,nt,it),console.debug("Image added successfully."),go("initialize",uo))}catch(t){console.error("Unexpected error during initialization: ",t)}};at();var de=null,Fe=null,$=new W,He=()=>{de==null||de()},st=()=>{Fe==null||Fe()},Mr=()=>{let t=m("div",{id:"settings-container"}),o=new ne;return o.isRender=!0,o.options=bo(),g.subscribe(e=>{o.options=bo(e)}),t.appendChild(o),t};function yo(){var t;$.isFloating=L.getState().isFloating,$.setContent(Mr()),L.subscribe(o=>{$.isFloating=o.isFloating},"isFloating"),(t=document.getElementById("main"))==null||t.append($),de=()=>$.open(),Fe=()=>$.close(),et(g.getState().position,He),g.subscribe(o=>{de&&et(o.position,He)},"position")}var fo={floatWin:["Floating Window","Allows settings to float. Drag header to reposition."],winPos:["Window Position","Settings window opens from context menu or nav bar."],bgMode:["Mode","Select background type."],solidColor:["Solid Color","Pick solid background color."],custImg:["Custom Image","Use custom image URL for static background."],custUMVImg:["Custom Image","Use custom image URL for playlist background."],imgSrc:["Image Source","Upload image or use URL for custom background."],custImgUrl:["Custom Image URL","Enter image URL for static background."],custImgInput:["Select Custom Image","Select local image for static background."],custImgLocal:["Select Local Image","Select images for static background."],filterBlur:["Blur","Blur level of image (0-200)."],filterBlurCustom:["Blur (Custom)","Blur level for custom page background (0-200)."],filterBlurNormal:["Blur (Default)","Blur level for default page background (0-200)."],filterBlurNpv:["Blur (NPV)","Blur level for NPV page background (0-200)."],filterExtendedBlur:["Extended background Blur","Blur level of extended page background (0-200)."],filterBright:["Brightness","Brightness of image (0-200)."],filterSat:["Saturation","Saturation of image (0-200)."],dynColor:["Dynamic Color","Dynamic color themes based on artwork."],tonalColor:["Tonal Color","Tonal color scheme for UI."],custColorEnable:["Custom Color","Enable custom color to override theme color."],custColorPicker:["Select Custom Color",'Choose base theme color. Preview: <a href="https://material-foundation.github.io/material-theme-builder/">Material Theme Builder</a>'],gFontsEnable:["Google Fonts","Enable fonts from Google Fonts."],gFontsUrl:["Google Fonts URL","URL of Google Fonts stylesheet."],fontFamily:["Font Family","Font family for UI when Google Fonts disabled."],grainType:["Grain Type","Type of grain effect overlay."],winCtrlHeight:["Control Height","Height of window control buttons on Windows (0-200)."],winPanelGap:["Panel Gap","Gap between main cards."],borderThick:["Thickness","Thickness of interface border (0-10)."],borderColor:["Color","Color of application border."],borderStyle:["Style","Visual style of interface border."],pagesBgStyle:["Style","Background display on pages."],pagesImageStyle:["Image Style","Image on pages. (playlist/album art)"],homeHeaderBg:["Home Header Background","Enable/Disable Home header background."],scrollFullBg:["Scroll Fullscreen Background","Scroll background in fullscreen playlist."],scaleFullBg:["Scale Fullscreen Background","Scale background for fullscreen playlist."],scrollNpvBg:["Scroll Background","Scroll background for Now playing art playlist."],scaleNpvBg:["Scale Background","Scale background for Now playing art playlist."],scrollNormBg:["Scroll Background","Scroll background for normal playlist."],scaleNormBg:["Scale Background","Scale background for normal playlist."],scrollCusBg:["Scroll Background","Scroll background for custom playlist."],scaleCusBg:["Scale Custom Background","Scale background for custom playlist."],rsbViewMode:["View Mode","Normal or compact 'Now Playing' sidebar."],rsbSize:["Compact Sidebar Width","Width of compact 'Now Playing' sidebar (0-512px)."],rsbPos:["Position","Position of compact 'Now Playing' sidebar."],rsbBgBlur:["Blur","Background blur of compact 'Now Playing' view (0-256)."],rsbCustBgEnable:["Custom Background","Enable custom background for Now Playing view."],rsbBgColor:["Color","Background color for 'Now Playing' sidebar."],rsbBgAlpha:["Alpha","Background transparency (alpha) value (0-100)."],rsbBorderAlpha:["Border Alpha","Border transparency (alpha) value (0-100)."],playbarType:["Playbar Type","Default or Compact playbar style."],compactPbHideIcons:["Hide Extra Playbar Icons","Hides extra icons in compact playbar (on hover)."],compactPbBorderRad:["Border Radius","Border Radius of compact playbar in pixels."],normalPbBorderRad:["Border Radius","Border Radius of normal playbar in pixels."],compactPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in compact playbar in pixels."],normalPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in normal playbar in pixels."],compactPbHeight:["Height","Height of compact playbar in pixels."],normalPbHeight:["Height","Height of normal playbar in pixels."],playbarFloat:["Floating","Now playing bar is floating."],pbBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],pbBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],pbBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],showChangelog:["Show Changelog","Changelog modal after updates."],lucidTour:["Take a Lucid Tour","Guided walkthrough of Lucid theme features."],exportSettings:["Export Settings","Export settings to clipboard as JSON."],importSettings:["Import Settings","Import settings from JSON."],resetSettings:["Reset All Settings","Reset all settings to default values (irreversible)."],pagesScrollType:["Image Source","Now Playing View art or default playlist art for pages."]};function bo(t=g.getState(),o=g){var r,i,a,l,u,d;let e=(n,h,y)=>({render:y===void 0?!0:y,inputOptions:h,label:fo[n][0],tooltip:fo[n][1],key:n.replace(/([A-Z])/g,"-$1").toLowerCase()});return[{name:"General",render:!0,groups:[{render:!0,name:"Behavior",key:"group-behavior",showName:!1,fields:[e("lucidTour",{type:"button",buttonType:"primary",contents:"Start",onClick:()=>{localStorage.removeItem("lucid-guided-tour"),st(),Re(!0)}}),e("floatWin",{type:"checkbox",checked:L.getState().isFloating,onChange:n=>{L.setState(h=>p(s({},h),{isFloating:n}))}}),e("winPos",{type:"select",value:t.position,options:[{label:"Context Menu",value:"context-menu"},{label:"Navigation Bar",value:"nav"}],onChange:n=>{o.setPosition(n)}})]}]},{name:"Background",render:!0,groups:[{render:!0,name:"Mode",key:"group-background-mode",fields:[e("bgMode",{type:"select",value:t.background.mode,options:[{label:"Animated",value:"animated"},{label:"Solid Color",value:"solid"},{label:"Static Image",value:"static"}],onChange:n=>{o.setBackgroundMode(n)}})]},{name:"Background",key:"group-bg-background",render:!0,fields:[e("solidColor",{type:"color",value:t.background.options.solid.color.hex,onChange:n=>{o.setSolidBackgroundColor({hex:n})}},t.background.mode==="solid"),e("rsbBgAlpha",{type:"number",value:t.background.options.solid.color.alpha,validator:pe,onChange:n=>{o.setSolidBackgroundColor({alpha:n})}},t.background.mode==="solid"),e("custImg",{type:"checkbox",checked:t.background.options.static.isCustomImage,onChange:n=>{o.setStaticBackgroundOptions({isCustomImage:n})}},t.background.mode==="static"),e("imgSrc",{type:"select",value:t.customImage.type,options:[{label:"Local",value:"local"},{label:"From Url",value:"url"}],onChange:n=>{o.setCustomImageType(n)}},t.background.mode==="static"&&t.background.options.static.isCustomImage),e("custImgUrl",{type:"text",value:(r=t.customImage.options.url.data)!=null?r:"Enter Image URL",validator:tt,onChange:n=>{o.setCustomImageOptions("url",{data:n})}},t.background.mode==="static"&&t.background.options.static.isCustomImage&&t.customImage.type==="url"),e("custImgInput",{type:"image",onChange:async n=>{n&&ho(p(s({},(await ue())[0]),{data:n}))}},t.background.mode==="static"&&t.background.options.static.isCustomImage&&t.customImage.type==="local")]},{render:t.background.mode!=="solid",name:"Filters",key:"group-bg-filters",fields:[e("filterBlur",{type:"number",value:t.background.options.static.filter.blur,onChange:n=>{o.setStaticBackgroundFilter({blur:n})},step:1,validator:x},t.background.mode==="static"),e("filterBright",{type:"number",value:t.background.options.static.filter.brightness,onChange:n=>{o.setStaticBackgroundFilter({brightness:n})},step:1,validator:x},t.background.mode==="static"),e("filterSat",{type:"number",value:t.background.options.static.filter.saturate,onChange:n=>{o.setStaticBackgroundFilter({saturate:n})},step:.1,validator:x},t.background.mode==="static"),e("filterBlur",{type:"number",value:t.background.options.animated.filter.blur,onChange:n=>{o.setAnimatedBackgroundFilter({blur:n})},step:1,validator:x},t.background.mode==="animated"),e("filterBright",{type:"number",value:t.background.options.animated.filter.brightness,onChange:n=>{o.setAnimatedBackgroundFilter({brightness:n})},step:1,validator:x},t.background.mode==="animated"),e("filterSat",{type:"number",value:t.background.options.animated.filter.saturate,onChange:n=>{o.setAnimatedBackgroundFilter({saturate:n})},step:1,validator:x},t.background.mode==="animated")]},{render:!0,name:"Color",key:"group-color",fields:[e("dynColor",{type:"checkbox",checked:t.color.isDynamic,onChange:n=>{o.setDynamicColor(n)}}),e("tonalColor",{type:"checkbox",checked:t.color.isTonal,onChange:n=>{o.setTonalColor(n)}}),e("custColorEnable",{type:"checkbox",checked:t.color.isCustom,onChange:n=>{o.setIsCustomColor(n)}},!t.color.isDynamic),e("custColorPicker",{type:"color",value:t.color.customColor.hex,onChange:n=>{o.setCustomColor({hex:n})}},!t.color.isDynamic&&t.color.isCustom)]}]},{name:"Interface",render:!0,groups:[{render:!0,name:"Font",key:"group-font",fields:[e("gFontsEnable",{type:"checkbox",checked:t.font.isGoogleFonts,onChange:n=>{o.setFont({isGoogleFonts:n})}}),e("gFontsUrl",{type:"text",value:t.font.fontUrl||"",validator:ao,onChange:n=>{o.setFont({fontUrl:n})}},t.font.isGoogleFonts),e("fontFamily",{type:"text",value:t.font.fontFamily||"",onChange:n=>{o.setFont({fontFamily:n})}},!t.font.isGoogleFonts)]},{render:!0,key:"group-grain-effect",name:"Grain Effect",fields:[e("grainType",{type:"select",value:t.grains.type,options:[{label:"Normal",value:"default"},{label:"Starry",value:"starry"},{label:"None",value:"none"}],onChange:n=>{o.setGrainsType(n)}})]},{render:!0,key:"group-window-controls",name:"Window",fields:[e("winPanelGap",{type:"number",step:1,value:t.pages.panelGap,validator:pe,onChange:n=>{o.setPages({panelGap:n})}}),e("winCtrlHeight",{type:"number",step:1,value:t.control.height,validator:x,onChange:n=>{o.setControlHeight(n)}},Be())]},{render:!0,key:"group-border",name:"Border",fields:[e("borderThick",{type:"number",step:1,value:t.border.thickness,validator:no,onChange:n=>{o.setBorder({thickness:n})}}),e("borderStyle",{type:"select",options:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],onChange:n=>{o.setBorder({style:n})},value:t.border.style}),e("borderColor",{type:"color",value:t.border.color.hex,onChange:n=>{o.setBorderColor({hex:n})}}),e("rsbBorderAlpha",{type:"number",value:t.border.color.alpha,validator:pe,onChange:n=>{o.setBorderColor({alpha:n})}})]},{render:!0,key:"group-now-playing-view",name:"Now Playing View",fields:[e("rsbViewMode",{type:"select",value:t.rightSidebar.mode,options:[{label:"Normal",value:"normal"},{label:"Compact",value:"compact"}],onChange:n=>{o.setRightSidebar({mode:n})}}),e("rsbSize",{type:"number",value:t.rightSidebar.size,validator:H,onChange:n=>{o.setRightSidebar({size:n})}},t.rightSidebar.mode==="compact"),e("rsbPos",{type:"select",value:t.rightSidebar.position,options:[{label:"Top Left",value:"top left"},{label:"Top Right",value:"top right"},{label:"Bottom Left",value:"bottom left"},{label:"Bottom Right",value:"bottom right"}],onChange:n=>{o.setRightSidebar({position:n})}},t.rightSidebar.mode==="compact"),e("rsbBgBlur",{type:"number",value:t.rightSidebar.blur,validator:U,onChange:n=>{o.setRightSidebar({blur:n})}},t.rightSidebar.mode==="compact"),e("rsbCustBgEnable",{type:"checkbox",checked:t.rightSidebar.isCustomBg,onChange:n=>{o.setRightSidebar({isCustomBg:n})}}),e("rsbBgColor",{type:"color",value:t.rightSidebar.color.hex,onChange:n=>{o.setRightSidebarColor({hex:n})}},t.rightSidebar.isCustomBg),e("rsbBgAlpha",{type:"number",value:t.rightSidebar.color.alpha,validator:pe,onChange:n=>{o.setRightSidebarColor({alpha:n})}},t.rightSidebar.isCustomBg)]}]},{name:"Page Settings",render:!0,groups:[{render:!0,key:"group-page-style",name:"Page Styles",fields:[e("homeHeaderBg",{type:"checkbox",checked:t.pages.hideHomeHeader,onChange:n=>{o.setPages({hideHomeHeader:n})}}),e("pagesBgStyle",{type:"select",value:t.pages.style,onChange:n=>{o.setPageStyle(n)},options:[{label:"Default",value:"normal"},{label:"Card",value:"card"},{label:"Compact",value:"compact"},{label:"Compact Card",value:"compact-card"}]}),e("pagesImageStyle",{type:"select",value:t.pages.imageStyle,onChange:n=>{o.setPageImageStyle(n)},options:[{label:"Default",value:"default"},{label:"As Bg",value:"as-bg"},{label:"Hidden",value:"hidden"}]}),e("pagesScrollType",{type:"select",value:t.pages.umv.type,options:[{value:"normal",label:"Default"},{value:"custom",label:"Custom"},{value:"npv",label:"Now Playing Art"}],onChange:n=>{o.setUMV({type:n})}}),e("custUMVImg",{type:"text",validator:tt,value:(i=t.pages.umv.options.custom.url)!=null?i:"Enter a Url",onChange:n=>{o.setUMVOption("custom",{url:n})}},t.pages.umv.type==="custom")]},{key:"group-page-image-filter",name:"Page Background Image Filter",render:!0,fields:[e("filterBlurCustom",{type:"number",validator:x,value:(a=t.pages.umv.options.custom.filter)==null?void 0:a.blur,onChange:n=>{o.setUMVFilter("custom",{blur:n})}},t.pages.umv.type==="custom"),e("filterBlurNormal",{type:"number",validator:x,value:(l=t.pages.umv.options.normal.filter)==null?void 0:l.blur,onChange:n=>{o.setUMVFilter("normal",{blur:n})}},t.pages.umv.type==="normal"),e("filterBlurNpv",{type:"number",validator:x,value:(u=t.pages.umv.options.npv.filter)==null?void 0:u.blur,onChange:n=>{o.setUMVFilter("npv",{blur:n})}},t.pages.umv.type==="npv"),e("filterExtendedBlur",{type:"number",validator:x,value:(d=t.pages.umv.options.expanded.filter)==null?void 0:d.blur,onChange:n=>{o.setUMVFilter("expanded",{blur:n})}})]},{key:"group-page-bg-behavior",name:"Background Behavior",render:!0,fields:[e("scrollCusBg",{type:"checkbox",checked:t.pages.umv.options.custom.isScroll,onChange:n=>{o.setUMVOption("custom",{isScroll:n})}},t.pages.umv.type==="custom"),e("scaleCusBg",{type:"checkbox",checked:t.pages.umv.options.custom.isScaling,onChange:n=>{o.setUMVOption("custom",{isScaling:n})}},t.pages.umv.type==="custom"),e("scrollNormBg",{type:"checkbox",checked:t.pages.umv.options.normal.isScroll,onChange:n=>{o.setUMVOption("normal",{isScroll:n})}},t.pages.umv.type==="normal"),e("scaleNormBg",{type:"checkbox",checked:t.pages.umv.options.normal.isScaling,onChange:n=>{o.setUMVOption("normal",{isScaling:n})}},t.pages.umv.type==="normal"),e("scrollNpvBg",{type:"checkbox",checked:t.pages.umv.options.npv.isScroll,onChange:n=>{o.setUMVOption("npv",{isScroll:n})}},t.pages.umv.type==="npv"),e("scaleNpvBg",{type:"checkbox",checked:t.pages.umv.options.npv.isScaling,onChange:n=>{o.setUMVOption("npv",{isScaling:n})}},t.pages.umv.type==="npv"),e("scrollFullBg",{type:"checkbox",checked:t.pages.umv.options.expanded.isScroll,onChange:n=>{o.setUMVOption("expanded",{isScroll:n})}}),e("scaleFullBg",{type:"checkbox",checked:t.pages.umv.options.expanded.isScaling,onChange:n=>{o.setUMVOption("expanded",{isScaling:n})}})]}]},{name:"Playbar Settings",render:!0,groups:[{render:!0,name:"General",key:"group-playbar-general",showName:!1,fields:[e("playbarType",{type:"select",value:t.playbar.type,onChange:n=>{o.setPlaybar({type:n})},options:[{label:"Default",value:"normal"},{label:"Compact",value:"compact"}]}),e("playbarFloat",{type:"checkbox",checked:t.playbar.isFloating,onChange:n=>{o.setPlaybar({isFloating:n})}})]},{render:t.playbar.type==="compact",name:"Compact Playbar",key:"group-playbar-compact",showName:!0,fields:[e("compactPbHideIcons",{type:"checkbox",checked:t.playbar.hideIcons,onChange:n=>{o.setPlaybar({hideIcons:n})}}),e("compactPbHeight",{type:"number",value:t.playbar.options.compact.height,validator:H,onChange:n=>{o.setPlaybarOptions("compact",{height:n})}}),e("compactPbBorderRad",{type:"number",value:t.playbar.options.compact.borderRadius,validator:H,onChange:n=>{o.setPlaybarOptions("compact",{borderRadius:n})}}),e("pbBackdropBlur",{type:"number",value:t.playbar.options.compact.backdropFilter.blur,validator:U,onChange:n=>{o.setPlaybarFilter("compact",{blur:n})}},t.playbar.isFloating),e("pbBackdropSat",{type:"number",value:t.playbar.options.compact.backdropFilter.saturate,validator:U,onChange:n=>{o.setPlaybarFilter("compact",{saturate:n})}},t.playbar.isFloating),e("pbBackdropBright",{type:"number",value:t.playbar.options.compact.backdropFilter.brightness,validator:U,onChange:n=>{o.setPlaybarFilter("compact",{brightness:n})}},t.playbar.isFloating),e("compactPbImgBorderRad",{type:"number",value:t.playbar.options.compact.imageRadius,validator:H,onChange:n=>{o.setPlaybarOptions("compact",{imageRadius:n})}})]},{render:t.playbar.type==="normal",name:"Normal Playbar",key:"group-playbar-normal",showName:!0,fields:[e("normalPbHeight",{type:"number",value:t.playbar.options.normal.height,validator:H,onChange:n=>{o.setPlaybarOptions("normal",{height:n})}}),e("normalPbBorderRad",{type:"number",value:t.playbar.options.normal.borderRadius,validator:H,onChange:n=>{o.setPlaybarOptions("normal",{borderRadius:n})}}),e("pbBackdropBlur",{type:"number",value:t.playbar.options.normal.backdropFilter.blur,validator:U,onChange:n=>{o.setPlaybarFilter("normal",{blur:n})}},t.playbar.isFloating),e("pbBackdropSat",{type:"number",value:t.playbar.options.normal.backdropFilter.saturate,validator:U,onChange:n=>{o.setPlaybarFilter("normal",{saturate:n})}},t.playbar.isFloating),e("pbBackdropBright",{type:"number",value:t.playbar.options.normal.backdropFilter.brightness,validator:U,onChange:n=>{o.setPlaybarFilter("normal",{brightness:n})}},t.playbar.isFloating),e("normalPbImgBorderRad",{type:"number",value:t.playbar.options.normal.imageRadius,validator:H,onChange:n=>{o.setPlaybarOptions("normal",{imageRadius:n})}})]}]},{name:"Advanced Settings",render:!0,groups:[{render:!0,name:"App Settings",key:"group-application-settings",showName:!1,fields:[e("showChangelog",{type:"checkbox",checked:t.showChangelog,onChange:n=>{o.setChangelog(n)}}),e("exportSettings",{type:"button",buttonType:"primary",contents:"Copy Settings",onClick:()=>{so(o.exportSettings(),"Settings copied to clipboard!")}}),e("importSettings",{type:"text",value:"",validator:n=>{try{return Ee(JSON.parse(n))?{isValid:!0}:{isValid:!1,message:"Not a valid lucid settings."}}catch(h){return{isValid:!1,message:"Not a valid lucid settings."}}},onChange:n=>{o.importSettings(n)}}),e("resetSettings",{type:"button",buttonType:"danger",contents:"Reset",onClick:()=>{confirm("Are you sure you want to reset all settings to default values? This action cannot be undone.")&&(o.resetState(),window.location.reload())}})]}]}]}function q(t){let o="";return t.blur&&(o+=`blur(${t.blur}px) `),t.brightness&&(o+=`brightness(${t.brightness}%) `),t.contrast&&(o+=`contrast(${t.contrast}%) `),t.grayscale&&(o+=`grayscale(${t.grayscale}) `),t.hueRotate&&(o+=`hue-rotate(${t.hueRotate}) `),t.invert&&(o+=`invert(${t.invert}) `),t.opacity&&(o+=`opacity(${t.opacity}%) `),t.saturate&&(o+=`saturate(${t.saturate||0}%) `),t.sepia&&(o+=`sepia(${t.sepia}) `),o.trim()}var Ue=class extends HTMLElement{constructor(){super();c(this,"currentImgElement");c(this,"nextImgElement");c(this,"transitionDuration","0.3s");c(this,"currentFilters",null);c(this,"src","");c(this,"transitioning",!1);this.currentImgElement=m("img",{style:this.getBaseImageStyle({opacity:"1"})}),this.nextImgElement=m("img",{style:this.getBaseImageStyle({opacity:"0",position:"absolute",top:"0",left:"0"})}),this.appendChild(this.currentImgElement),this.appendChild(this.nextImgElement)}getBaseImageStyle(e){return s({display:"block",width:"100%",height:"100vh",objectFit:"cover",objectPosition:"center",transform:"translate3d(0px,0px,0px)",transition:`opacity ${this.transitionDuration} ease-in-out`},e)}set customFilter(e){this.currentFilters=e,this.currentImgElement.style.filter=q(e),this.nextImgElement.style.filter=q(e)}setImageSource(e){if(this.src===e||this.transitioning)return;this.src=e;let r=new Image;r.onload=()=>{this.performTransition(e)},r.onerror=()=>{console.error("Failed to load image:",e)},r.src=e}performTransition(e){this.transitioning=!0,this.nextImgElement.src=e;let r=this.currentImgElement;this.currentImgElement=this.nextImgElement,this.nextImgElement=r,this.currentImgElement.style.opacity="1",this.nextImgElement.style.opacity="0",setTimeout(()=>{if(this.src!==e){this.transitioning=!1;return}this.transitioning=!1,this.currentFilters&&(this.currentImgElement.style.filter=q(this.currentFilters))},Number.parseFloat(this.transitionDuration)*1e3)}};customElements.define("static-background",Ue);var me=Ue;var $e=class extends HTMLElement{constructor(){super();c(this,"imgElements",[]);c(this,"src","");c(this,"transitionDuration","0.3s");this.style.display="block";let e=document.createElement("style");e.textContent=`
#image-1 {
	left: 0%;
	top: -50%;
	z-index: 1;
}
#image-2 {
	animation-direction: reverse;
	top: 20%;
	left: -50%;
	z-index: 1;
}
#image-3 {
	animation-direction: reverse;
	right: -50%;
	top: -20%;
	width: 200%;
	z-index: 0;
}
@keyframes animBg {
	0% {
		transform: rotate(0turn) translate3d(0px,0px,0px);
	}
	to {
		transform: rotate(1turn) translate3d(0px,0px,0px);
	}
}`,this.appendChild(e);for(let r=0;r<3;r++){let i=document.createElement("div");i.id=`image-${r+1}`,i.classList.add("image",`${r+1}`),Object.assign(i.style,{width:"100ch",height:"100ch",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",animation:"animBg 30s linear infinite",willChange:"contents",position:"absolute",transition:`opacity ${this.transitionDuration} ease-in-out`,opacity:"0"}),this.imgElements.push(i),this.appendChild(i),i.offsetWidth,i.style.opacity="1"}}get customFilter(){return this.customFilter}set customFilter(e){this.style.filter=q(e)}setImageSource(e){this.src!==e&&(this.src=e,this.performTransition(e))}performTransition(e){for(let r of this.imgElements){let i=new Image;i.onload=()=>{r.style.backgroundImage=`url(${e})`},i.onerror=()=>{console.error("Failed to load image:",e)},i.src=e}}};customElements.define("animated-background",$e);var ge=$e;var Ve=class extends HTMLElement{constructor(){super();c(this,"backgroundElement",null);c(this,"options",null);c(this,"currentMode","static");Object.assign(this.style,{width:"100%",height:"100vh",display:"block",position:"fixed",inset:"0px",backgroundColor:"var(--clr-surface)"}),this.render()}set image(e){(this.backgroundElement instanceof me||this.backgroundElement instanceof ge)&&this.currentMode!=="solid"&&this.backgroundElement.setImageSource(e)}get mode(){return this.currentMode}set mode(e){this.currentMode!==e&&(this.currentMode=e,this.setAttribute("mode",e),this.render())}setOptions(e){this.options=e,this.updateOptions()}getOptions(){return this.options}updateOptions(){if(!(!this.options||!this.backgroundElement))switch(this.currentMode){case"static":this.backgroundElement instanceof me&&(this.backgroundElement.customFilter=this.options.static.filter||{});break;case"solid":this.backgroundElement instanceof HTMLDivElement&&this.backgroundElement.classList.contains("solid")&&Object.assign(this.backgroundElement.style,{backgroundColor:this.options.solid.color.hex+O(this.options.solid.color.alpha||1)||"var(--clr-surface, #101010)"});break;case"animated":this.backgroundElement instanceof ge&&(this.backgroundElement.customFilter=this.options.animated.filter||{});break}}render(){let e=this.currentMode,r=this.image,i=this.querySelector("#bg-wrapper");switch(i||(i=m("div",{id:"bg-wrapper",style:{width:"100%",height:"100%"},innerHTML:""}),i.setAttribute("mode",this.currentMode),this.appendChild(i)),e){case"static":{let a;this.backgroundElement instanceof me?a=this.backgroundElement:(a=new me,a.setImageSource(r),this.backgroundElement=a),i.appendChild(a);break}case"solid":{let a;this.backgroundElement instanceof HTMLDivElement&&this.backgroundElement.classList.contains("solid")?a=this.backgroundElement:(a=m("div",{className:"solid background"}),Object.assign(a.style,{width:"100%",height:"100vh"}),this.backgroundElement=a),i.appendChild(a);break}case"animated":{let a;this.backgroundElement instanceof ge?a=this.backgroundElement:(a=new ge,a.setImageSource(r),this.backgroundElement=a),i.appendChild(a);break}}this.updateOptions()}};customElements.define("lucid-background-container",Ve);var vo=Ve;var T=null,he=null;function lt(t){var o,e,r,i;T&&(T.image=(i=(r=(e=(o=t.detail)==null?void 0:o.payload)==null?void 0:e.data)!=null?r:w.getState().url)!=null?i:"")}function So(){if(T)return;T=new vo;let t=Pr(),o=a=>{T&&(T.image=a)},e=()=>{he||(he=w.subscribe(a=>{!g.getState().background.options.static.isCustomImage&&T&&o(a.url||"")}))},r=()=>{he&&(he(),he=null),window.removeEventListener("lucid-local-image-change",lt)},i=async(a=g.getState())=>{var d;if(!T)return;let{background:l,customImage:u}=a;if(T.mode=l.mode,T.setOptions(l.options),l.options.static.isCustomImage){if(r(),u.type==="url")o(u.options.url.data);else if(u.type==="local")try{let n=await ue();o(((d=n==null?void 0:n[0])==null?void 0:d.data)||w.getState().url||""),window.addEventListener("lucid-local-image-change",lt)}catch(n){console.error("Error setting local image.")}}else e(),window.removeEventListener("lucid-local-image-change",lt),o(w.getState().url||"")};i(),g.subscribe(a=>i(a),"background"),g.subscribe(a=>i(a),"customImage"),t.appendChild(T)}function Pr(){let t=document.getElementById("lucid-bg");return t||(t=m("div"),t.id="lucid-bg",xt("main").prepend(t)),t}function _o(t=g.getState().rightSidebar){t.position?document.body.setAttribute("npv-position",t.position):document.body.removeAttribute("npv-position"),t.mode?document.body.setAttribute("npv-mode",t.mode):document.body.removeAttribute("npv-mode"),document.body.style.setProperty("--npv-blur",`${t.blur}px`),t.isCustomBg?document.body.style.setProperty("--npv-bg-color",`${t.color.hex}${O(t.color.alpha)}`):document.body.style.removeProperty("--npv-bg-color");function o(e){document.body.style.setProperty("--npv-size",`${e}px`)}o(t.size)}function Eo(){_o(),g.subscribe(t=>{_o(t.rightSidebar)},"rightSidebar")}var Ne=null;function wo(t=g.getState().grains){let o=t.type;Ne!==o&&(Ne&&document.body.classList.remove(`grain-${Ne}`),o?(document.body.setAttribute("grain-type",o),document.body.classList.add(`grain-${o}`)):document.body.removeAttribute("grain-type"),Ne=o)}function Co(){wo(),g.subscribe(t=>{wo(t.grains)},"grains")}function Or(t,o){let e=t.split(".").map(Number),r=o.split(".").map(Number),i=Math.max(e.length,r.length);for(let a=0;a<i;a++){let l=e[a]||0,u=r[a]||0;if(l>u)return 1;if(l<u)return-1}return 0}var fe=class extends HTMLElement{constructor(e){super();c(this,"_data",null);c(this,"_currentVersion");c(this,"hasUpdate",!1);this._currentVersion=Q,e&&(this._data=e,this.hasUpdate=this.checkForUpdate())}connectedCallback(){S("lucid-changelog").textContent=".changelog-entry,.update-available-header {  padding: 1rem 1rem;  background-color: rgba(var(--clr-on-secondary-rgb), 0.5);  color: var(--clr-secondary);  margin-bottom: 0.5rem;  border-radius: 0.5rem;}.update-available-header {  text-align: center;  font-size: 1.8em;  color: var(--clr-primary);}.changelog-entry > p {  margin-bottom: 0.5rem;}.changes-wrapper {  display: flex;  flex-wrap: wrap;  gap: 0.5rem;}.changelog-entry,.update-available-header,.change-card {  border: var(--border-thickness, 1px) var(--border-style, solid)    var(--border-color, var(--clr-surface-5, #1c1b1e));}.change-card {  flex-grow: 1;  padding: 10px;  border-radius: 0.75rem;  min-width: 10em;}.change-card:nth-child(2n) {  background-color: rgba(var(--clr-on-primary-rgb), 0.7);  color: var(--clr-primary);}.change-card:nth-child(2n + 1) {  background-color: rgba(var(--clr-on-secondary-rgb), 0.7);  color: var(--clr-secondary);}.change-card:nth-child(2n + 3) {  background-color: rgba(var(--clr-on-tertiary-rgb), 0.7);  color: var(--clr-tertiary);}.change-card li {  list-style: disc;  margin-left: 2rem;}.change-card li:marker {  right: 4px;}",this.render()}checkForUpdate(){if(this._data&&this._data.length>0&&this._currentVersion){let e=this._data[0].version;return Or(e,this._currentVersion)>0}return!1}render(){if(this.innerHTML="",!this._data){this.innerHTML="<p>Error loading changelog data.</p>",console.error("Invalid changelog data format.");return}if(this._data.length<1){this.innerHTML="<p>No changelog entries available.</p>",console.warn("No elements present to show changelog.");return}let e=this._data.map(a=>{let l="";for(let d in a.changes)if(Object.prototype.hasOwnProperty.call(a.changes,d)){let n=a.changes[d];if(n&&n.length>0){let h=n.map(y=>`<li>${y}</li>`).join("");l+=`
                    <div class="change-card">
                      <h3 class='encore-text encore-text-small-bold'>${d}</h3>
                      <ul>${h}</ul>
                    </div>
                  `}}let u=a.desc?`<p>${a.desc}</p>`:"";return`
              <div class="changelog-entry">
                <h2>${a.version} - ${a.date}</h2>
                ${u}
                <div class="changes-wrapper">
                  ${l}
                </div>
              </div>
            `}).join(""),r="";this.hasUpdate&&(r='<h1 class="update-available-header">Update Available</h1>');let i=document.createElement("div");i.innerHTML=`
        ${r}
        <div class="changelog-entries-container">${e}</div>`,this.appendChild(i)}updateData(e){this._data=e,this.hasUpdate=this.checkForUpdate(),this.render()}};customElements.define("changelog-component",fe);async function Rr(){try{let t=await z(Ct,ke,21600);return JSON.parse(t)}catch(t){return console.error("Error fetching changelog.",t),[]}}async function ko(t=document.body){if(!g.getState().showChangelog)return;let o=await Rr();if(typeof o=="object"&&o.length<1){console.error("Changelog data not found.");return}let e=new N;e.setHeader("Lucid Changelog");let r=new fe(o);!(localStorage.getItem(V)===Q)||r.hasUpdate?(e.setContent(r),t.appendChild(e),e.open(),localStorage.setItem(V,Q)):console.debug("Changelog already shown for this version.")}var xo=()=>{var t;window.lucid={config:()=>g.getState(),reset:()=>{g.resetState()},store:g,version:(t=localStorage.getItem(V))!=null?t:"2.1.1",settings:{openSettings:He,closeSettings:st,settingModal:$}}};var Ar=()=>{try{xo(),at(),setTimeout(Hr,500),Fr(),So(),Rt(),Ht(),Co(),Ye(),Gt(),qt(),Zt(),Eo(),Ze(),g.subscribe(t=>{Ze(t.color)},"color"),yo(),Re(),ko()}catch(t){console.error("Unexpected Error: ",t),b("Lucid: Unexpected error. please report it to dev")}};console.time("Main fn start");Ar();console.timeEnd("Main fn start");function Fr(){let t=()=>{let o=g.getState().border,e=S("lucid-border");e.textContent=":root{",e.textContent+=`--border-color:${o.color.hex}${O(o.color.alpha)};`,o.style&&(e.textContent+=`--border-style:${o.style};`),o.thickness&&(e.textContent+=`--border-thickness:${o.thickness}px;`),e.textContent+="}"};t(),g.subscribe(t,"border")}function Hr(){var e,r;M([".Root__now-playing-bar",".Root__globalNav"],([i,a])=>{document.body.style.setProperty("--umv-offset",`${((i==null?void 0:i.clientHeight)||80)+((a==null?void 0:a.clientHeight)||64)}px`)});let t=new te,o=(e=document.querySelector(".under-main-view"))==null?void 0:e.parentElement;o?o.prepend(t):(r=document.querySelector(".main-view-container"))==null||r.prepend(t)}})();
})();