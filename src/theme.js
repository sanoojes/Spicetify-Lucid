(async () => { while (!Spicetify.React || !Spicetify.ReactDOM) { await new Promise((resolve) => setTimeout(resolve, 10));}"use strict";var Lucid=(()=>{function a(e,t){let o=document.createElement(e);if(!t)return o;if(t.attributes)for(let[l,c]of Object.entries(t.attributes))c?o.setAttribute(l,c):o.removeAttribute(l);t.style&&Object.assign(o.style,t.style);let{style:r,attributes:i,...n}=t;return Object.assign(o,n),o}var G="https://raw.githubusercontent.com/sanoojes/Spicetify-Lucid/refs/heads/main",z="https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main",W="2.1.1",K="lucid-guided-tour",$e=[`${G}/src/workers/getColor.js`,`${z}/src/workers/getColor.js`],le="LUCID_COLOR_SCRIPT_CACHE",De="#1bc858",ce="LUCID_GUIDE_SCRIPT_CACHE",Ge=[`${G}/src/guidedTour.js`,`${z}/src/guidedTour.js`],ze="lucid-theme-settings",A="lucid-current-version",We=[`${G}/changelog.json`,`${z}/changelog.json`],pe="lucid-changelog-data";var Ke=[`${G}/src/icons.css`,`${z}/src/icons.css`,`${G}/styles/icons.css`,`${z}/styles/icons.css`];var Ee={showChangelog:!0,position:"nav",background:{mode:"static",options:{static:{isCustomImage:!1,filter:{blur:32,brightness:60,saturate:150}},solid:{color:{hex:"#1a211c",alpha:100}},animated:{filter:{blur:32,brightness:60,saturate:150}}}},color:{customColor:{hex:"#00ffa1",alpha:100},isTonal:!0,isCustom:!1,isDynamic:!1,extractorOptions:{pixels:36e4,distance:.1,hueDistance:.2,lightnessDistance:.2,saturationDistance:.2}},pages:{panelGap:8,hideHomeHeader:!1,style:"card",imageStyle:"default",umv:{type:"normal",options:{expanded:{isScroll:!1,isScaling:!0,filter:{blur:0}},custom:{url:"https://picsum.photos/1920/1080?random",isScroll:!1,isScaling:!0,filter:{blur:8}},normal:{isScroll:!1,isScaling:!0,filter:{blur:8}},npv:{isScroll:!1,isScaling:!0,filter:{blur:8}}}}},border:{thickness:1,color:{hex:"#454545",alpha:50},style:"solid"},control:{height:40},font:{fontFamily:"Poppins",fontUrl:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",isGoogleFonts:!0},grains:{type:"starry"},rightSidebar:{isCustomBg:!1,mode:"normal",position:"bottom right",blur:16,size:240,color:{hex:"#1a211c",alpha:50}},playbar:{type:"normal",hideIcons:!0,options:{normal:{height:80,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}},compact:{height:64,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}}},isFloating:!0},customImage:{type:"url",options:{url:{data:"https://picsum.photos/1920/1080?random"},local:null}}};var h=e=>{let t=document.querySelector(`#style-${e}`);return t||(t=a("style",{id:`style-${e}`}),document.body.appendChild(t)),t};var d=(e,t=!1,o)=>{for(;!Spicetify.showNotification;)setTimeout(d,500);console.debug(`Notification: ${e} (Error: ${t}, Timeout: ${o})`),Spicetify.showNotification(e,t,o)};function Xt(){for(let e of Ke)if(!document.querySelector(`link[href="${e}"]`)){let o=a("link",{rel:"stylesheet",href:e});document.head.appendChild(o)}}var qe=()=>{try{Xt();let e=(r,i=!1)=>i?t.get(r).replace(/[{0}{1}«»”“]/g,"").trim():t.get(r),t=Spicetify.Locale;if(!t)return;let o={home:e("view.web-player-home"),browse:e("browse"),pause:e("pause"),play:e("play"),close:e("close"),openMiniPlayer:e("miniplayer.open"),createPlaylist:e("contextmenu.create-playlist"),createButton:e("web-player.your-library-x.create.button-label"),fullscreen:e("npv.full-screen"),closeBtn:e("close_button_action"),duration:e("sort.duration"),search:e("navbar.search"),queue:e("playback-control.queue"),searchPlaylist:e("playlist.search_in_playlist"),download:e("download.download"),copyTrackLink:e("context-menu.copy-track-link"),moreContext:e("more.label.context",!0),downloadContext:e("contextmenu.download"),friendActivity:e("buddy-feed.friend-activity"),whatsNew:e("web-player.whats-new-feed.button-label"),skipForward:e("playback-control.skip-forward"),skipBack:e("playback-control.skip-back"),disableShuffle:e("playback-control.disable-shuffle"),enableShuffle:e("playback-control.enable-shuffle"),disableShuffleGeneric:e("web-player.smart-shuffle.button-disable-shuffle-generic"),disableShuffleSpecific:e("web-player.smart-shuffle.button-disable-shuffle-specific",!0),enableShuffleGeneric:e("web-player.smart-shuffle.button-enable-shuffle-generic"),enableShuffleSpecific:e("web-player.smart-shuffle.button-enable-shuffle-specific",!0),enableSmartShuffleSpecific:e("web-player.smart-shuffle.button-enable-smart-shuffle-specific",!0),enableSmartShuffleGeneric:e("web-player.smart-shuffle.button-enable-smart-shuffle-generic"),enableRepeat:e("playback-control.enable-repeat"),enableRepeatOne:e("playback-control.enable-repeat-one"),disableRepeat:e("playback-control.disable-repeat")};h("lucid-icon-patch").innerHTML=`
 .main-yourLibraryX-navLink[aria-label="${o.home}"] path,
 button[aria-label="${o.home}"] path {
 	d: var(--home-icon-24);
 }
 .main-yourLibraryX-navLink[aria-label="${o.home}"].active path,
 .main-globalNav-navLinkActive[aria-label="${o.home}"] path {
 	d: var(--home-filled-icon-24);
 }
 .main-topBar-buddyFeed[aria-label*="${o.whatsNew}"] svg,
 .main-topBar-buddyFeed[aria-label*="${o.friendActivity}"] svg {
 	transform: scale(1.1);
 }
 
 .main-topBar-buddyFeed[aria-label*="${o.friendActivity}"] svg path {
 	d: var(--people-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${o.friendActivity}"] .Svg-img-icon-small-textBase path {
 	d: var(--people-filled-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${o.whatsNew}"] svg path {
 	d: var(--bell-icon);
 }
 .main-topBar-buddyFeed .Svg-img-icon-small[aria-label*="${o.whatsNew}"] .Svg-img-icon-small-textBase path {
 	d: var(--bell-filled-icon);
 }
 .player-controls__left button[aria-label*="${o.disableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.disableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.disableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.enableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.enableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.enableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.enableSmartShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${o.enableSmartShuffleSpecific}"] path:nth-of-type(n+2),
 .Root__globalNav button[aria-label="${o.browse}"] path:nth-of-type(n + 2) {
 	display: none;
 }
 .Root__globalNav .main-globalNav-navLink.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-icon-24);
 	transform: scale(3) !important;
 }
 .Root__globalNav .main-globalNav-navLinkActive.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-filled-icon-24);
 }
 .Root__globalNav .IconContainer-leading:first-child svg path,
 .Root__globalNav .IconContainer-leading:has(button[aria-label*="${o.search}"]) div > svg path {
 	d: var(--search-icon-24);
 }
 .Root__globalNav button[aria-label="${o.browse}"] path {
 	d: var(--compass-icon-24);
 }
 .Root__globalNav button[aria-label="${o.browse}"].j4xi27AJ3oy5qZ8CGhhQ path {
 	d: var(--compass-filled-icon-24);
 }
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"] path,
 .player-controls__buttons .player-controls__left button[aria-label*="${o.skipBack}"] path {
   fill: var(--clr-on-surface);
   d: var(--prev-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"] path,
 .player-controls__buttons .player-controls__right button[aria-label="${o.skipForward}"] path {
   fill: var(--clr-on-surface);
   d: var(--next-icon)}
 
 .player-controls__left button[aria-label*="${o.disableShuffle}"],
 .player-controls__left button[aria-label*="${o.disableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${o.disableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${o.enableShuffle}"],
 .player-controls__left button[aria-label*="${o.enableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${o.enableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${o.enableSmartShuffleGeneric}"],
 .player-controls__left button[aria-label*="${o.enableSmartShuffleSpecific}"],
 .player-controls__right button[aria-label="${o.enableRepeat}"],
 .player-controls__right button[aria-label="${o.enableRepeatOne}"],
 .player-controls__right button[aria-label="${o.disableRepeat}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px}
 
 .player-controls__right button[aria-label="${o.enableRepeat}"] path {
 	d: var(--disable-repeat-icon)}
 .player-controls__right button[aria-label="${o.enableRepeatOne}"] path {
   d: var(--repeat-icon)}
 
 .player-controls__right button[aria-label="${o.disableRepeat}"] path {
   d: var(--repeat-one-icon)}
 
 .player-controls__left button[aria-label*="${o.enableShuffle}"] path,
 .player-controls__left button[aria-label*="${o.enableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${o.enableShuffleGeneric}"] path {
 	d: var(--disable-shuffle-icon)}
 
 .player-controls__left button[aria-label*="${o.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${o.disableShuffle}"] path,
 .player-controls__left button[aria-label*="${o.enableSmartShuffleGeneric}"] path,
 .player-controls__left button[aria-label*="${o.enableSmartShuffleSpecific}"] path {
 	d: var(--shuffle-icon)}
 
 .player-controls__left button[aria-label*="${o.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${o.disableShuffleGeneric}"] path {
 	d: var(--smart-shuffle-icon)}
 
 .main-actionBar-ActionBarRow button[aria-label*="${o.enableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.enableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.enableShuffleGeneric}"] path {
   d: var(--disable-shuffle-icon-24, var(--disable-shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${o.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.disableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.enableSmartShuffleGeneric}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.enableSmartShuffleSpecific}"] path {
   d: var(--shuffle-icon-24, var(--shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${o.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${o.disableShuffleGeneric}"] path {
   d: var(--smart-shuffle-icon-24, var(--smart-shuffle-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${o.play}"] svg[viewBox="0 0 24 24"] path {
   d: var(--play-icon-24, var(--play-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${o.pause}"] svg[viewBox="0 0 24 24"] path {
   d: var(--pause-icon-24, var(--pause-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${o.play}"] svg[viewBox="0 0 16 16"] path {
   d: var(--play-icon)}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${o.pause}"] svg[viewBox="0 0 16 16"] path {
   d: var(--pause-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"],
 .player-controls__buttons .player-controls__right button[aria-label="${o.skipForward}"],
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"],
 .player-controls__buttons .player-controls__left button[aria-label*="${o.skipBack}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px;
 	color: var(--subtext-color)}
 
 .player-controls__buttons button[aria-label="${o.play}"] path {
   fill: var(--clr-on-surface);
   d: var(--play-icon)}
 
 
 .player-controls__buttons button[aria-label="${o.pause}"] path {
   fill: var(--clr-on-surface);
   d: var(--pause-icon)}
 
 .player-controls__buttons > button,
 .player-controls__buttons button[data-testid=control-button-playpause] { --encore-graphic-size-decorative-smaller: 1.5rem; --encore-control-size-smaller: 1.5rem; }
 .player-controls__buttons button[data-testid=control-button-playpause],
 .player-controls__buttons button[data-testid=control-button-playpause]:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span { background: none !important; }
 
 .x-downloadButton-DownloadButton button[aria-label="${o.download}"] path,
 .x-downloadButton-DownloadButton button[aria-label="${o.downloadContext}"] path {
   d: var(--download-icon-24)}
   
 svg path[d="M3 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm6.5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM16 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],
 .Root__right-sidebar button[aria-label*="${o.moreContext}"] path{
   d: var(--more-horizontal-icon)}
 
 .main-actionBar-ActionBar button[aria-label*="${o.moreContext}"] path {
   d: var(--more-horizontal-icon-24)}
 
 x-filterBox-expandButton[aria-label*="${o.search}"] path,
 x-filterBox-expandButton[aria-label*="${o.searchPlaylist}"] path,
 .x-filterBox-searchIcon path {
   d: var(--search-icon)}
 
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 16 16"] path{
   d: var(--share-icon)}
 
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${o.copyTrackLink}"] svg[viewBox="0 0 24 24"] path{
   d: var(--share-icon-24)}
 
 svg path[d="M15 14.5H5V13h10v1.5zm0-5.75H5v-1.5h10v1.5zM15 3H5V1.5h10V3zM3 3H1V1.5h2V3zm0 11.5H1V13h2v1.5zm0-5.75H1v-1.5h2v1.5z"],
 button[aria-controls="sort-and-view-picker"] path,
 .x-sortBox-sortDropdown path {
   d: var(--text-bullet-list-icon)}
 
 svg path[d="M15.5 13.5H.5V12h15v1.5zm0-4.75H.5v-1.5h15v1.5zm0-4.75H.5V2.5h15V4z"]{
   d: var(--list-icon)}
 
 div[data-testid="PanelHeader_CloseButton"] button path,
 .Root__right-sidebar button[aria-label="${o.closeBtn}"] path,
 .Root__right-sidebar button[aria-label="${o.close}"] path{
   d: var(--dismiss-icon)}
 
 .main-trackList-trackListRowGrid button[aria-label="${o.duration}"] path{
   d: var(--clock-icon)}
 
 button[aria-label="${o.createPlaylist}"] path,
 button[aria-label="${o.createButton}"] path,
 svg path[d="M15.25 8a.75.75 0 0 1-.75.75H8.75v5.75a.75.75 0 0 1-1.5 0V8.75H1.5a.75.75 0 0 1 0-1.5h5.75V1.5a.75.75 0 0 1 1.5 0v5.75h5.75a.75.75 0 0 1 .75.75z"]{
   d: var(--add-icon)}
 
 svg path[d="M6.53 9.47a.75.75 0 0 1 0 1.06l-2.72 2.72h1.018a.75.75 0 0 1 0 1.5H1.25v-3.579a.75.75 0 0 1 1.5 0v1.018l2.72-2.72a.75.75 0 0 1 1.06 0zm2.94-2.94a.75.75 0 0 1 0-1.06l2.72-2.72h-1.018a.75.75 0 1 1 0-1.5h3.578v3.579a.75.75 0 0 1-1.5 0V3.81l-2.72 2.72a.75.75 0 0 1-1.06 0z"],
 button[data-testid="fullscreen-mode-button"] path,
 button[aria-label="${o.fullscreen}"] path{
   d: var(--arrow-maximize-icon);
 }
 
 svg path[d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"],
 button[data-testid="control-button-queue"] path,
 button[aria-label="${o.queue}"] path{
   /* d: var(--queue-icon); */ /* TODO: add new queue icon */
 }
 
 
 button[aria-label="${o.openMiniPlayer}"] path,
 button[data-testid="pip-toggle-button"] path{
   d: var(--pip-icon);
 }
 `}catch(e){console.error("Error patching icons.",e),d("Error patching icons.",!0,5e3)}};var k={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")},yr={defaultMerge:k.defaultMerge};function Qt(e,t){return t}function jt(e,t){return e.filter(o=>o!==void 0)}var Ye;(function(e){e[e.NOT=0]="NOT",e[e.RECORD=1]="RECORD",e[e.ARRAY=2]="ARRAY",e[e.SET=3]="SET",e[e.MAP=4]="MAP",e[e.OTHER=5]="OTHER"})(Ye||(Ye={}));function Ze(e){return typeof e!="object"||e===null?0:Array.isArray(e)?2:oo(e)?1:e instanceof Set?3:e instanceof Map?4:5}function eo(e){let t=new Set;for(let o of e)for(let r of[...Object.keys(o),...Object.getOwnPropertySymbols(o)])t.add(r);return t}function to(e,t){return typeof e=="object"&&Object.prototype.propertyIsEnumerable.call(e,t)}function Xe(e){let t=0,o=e[0]?.[Symbol.iterator]();return{[Symbol.iterator](){return{next(){do{if(o===void 0)return{done:!0,value:void 0};let r=o.next();if(r.done===!0){t+=1,o=e[t]?.[Symbol.iterator]();continue}return{done:!1,value:r.value}}while(!0)}}}}}var Je=["[object Object]","[object Module]"];function oo(e){if(!Je.includes(Object.prototype.toString.call(e)))return!1;let{constructor:t}=e;if(t===void 0)return!0;let o=t.prototype;return!(o===null||typeof o!="object"||!Je.includes(Object.prototype.toString.call(o))||!o.hasOwnProperty("isPrototypeOf"))}function ro(e,t,o){let r={};for(let i of eo(e)){let n=[];for(let p of e)to(p,i)&&n.push(p[i]);if(n.length===0)continue;let l=t.metaDataUpdater(o,{key:i,parents:e}),c=Qe(n,t,l);c!==k.skip&&(i==="__proto__"?Object.defineProperty(r,i,{value:c,configurable:!0,enumerable:!0,writable:!0}):r[i]=c)}return r}function io(e){return e.flat()}function no(e){return new Set(Xe(e))}function ao(e){return new Map(Xe(e))}function so(e){return e.at(-1)}var ue={mergeRecords:ro,mergeArrays:io,mergeSets:no,mergeMaps:ao,mergeOthers:so};function de(...e){return lo({})(...e)}function lo(e,t){let o=co(e,r);function r(...i){return Qe(i,o,t)}return r}function co(e,t){return{defaultMergeFunctions:ue,mergeFunctions:{...ue,...Object.fromEntries(Object.entries(e).filter(([o,r])=>Object.hasOwn(ue,o)).map(([o,r])=>r===!1?[o,ue.mergeOthers]:[o,r]))},metaDataUpdater:e.metaDataUpdater??Qt,deepmerge:t,useImplicitDefaultMerging:e.enableImplicitDefaultMerging??!1,filterValues:e.filterValues===!1?void 0:e.filterValues??jt,actions:k}}function Qe(e,t,o){let r=t.filterValues?.(e,o)??e;if(r.length===0)return;if(r.length===1)return ke(r,t,o);let i=Ze(r[0]);if(i!==0&&i!==5){for(let n=1;n<r.length;n++)if(Ze(r[n])!==i)return ke(r,t,o)}switch(i){case 1:return po(r,t,o);case 2:return uo(r,t,o);case 3:return mo(r,t,o);case 4:return go(r,t,o);default:return ke(r,t,o)}}function po(e,t,o){let r=t.mergeFunctions.mergeRecords(e,t,o);return r===k.defaultMerge||t.useImplicitDefaultMerging&&r===void 0&&t.mergeFunctions.mergeRecords!==t.defaultMergeFunctions.mergeRecords?t.defaultMergeFunctions.mergeRecords(e,t,o):r}function uo(e,t,o){let r=t.mergeFunctions.mergeArrays(e,t,o);return r===k.defaultMerge||t.useImplicitDefaultMerging&&r===void 0&&t.mergeFunctions.mergeArrays!==t.defaultMergeFunctions.mergeArrays?t.defaultMergeFunctions.mergeArrays(e):r}function mo(e,t,o){let r=t.mergeFunctions.mergeSets(e,t,o);return r===k.defaultMerge||t.useImplicitDefaultMerging&&r===void 0&&t.mergeFunctions.mergeSets!==t.defaultMergeFunctions.mergeSets?t.defaultMergeFunctions.mergeSets(e):r}function go(e,t,o){let r=t.mergeFunctions.mergeMaps(e,t,o);return r===k.defaultMerge||t.useImplicitDefaultMerging&&r===void 0&&t.mergeFunctions.mergeMaps!==t.defaultMergeFunctions.mergeMaps?t.defaultMergeFunctions.mergeMaps(e):r}function ke(e,t,o){let r=t.mergeFunctions.mergeOthers(e,t,o);return r===k.defaultMerge||t.useImplicitDefaultMerging&&r===void 0&&t.mergeFunctions.mergeOthers!==t.defaultMergeFunctions.mergeOthers?t.defaultMergeFunctions.mergeOthers(e):r}function je(e,t){if(!t)return e;let o=t.split(/[.\[\]'"]/).filter(Boolean),r=e;for(let i of o)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}var xe=class{state;subscribers=[];options;constructor(t,o={}){if(this.options={persist:!1,localStorageKey:"storeState",...o},this.options.persist&&this.options.localStorageKey){let r=localStorage.getItem(this.options.localStorageKey);if(!r){this.state=t;return}try{let i=JSON.parse(r);this.state=de(t,i)}catch(i){console.error("Error parsing stored state from localStorage:",i),this.state=t}}else this.state=t}getState(){return this.state}setState(t,o){let r={...this.state},i=t(this.state,o);this.updateStateAndNotify(i,r)}updateStateAndNotify(t,o){t!==this.state&&(this.state=t,this.notifySubscribers(o),this.options.persist&&this.persist())}subscribe(t,o){let r={subscriber:t,path:o};return this.subscribers.push(r),()=>{this.subscribers=this.subscribers.filter(i=>i!==r)}}notifySubscribers(t){for(let o of this.subscribers){let{subscriber:r,path:i}=o,n=je(t,i),l=je(this.state,i);if(JSON.stringify(n)!==JSON.stringify(l)){let c=performance.now();try{r(this.state)}catch(N){console.error(`Subscriber at path "${i}" threw an error:`,N)}let p=performance.now()-c;p>10&&console.warn(`Slow subscriber at path "${i}" took ${p.toFixed(2)}ms. Subscriber: ${r}`)}}}persist(){try{if(this.options.localStorageKey)localStorage.setItem(this.options.localStorageKey,JSON.stringify(this.state));else throw new Error("localStorage key not found!")}catch(t){console.error("Error saving state to localStorage:",t)}}},V=xe;function u(e){return e!==null&&typeof e=="object"}function me(e){return u(e)&&(e.blur===void 0||typeof e.blur=="number")&&(e.brightness===void 0||typeof e.brightness=="number")&&(e.contrast===void 0||typeof e.contrast=="number")&&(e.grayscale===void 0||typeof e.grayscale=="string")&&(e.hueRotate===void 0||typeof e.hueRotate=="string")&&(e.invert===void 0||typeof e.invert=="string")&&(e.opacity===void 0||typeof e.opacity=="number")&&(e.saturate===void 0||typeof e.saturate=="number")&&(e.sepia===void 0||typeof e.sepia=="string")}function q(e){return u(e)&&typeof e.hex=="string"&&typeof e.alpha=="number"}function ho(e){return u(e)&&typeof e.url=="string"}function fo(e){return u(e)&&Array.isArray(e.selectedIds)&&e.selectedIds.every(t=>typeof t=="number")&&u(e.slideshow)&&typeof e.slideshow.isSlideshow=="boolean"&&typeof e.slideshow.timeDelay=="number"}function bo(e){return!u(e)||typeof e.isCustom!="boolean"||e.type!=="url"&&e.type!=="local"||!u(e.options)?!1:e.type==="url"?ho(e.options.url):e.type==="local"?fo(e.options.local):!1}function yo(e){return u(e)&&bo(e.customImage)&&(e.filter===void 0||me(e.filter))}function vo(e){return u(e)&&q(e.color)}function So(e){return u(e)&&me(e.filter)}function _o(e){return u(e)&&yo(e.static)&&vo(e.solid)&&So(e.animated)}function Co(e){return u(e)&&typeof e.mode=="string"&&(e.mode==="static"||e.mode==="solid"||e.mode==="animated")&&_o(e.options)}function wo(e){return u(e)&&typeof e.thickness=="number"&&q(e.color)&&typeof e.style=="string"}function Eo(e){return u(e)&&(e.mode==="compact"||e.mode==="normal")&&(e.position==="bottom left"||e.position==="bottom right"||e.position==="top left"||e.position==="top right")&&typeof e.blur=="number"&&typeof e.size=="number"&&typeof e.isCustomBg=="boolean"&&q(e.color)}function ko(e){return u(e)?["normal","expanded","npv"].every(o=>{let r=e[o];return u(r)&&typeof r.isScaling=="boolean"&&typeof r.isScroll=="boolean"&&(r.filter===null||me(r.filter))}):!1}function xo(e){return u(e)&&(e.type==="npv"||e.type==="normal")&&ko(e.options)}function Io(e){return u(e)&&typeof e.panelGap=="number"&&typeof e.hideHomeHeader=="boolean"&&typeof e.style=="string"&&xo(e.umv)}function To(e){return u(e)&&typeof e.isDynamic=="boolean"&&typeof e.isCustom=="boolean"&&typeof e.isTonal=="boolean"&&q(e.customColor)}function Lo(e){return u(e)&&me(e.backdropFilter)&&typeof e.height=="number"&&typeof e.paddingX=="number"&&q(e.bgColor)&&typeof e.bgOpacity=="number"&&typeof e.borderRadius=="number"}function Bo(e){return u(e)?["compact","normal"].every(o=>Lo(e[o])):!1}function Mo(e){return u(e)&&(e.type==="compact"||e.type==="normal")&&Bo(e.options)&&typeof e.isFloating=="boolean"&&typeof e.hideIcons=="boolean"}function Po(e){return u(e)&&(e.type==="default"||e.type==="starry"||e.type==="none")}function ge(e){return u(e)&&(e.position==="context-menu"||e.position==="nav")&&Co(e.background)&&wo(e.border)&&Io(e.pages)&&To(e.color)&&u(e.control)&&typeof e.control.height=="number"&&u(e.font)&&typeof e.font.fontFamily=="string"&&(typeof e.font.fontUrl=="string"||e.font.fontUrl===null)&&typeof e.font.isGoogleFonts=="boolean"&&Po(e.grains)&&Mo(e.playbar)&&Eo(e.rightSidebar)}var Ie=class extends V{constructor(t=Ee,o={persist:!0,localStorageKey:ze}){super(t,o)}setChangelog(t){this.setState(o=>({...o,showChangelog:t}))}setPages(t){this.setState(o=>({...o,pages:{...o.pages,...t}}))}setUMV(t){this.setState(o=>({...o,pages:{...o.pages,umv:{...o.pages.umv,...t}}}))}setUMVOption(t,o){this.setState(r=>({...r,pages:{...r.pages,umv:{...r.pages.umv,options:{...r.pages.umv.options,[t]:{...r.pages.umv.options[t],...o}}}}}))}setUMVFilter(t,o){this.setState(r=>({...r,pages:{...r.pages,umv:{...r.pages.umv,options:{...r.pages.umv.options,[t]:{...r.pages.umv.options[t],filter:{...r.pages.umv.options[t].filter,...o}}}}}}))}setCustomImageType(t){this.setState(o=>({...o,customImage:{...o.customImage,type:t}}))}setCustomImageOptions(t,o){this.setState(r=>({...r,customImage:{...r.customImage,options:{...r.customImage.options,[t]:{...r.customImage.options[t],...o}}}}))}setPosition(t){this.setState(o=>({...o,position:t}))}setBackgroundMode(t){this.setState(o=>({...o,background:{...o.background,mode:t}}))}setStaticBackgroundOptions(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,static:{...o.background.options.static,...t}}}}))}setStaticBackgroundFilter(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,static:{...o.background.options.static,filter:{...o.background.options.static.filter,...t}}}}}))}setAnimatedBackgroundFilter(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,animated:{...o.background.options.animated,filter:{...o.background.options.animated.filter,...t}}}}}))}setStaticBgFilter(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,static:{...o.background.options.static,filter:{...o.background.options.static.filter,...t}}}}}))}setSolidBackgroundColor(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,solid:{...o.background.options.solid,color:{...o.background.options.solid.color,...t}}}}}))}setAnimatedBackgroundOptions(t){this.setState(o=>({...o,background:{...o.background,options:{...o.background.options,animated:t}}}))}setBorder(t){this.setState(o=>({...o,border:{...o.border,...t}}))}setBorderColor(t){this.setState(o=>({...o,border:{...o.border,color:{...o.border.color,...t}}}))}setControlHeight(t){this.setState(o=>({...o,control:{...o.control,height:t}}))}setFont(t){this.setState(o=>({...o,font:{...o.font,...t}}))}setGrains(t){this.setState(o=>({...o,grains:{...o.grains,...t}}))}setRightSidebar(t){this.setState(o=>({...o,rightSidebar:{...o.rightSidebar,...t}}))}setColor(t){this.setState(o=>({...o,color:{...o.color,...t}}))}setColorExtractorOptions(t){this.setState(o=>({...o,color:{...o.color,extractorOptions:{...o.color.extractorOptions,...t}}}))}setPageStyle(t){this.setState(o=>({...o,pages:{...o.pages,style:t}}))}setPageImageStyle(t){this.setState(o=>({...o,pages:{...o.pages,imageStyle:t}}))}setPlaybar(t){this.setState(o=>({...o,playbar:{...o.playbar,...t}}))}setPlaybarOptions(t,o){this.setState(r=>({...r,playbar:{...r.playbar,options:{...r.playbar.options,[t]:{...r.playbar.options[t],...o}}}}))}setPlaybarFilter(t,o){this.setState(r=>({...r,playbar:{...r.playbar,options:{...r.playbar.options,[t]:{...r.playbar.options[t],backdropFilter:{...r.playbar.options[t].backdropFilter,...o}}}}}))}setRightSidebarColor(t){this.setState(o=>({...o,rightSidebar:{...o.rightSidebar,color:{...o.rightSidebar.color,...t}}}))}setGrainsType(t){this.setState(o=>({...o,grains:{...o.grains,type:t}}))}setDynamicColor(t){this.setState(o=>({...o,color:{...o.color,isDynamic:t}}))}setIsCustomColor(t){this.setState(o=>({...o,color:{...o.color,isCustom:t}}))}setCustomColor(t){this.setState(o=>({...o,color:{...o.color,customColor:{...o.color.customColor,...t}}}))}setTonalColor(t){this.setState(o=>({...o,color:{...o.color,isTonal:t}}))}resetState(){try{this.setState(()=>Ee),localStorage.removeItem(K),localStorage.removeItem(ce),localStorage.removeItem(le),localStorage.removeItem(pe),localStorage.removeItem(A),window.location.reload()}catch(t){d("Error reseting settings.",!0,5e3),console.error("Error reseting settings.",t)}}exportSettings(){let t=Te.getState();return JSON.stringify(t,null,0)}importSettings(t){try{let o=JSON.parse(t);ge(o)?(Te.setState(r=>de(r,o)),d("Settings imported successfully!",!1,5e3)):(console.error("Invalid settings format."),d("Import failed: Invalid settings format.",!0,5e3))}catch(o){console.error("Error importing settings:",o),d("Import failed: Unable to parse settings JSON.",!0,5e3)}}},Te=new Ie,s=Te;function et(e){try{let o=new URL(e).searchParams.get("family");return o?o.split(":")[0].split(";")[0].replace(/\+/g," "):null}catch(t){return console.error("Error parsing Google Fonts URL:",t),null}}function ot(){tt(),s.subscribe(e=>{tt(e.font)})}function tt(e=s.getState().font){let t=h("lucid-font"),o=document.head.querySelector("#lucid-custom-font");if(e.isGoogleFonts&&e.fontUrl){o?o.href!==e.fontUrl&&(o.href=e.fontUrl):(o=a("link",{id:"lucid-custom-font",rel:"preload",href:e.fontUrl,as:"style",crossOrigin:"anonymous"}),document.head.appendChild(o));let i=document.head.querySelector("#lucid-custom-font-style");i?i.href!==e.fontUrl&&(i.href=e.fontUrl):(i=a("link",{id:"lucid-custom-font-style",rel:"stylesheet",href:e.fontUrl,crossOrigin:"anonymous"}),document.head.appendChild(i))}else{o&&o.remove();let i=document.head.querySelector("#lucid-custom-font-style");i&&i.remove()}let r=e.isGoogleFonts&&e.fontUrl?et(e.fontUrl):e.fontFamily;t.innerText=`:root,* { --custom-font: "${r}"; font-family: var(--custom-font) !important; }`}var he=null,fe=null;function Le(e=s.getState().pages){let t=`playlist-${e.style}`;he!==t&&(he?document.body.classList.replace(he,t):document.body.classList.add(t),he=t);let o=`playlist-image-${e.imageStyle}`;fe!==o&&(fe?document.body.classList.replace(fe,o):document.body.classList.add(o),fe=o),e.hideHomeHeader?document.body.classList.remove("hide-home-header"):document.body.classList.add("hide-home-header"),document.body.style.setProperty("--custom-panel-gap",`${e.panelGap}px`)}s.subscribe(e=>{Le(e.pages)},"pages");var rt=()=>document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image")?.src||"",it=async()=>{for(;!Spicetify.Player?.data;)await new Promise(r=>setTimeout(r,50));let e=Spicetify.Player.data?.item;return!e||!e.metadata?(console.error("No item or metadata found in Spicetify Player data."),""):[e.metadata.image_xlarge_url,e.metadata.image_large_url,e.metadata.image_url,e.metadata.image_small_url].find(r=>r)||rt()||rt()},nt=async(e,t,o=3)=>{for(let r=0;r<=o;r++)try{return await Spicetify.GraphQL.Request({...e,operation:"query",value:null},t)}catch(i){if(i instanceof Error&&i.message.includes("DUPLICATE_REQUEST_ERROR")&&r<o){console.warn(`Retrying ${e.name}... (${r+1}/${o})`),await new Promise(n=>setTimeout(n,1e3));continue}throw console.error(`Error in ${e.name}:`,i),i}return null},Ro=e=>nt({name:"getAlbum",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d"},{uri:e,locale:null,offset:0,limit:50}),Oo=e=>nt({name:"queryArtistOverview",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497"},{uri:e,includePrerelease:!0,locale:null}),Ao=e=>{let t=e.match(/\/(playlist|artist|album|user|show)\/([^/]+)/);if(!t)return console.warn("No valid type or ID found in pathname:",e),null;let[,o,r]=t;return`spotify:${o}:${r}`},at=async e=>{let t=Ao(e);if(!t)return null;let[,o,r]=t.split(":");try{switch(o){case"playlist":case"show":return(await Spicetify.Platform.PlaylistAPI.getMetadata(t)).images[0]?.url||null;case"artist":{let n=(await Oo(t))?.data?.artistUnion?.visuals;return n?.headerImage?.sources[0]?.url||n?.avatarImage?.sources[0]?.url||null}case"album":{let n=(await Ro(t))?.data?.albumUnion?.coverArt?.sources;return n?.[2]?.url||n?.[0]?.url||null}case"user":return(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${r}`).send())?.body?.image_url||null;default:return null}}catch(i){return console.error(`Error fetching ${o} artwork:`,i),null}};var S=new V({url:null});async function st(){try{let e=await it();S.setState(()=>({url:e}))}catch(e){console.error("Error updating NPV state:",e),S.setState(()=>({url:null}))}}st();Spicetify.Player.addEventListener("songchange",st);function lt(e){try{let t=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(t),r=new Worker(o,{credentials:"omit"});return r.onerror=i=>{console.error("Worker encountered an error:",i.message||i)},r.onmessage=i=>{console.debug("Worker initialized:",i.data)},r}catch(t){return console.error("Error loading worker:",t),null}}async function $(e,t,o=864e5){let r=JSON.parse(localStorage.getItem(t)||"null");if(r?.script&&(!navigator.onLine||Date.now()-r.timestamp<o))return r.script;let i=null;for(let n of e)try{let l=await fetch(n);if(l.ok){i=await l.text();break}}catch{}if(!i){if(r?.script)return r.script;throw new Error("Failed to fetch guide script from all sources.")}return localStorage.setItem(t,JSON.stringify({script:i,timestamp:Date.now()})),i}var x=null,ct=null,Ho=h("clr-lucid");function pt(e){x&&x.postMessage({type:"color",options:e})}function ut(e){x&&x.postMessage({type:"image",options:e})}function dt(e){return e.replace("spotify:image:","https://i.scdn.co/image/")}async function Be(e=s.getState().color){if(await Uo(),ct?.(),e.isDynamic){let t=S.getState().url;t&&ut({url:dt(t),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}}),ct=S.subscribe(o=>{o.url&&ut({url:dt(o.url),isTonal:e.isTonal,isDark:!0,extractorOptions:e?.extractorOptions??{}})});return}if(e.isCustom){pt({hex:e.customColor.hex,isTonal:e.isTonal,isDark:!0});return}pt({hex:De,isTonal:e.isTonal,isDark:!0})}async function Uo(){let e=await $($e,le);if(x=lt(e),!x){document.body.removeAttribute("color-from-worker"),console.error("Failed to initialize worker from both endpoints."),d("Failed to initialize the color worker. If this issue persists, please report it. (Dynamic and custom colors may not function properly.)",!0,5e3);return}document.body.setAttribute("color-from-worker","true"),x.onmessage=t=>{let{message:o,data:r}=t.data||{};r?(console.debug(o,`
Event Data:`,t.data),Ho.textContent=`:root,body{${r.style}}`):console.error(o??"Color not applied")},x.onerror=t=>{console.error("Worker encountered an error:",t.message||t)}}var Fo=e=>Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other";function mt(e){document.body.setAttribute("path",e),document.body.setAttribute("page-type",Fo(e))}function gt(){mt(Spicetify?.Platform?.History?.location?.pathname||"/"),Spicetify?.Platform?.History?.listen(e=>{!e||!e.pathname||mt(e.pathname)})}var be=()=>Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:Spicetify.Platform?.PlatformData?.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1;function No(){let e=Math.round(window.outerHeight/window.innerHeight*100)/100,t=Math.round(window.innerHeight/window.outerHeight*100)/100;return{zoom:e,inverseZoom:t}}var ht=Spicetify?.Platform?.version>="1.2.46";function Vo(e){let{zoom:t,inverseZoom:o}=No(),r=ht&&e>32?Math.max(32,Math.round(e/(2*t))):e/t,i=Math.round(135*o),n=ht?(e/t-Math.min(32/t,e))/2:0,l=h("transparent-controls");l.textContent=`
    body::after {
      content: "";
      height: var(--control-height, ${r}px);
      width: var(--control-width, ${i}px);
      position: fixed;
      top: ${n}px;
      right: 0;
      -webkit-backdrop-filter: brightness(2.1);
      backdrop-filter: brightness(2.1);
    }
  `}async function $o(e){await Spicetify?.Platform?.ControlMessageAPI?._updateUiClient?.updateTitlebarHeight({height:e}),await Spicetify?.Platform?.UpdateAPI?._updateUiClient?.updateTitlebarHeight({height:e}),await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${e}px`})}function Me(e=s.getState().control.height){$o(e).then(()=>Vo(e)).catch(t=>console.error("Failed to update titlebar:",t))}function ft(){let e=setInterval(()=>Me(),300);setTimeout(()=>{clearInterval(e)},1e4)}var bt=()=>{be()&&(Me(),ft(),window.addEventListener("resize",ft),s.subscribe(e=>Me(e.control.height),"control"))};var I=e=>{if(e<0||e>100)throw new Error("Alpha value must be between 0 and 100");let t=e/100,r=Math.round(t*255).toString(16).toUpperCase();return r.length===1&&(r=`0${r}`),r};function T(e,t,o=100){let r=e.map(i=>document.querySelector(i));r.every(i=>i)?t(r):o>0&&setTimeout(T,300,e,t,--o)}function yt(e=s.getState().playbar){let t=e.options[e.type],o=h("lucid-playbar");o.textContent=`
    :root,
    .Root__now-playing-bar{
        --npb-height: ${t.height??80}px;
        --npb-blur: ${t.backdropFilter.blur??32}px;
        --npb-padding-x: ${t.paddingX??8}px;
        --npb-saturate: ${t.backdropFilter.saturate??150}%;
        --npb-brightness: ${t.backdropFilter.brightness??80}%;
        --npb-border-radius: ${t.borderRadius??8}px;
        --npb-image-radius: ${t.imageRadius??16}px;
        --npb-bg-opacity: ${t.bgOpacity??50}%;
        --npb-bg-color: ${t.bgColor.hex?t.bgColor.hex+I(t.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${t.bgColor.alpha}%)`} ;
    }`,e.isFloating?document.body.setAttribute("npb-is-floating","floating"):document.body.removeAttribute("npb-is-floating"),document.body.setAttribute("npb-type",e.type)}var w=document.querySelector(".Root__now-playing-bar");T([".Root__now-playing-bar"],([e])=>{w=e,Pe()});var ye=s.getState().playbar.hideIcons;function Pe(){if(!w)return;let e=w.offsetWidth;w.style.setProperty("--width",`${e}px`),Re(ye||e<1e3)}function Re(e=s.getState().playbar.hideIcons){w&&(e?w.setAttribute("hide-icons","true"):w.removeAttribute("hide-icons"))}function vt(){window.addEventListener("resize",Pe),yt(),Re(ye||(w?.clientWidth||0)<900),s.subscribe(e=>{ye=e.playbar.hideIcons,Re(ye||(w?.clientWidth||0)<900),yt(e.playbar)},"playbar"),Pe()}var E=new V({isFloating:!1,position:{top:16,left:16}},{persist:!0,localStorageKey:"lucid-modal-position"});var St='<svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z" fill="currentColor"/></svg>',_t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"/></svg>',Ct='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M25.12,6.946c-2.424-1.948-6.257-2.278-6.419-2.292c-0.256-0.022-0.499,0.123-0.604,0.357 c-0.004,0.008-0.218,0.629-0.425,1.228c2.817,0.493,4.731,1.587,4.833,1.647c0.478,0.278,0.638,0.891,0.359,1.368 C22.679,9.572,22.344,9.75,22,9.75c-0.171,0-0.343-0.043-0.501-0.135C21.471,9.598,18.663,8,15.002,8 C11.34,8,8.531,9.599,8.503,9.615C8.026,9.892,7.414,9.729,7.137,9.251C6.86,8.775,7.021,8.164,7.497,7.886 c0.102-0.06,2.023-1.158,4.848-1.65c-0.218-0.606-0.438-1.217-0.442-1.225c-0.105-0.235-0.348-0.383-0.604-0.357 c-0.162,0.013-3.995,0.343-6.451,2.318C3.564,8.158,1,15.092,1,21.087c0,0.106,0.027,0.209,0.08,0.301 c1.771,3.11,6.599,3.924,7.699,3.959c0.007,0,0.013,0,0.019,0.001c0.194,0,0.377-0.093,0.492-0.25l1.19-1.612 c-2.61-0.629-3.99-1.618-4.073-1.679c-0.444-0.327-0.54-0.953-0.213-1.398c0.326-0.443,0.95-0.541,1.394-0.216 C7.625,20.217,10.172,22,15,22c4.847,0,7.387-1.79,7.412-1.808c0.444-0.322,1.07-0.225,1.395,0.221 c0.324,0.444,0.23,1.066-0.212,1.392c-0.083,0.061-1.456,1.048-4.06,1.677l1.175,1.615c0.115,0.158,0.298,0.25,0.492,0.25 c0.007,0,0.013,0,0.019-0.001c1.101-0.035,5.929-0.849,7.699-3.959c0.053-0.092,0.08-0.195,0.08-0.301 C29,15.092,26.436,8.158,25.12,6.946z M11,19c-1.105,0-2-1.119-2-2.5S9.895,14,11,14s2,1.119,2,2.5S12.105,19,11,19z M19,19 c-1.105,0-2-1.119-2-2.5s0.895-2.5,2-2.5s2,1.119,2,2.5S20.105,19,19,19z"/></svg>',ve='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z" fill="currentColor"/></svg>',wt='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z" fill="currentColor"/></svg>',Et='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 0-5.06 0L14 4.94l-.013-.013a1.75 1.75 0 0 0-2.475 0l-.585.586a1.75 1.75 0 0 0 0 2.474l.012.013-6.78 6.78a2.25 2.25 0 0 0-.659 1.591v.688l-1.28 2.347c-.836 1.533.841 3.21 2.374 2.374l2.347-1.28h.688a2.25 2.25 0 0 0 1.59-.659L16 13.061l.012.012a1.75 1.75 0 0 0 2.475 0l.586-.585a1.75 1.75 0 0 0 0-2.475L19.061 10l1.97-1.97a3.578 3.578 0 0 0 0-5.06ZM12 9.06 14.94 12l-6.78 6.78a.75.75 0 0 1-.531.22H6.75a.75.75 0 0 0-.359.092l-2.515 1.372a.234.234 0 0 1-.159.032.264.264 0 0 1-.138-.075.264.264 0 0 1-.075-.138.234.234 0 0 1 .033-.159l1.372-2.515A.75.75 0 0 0 5 17.25v-.879a.75.75 0 0 1 .22-.53L12 9.061Z" fill="currentColor"/></svg>',Oe='<svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>';var kt="https://github.com/sanoojes/Spicetify-Lucid",xt="https://discord.gg/PWEyKduwJh";var Do=(e="base")=>`encore-internal-color-text-${e}`,L=(e="variable-text",t="base")=>`encore-text ${e==="variable-text"?`encore-${e}`:`encore-text-${e}`} ${Do(t)}`;var f=class extends HTMLElement{customClass="";_type="primary";_isIcon=!1;onChange;constructor(t){super(),t&&(this.type=t.type??this.type,this.customClass=t.customClass??this.customClass,this.disabled=t.disabled??this.disabled,this.isIcon=t.isIcon??this._isIcon,this.onChange=t.onChange,t.textContent&&(this.textContent=t.textContent),t.innerHTML&&(this.innerHTML=t.innerHTML),t.ariaLabel&&(this.ariaLabel=t.ariaLabel),t.style&&Object.assign(this.style,t.style)),this.addEventListener("click",this._handleClick)}connectedCallback(){this.classList.add("lucid-button"),this._updateClasses(),this.setAttribute("role","button")}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}_updateClasses(){this.className=`lucid-button ${this.customClass}`,this.classList.toggle("icon",this._isIcon),this.classList.toggle("disabled",this.disabled);for(let t of this.classList)["primary","secondary","tertiary","danger"].includes(t)&&this.classList.remove(t);if(this.classList.add(this.type),this._isIcon&&this.type==="icon"){let t=L("body-small-bold");t&&this.classList.add(t)}}set isIcon(t){this._isIcon=t,t?(this.classList.add("icon"),this.setAttribute("is-icon","true")):(this.classList.remove("icon"),this.removeAttribute("is-icon")),this._updateClasses()}get isIcon(){return this._isIcon}set type(t){this._type=t,this.setAttribute("type",t),this._updateClasses()}get type(){return this._type}set disabled(t){t?(this.setAttribute("disabled","true"),this.setAttribute("aria-disabled","true")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")),this._updateClasses()}get disabled(){return this.hasAttribute("disabled")}_handleClick=()=>{!this.disabled&&this.onChange&&this.onChange()}};customElements.define("custom-button",f);var H=class e extends HTMLElement{_modalElem;_bodyElem;_scrollElem;_closeBtn;_githubBtn;_discordBtn;_headerWrapperElem;_headerElem;_bgElem;_previouslyFocusedElement=null;static zIndexCounter=1e3;constructor(){super(),this._bgElem=a("div",{className:"modal-backdrop"}),this._bgElem.addEventListener("click",()=>this.close()),this._modalElem=a("div",{className:"modal",role:"dialog",ariaModal:"true"}),this._headerWrapperElem=a("div",{className:"modal-header-container"}),this._headerElem=a("h2",{className:`modal-header ${L("title-small")}`,id:"modal-header"});let t=a("div",{className:"modal-header-buttons"});this._closeBtn=this.createIconButton("close","Close Button",St,()=>this.close()),this._githubBtn=this.createIconButton("github","Github Button",_t,()=>window.open(kt)),this._discordBtn=this.createIconButton("discord","Discord Button",Ct,()=>window.open(xt)),t.append(this._discordBtn,this._githubBtn,this._closeBtn),this._headerWrapperElem.append(this._headerElem,t),this._modalElem.appendChild(this._headerWrapperElem),this._bodyElem=a("div",{className:"modal-body"}),this._scrollElem=a("div",{className:"modal-scroll"}),this._bodyElem.appendChild(this._scrollElem),this._modalElem.appendChild(this._bodyElem),this.append(this._bgElem,this._modalElem)}createIconButton(t,o,r,i){let n=new f;return n.customClass=t,n.ariaLabel=o,n.innerHTML=r.toString(),n.type="icon",n.addEventListener("click",i),n}resetPosition(){this._modalElem.style.transform="translate3d(-50%,-50%,0px)"}get scrollElem(){return this._scrollElem}set isOpen(t){t?this.setAttribute("open","true"):this.removeAttribute("open")}get isOpen(){return!!this.getAttribute("open")}setHeader(t){this._headerElem.innerHTML=t.toString()}open(){this.isOpen=!0,this._previouslyFocusedElement=document.activeElement,this._bgElem.classList.add("modal-backdrop--open"),this._modalElem.classList.add("modal--open"),this._closeBtn.focus(),this.resetPosition(),e.zIndexCounter+=1,this._bgElem.style.zIndex=String(e.zIndexCounter),this._modalElem.style.zIndex=String(e.zIndexCounter),this.dispatchEvent(new Event("open"))}close(){this.isOpen=!1,this._bgElem.classList.remove("modal-backdrop--open"),this._modalElem.classList.remove("modal--open"),this.removeAttribute("open"),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null),this.dispatchEvent(new Event("close"))}setContent(t){this._scrollElem.textContent="",typeof t=="string"?this._scrollElem.textContent=t:this._scrollElem.append(t)}};customElements.define("lucid-modal",H);var D=class extends H{dragging=!1;startX=0;startY=0;initialLeft=0;initialTop=0;constructor(){super(),super.setHeader("Lucid Settings")}setPosition=(t,o)=>{E.setState(r=>({isFloating:r.isFloating,position:{top:t,left:o}}))};handlePointerDown=t=>{if(!this.isFloating)return;this.dragging=!0,this.startX=t.clientX,this.startY=t.clientY;let o=this._modalElem.getBoundingClientRect();this.initialLeft=o.left,this.initialTop=o.top,this.setAttribute("dragging","true"),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp)};handlePointerMove=t=>{if(!this.dragging)return;let o=t.clientX-this.startX,r=t.clientY-this.startY,i=this.initialLeft+o,n=this.initialTop+r,l=this._modalElem.getBoundingClientRect(),c=l.width,p=l.height;i=Math.max(0,Math.min(i,window.innerWidth-c-16)),n=Math.max(0,Math.min(n,window.innerHeight-p-16)),this._modalElem.style.transform=`translate3d(${i}px,${n}px,0px)`,this.setPosition(n,i)};handlePointerUp=t=>{this.dragging=!1,this.removeAttribute("dragging"),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)};makeFloating(){let t=E.getState().position;t&&t.top!==void 0&&t.left!==void 0&&(this._modalElem.style.transform=`translate3d(${t.left}px,${t.top}px,0px)`),this.setAttribute("floating","true"),this._modalElem.classList.add("modal--floating"),this._bgElem.classList.add("modal-backdrop--floating"),this._headerWrapperElem.addEventListener("pointerdown",this.handlePointerDown)}removeFloating(){this.removeAttribute("floating"),this.resetPosition(),this._bgElem.classList.remove("modal-backdrop--floating"),this._modalElem.classList.remove("modal--floating"),this._headerWrapperElem.removeEventListener("pointerdown",this.handlePointerDown)}set isFloating(t){t?(this.setAttribute("is-floating","true"),this.makeFloating()):(this.removeAttribute("is-floating"),this.removeFloating())}get isFloating(){return!!this.getAttribute("is-floating")}open(){if(super.open(),this.isFloating){let t=E.getState().position;t&&t.top!==void 0&&t.left!==void 0&&(this._modalElem.style.transform=`translate3d(${t.left}px,${t.top}px,0px)`)}}};customElements.define("lucid-settings-modal",D);window.Modal=H;window.FloatingModal=D;var B=null;function Ae(e,t){B&&(B instanceof Spicetify.Topbar.Button?B.element?.remove():B.deregister(),B=null),e==="context-menu"?Spicetify?.Menu?.Item?(B=new Spicetify.Menu.Item("Lucid Settings",!1,t,Oe),B.register()):console.error("Context menu unavailable.Try Switching to Nav."):e==="nav"&&(Spicetify?.Topbar?.Button?B=new Spicetify.Topbar.Button("Lucid Settings",Oe,t,!1,!0):console.error("Nav bar unavailable.Try Switching to Context Menu."))}var M=null,_=null,Go=100,zo=150,m=a("div",{id:"tooltip",role:"tooltip",ariaHidden:"true",style:{position:"fixed",display:"block",padding:"0.5rem 1rem",border:"1px solid var(--border-color, var(--clr-surface-0))",color:"var(--clr-on-surface, #fafafa)",backgroundColor:"rgba(var(--clr-surface-0-rgb, var(--spice-rgb-main)), 0.85)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(var(--clr-shadow-rgb), 0.25)",backdropFilter:"blur(10px)",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s ease-out",pointerEvents:"auto",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-5px) scale(0.95)",maxWidth:`${window.innerWidth/2}px`,fontSize:"0.875rem",textAlign:"center"}}),Y=a("span",{className:"tooltip-content",style:{display:"inline-block",transition:"opacity 0.3s ease"}});m.appendChild(Y);document.body.appendChild(m);m.addEventListener("mouseenter",()=>{_&&(clearTimeout(_),_=null)});m.addEventListener("mouseleave",()=>{It()});function Wo(e,t){t&&(_&&(clearTimeout(_),_=null),M&&(clearTimeout(M),M=null),M=setTimeout(()=>{typeof t=="string"?Y.innerHTML=`<span style="font-weight: 500; color: inherit;">${t}</span>`:(Y.innerHTML="",Y.appendChild(t)),m.style.visibility="visible",m.style.opacity="1",m.style.transform="translateY(0) scale(1)",m.setAttribute("aria-hidden","false");let o,r;if(e.target instanceof HTMLElement){let i=e.target.getBoundingClientRect();o=i.left+i.width/2-m.offsetWidth/2,r=i.top-m.offsetHeight}else o=e.clientX+10,r=e.clientY+10;o=Math.max(0,Math.min(o,window.innerWidth-m.offsetWidth)),m.style.left=`${o}px`,m.style.top=`${r}px`,m.style.maxWidth=`${window.innerWidth/2}px`,M=null},Go))}function It(){m.matches(":hover")||Y.matches(":hover")||(M&&(clearTimeout(M),M=null),_&&(clearTimeout(_),_=null),_=setTimeout(()=>{m.style.opacity="0",m.style.transform="translateY(-5px) scale(0.95)",m.style.visibility="hidden",m.setAttribute("aria-hidden","true"),_=null},zo))}var Se=class{elem;content;mouseoverHandler;mouseoutHandler;open=!1;constructor(t){this.content=t,this.elem=a("div",{className:"tooltip-wrapper",innerHTML:`<span class="icon" style="height:24px; width:24px;">${wt}</span>`,style:{cursor:"help",display:"inline-flex"},ariaLabel:typeof t=="string"?t:void 0,ariaHasPopup:"true"}),this.mouseoverHandler=o=>{this.open=!0,Wo(o,this.content)},this.mouseoutHandler=()=>{!this.elem.matches(":hover")&&this.open&&(It(),this.open=!1)},this.elem.addEventListener("mouseenter",this.mouseoverHandler),this.elem.addEventListener("mouseleave",this.mouseoutHandler)}dispose(){this.elem.removeEventListener("mouseenter",this.mouseoverHandler),this.elem.removeEventListener("mouseleave",this.mouseoutHandler),this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem)}};var Z=class extends HTMLElement{_options=[];_value="";_isOpen=!1;_highlightedIndex=-1;_trigger;_selectedValueSpan;_optionsList;shadow;constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.handleDocumentClick=this.handleDocumentClick.bind(this)}set options(t){this._options=t,this.renderOptions()}get options(){return this._options}set value(t){this._value=t,this.updateSelected()}get value(){return this._value}connectedCallback(){this.render(),document.addEventListener("click",this.handleDocumentClick)}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick)}render(){this.shadow.innerHTML=`
        <style>.option,.trigger{cursor:pointer;transition:background 225ms ease-in-out}.select-container{width:100%;min-width:6rem;position:relative}.options,.options::before{width:100%;position:absolute}.trigger{padding:.5rem .75rem;background-color:var(--clr-surface-2);width:100%;display:flex;align-items:center;text-align:left;line-height:1px;justify-content:space-between;color:var(--clr-on-surface);border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem)}.options{list-style:none;padding:0;margin:0;border:1px solid #ccc;scrollbar-width:thin;background:rgba(var(--clr-surface-1-rgb),.5);z-index:10;max-height:200px;overflow-y:auto;border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem);-webkit-backdrop-filter:blur(8px) saturate(150%);backdrop-filter:blur(8px) saturate(150%)}.options.hidden{display:none}.option{padding:.5rem}.option:last-child{border-bottom:none}.option.highlighted,.option[aria-selected=true]{background:rgba(var(--clr-surface-2-rgb),.7)}.option:hover,.trigger:hover,.trigger[aria-expanded=true]{background:rgba(var(--clr-surface-3-rgb),.75)}.icon{color:var(--clr-on-surface,var(--spice-text));height:20px;width:20px}.trigger,.option{font-size: .85rem;font-weight:500;font-family:inherit;color: var(--clr-on-surface,var(--spice-text,#fafafa))}</style>
        <div class="select-container">
          <button type="button" class="trigger" aria-haspopup="listbox" aria-expanded="false">
            <span class="selected-value"></span>
            <span class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5.79681 7C4.95612 7 4.49064 7.97434 5.01887 8.62834L8.83333 13.351C9.43371 14.0943 10.5668 14.0943 11.1672 13.351L14.9816 8.62834C15.5098 7.97434 15.0444 7 14.2037 7H5.79681Z" fill="currentColor"/>
              </svg>
            </span>
          </button>
          <ul class="options hidden" role="listbox" tabindex="-1"></ul>
        </div>
      `,this._trigger=this.shadow.querySelector(".trigger"),this._selectedValueSpan=this.shadow.querySelector(".selected-value"),this._optionsList=this.shadow.querySelector(".options"),this._trigger.addEventListener("click",()=>this.checkboxOptions()),this._trigger.addEventListener("keydown",t=>this.handleTriggerKeydown(t)),this._optionsList.addEventListener("click",t=>this.handleOptionClick(t)),this._optionsList.addEventListener("keydown",t=>this.handleOptionsKeydown(t)),this.renderOptions(),this.updateSelected()}renderOptions(){if(this._optionsList){this._optionsList.innerHTML="";for(let[t,o]of this._options.entries()){let r=a("li",{role:"option",className:"option",textContent:o.label,ariaSelected:o.value===this._value?"true":"false"});r.setAttribute("data-index",t.toString()),r.setAttribute("data-value",o.value),this._optionsList.appendChild(r)}}}updateSelected(){if(!this._selectedValueSpan)return;let t=this._options.find(r=>r.value===this._value);this._selectedValueSpan.textContent=t?t.label:"Select an option";let o=Array.from(this._optionsList.children);for(let r of o){let i=r.getAttribute("data-value");r.setAttribute("aria-selected",i===this._value?"true":"false")}}checkboxOptions(){this._isOpen=!this._isOpen,this._isOpen?this.openOptions():this.closeOptions()}openOptions(){this._optionsList.classList.remove("hidden"),this._trigger.setAttribute("aria-expanded","true"),this._highlightedIndex=this._options.findIndex(t=>t.value===this._value),this._highlightedIndex===-1&&(this._highlightedIndex=0),this.highlightOption(this._highlightedIndex),this._optionsList.focus()}closeOptions(){this._isOpen=!1,this._optionsList.classList.add("hidden"),this._trigger.setAttribute("aria-expanded","false"),this._highlightedIndex=-1}handleTriggerKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),this.openOptions();break;case"Enter":case" ":t.preventDefault(),this.checkboxOptions();break}}handleOptionsKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),this.moveHighlight(1);break;case"ArrowUp":t.preventDefault(),this.moveHighlight(-1);break;case"Enter":t.preventDefault(),this.selectHighlighted();break;case"Escape":t.preventDefault(),this.closeOptions(),this._trigger.focus();break}}handleOptionClick(t){let o=t.target;if(o&&o.getAttribute("role")==="option"){let r=Number.parseInt(o.getAttribute("data-index")||"0",10);this._highlightedIndex=r,this.selectHighlighted()}}moveHighlight(t){let o=this._options.length;o!==0&&(this._highlightedIndex=(this._highlightedIndex+t+o)%o,this.highlightOption(this._highlightedIndex))}highlightOption(t){let o=this._optionsList.querySelectorAll(".option"),r=0;for(let i of o)r===t?(i.classList.add("highlighted"),i.scrollIntoView({block:"nearest"})):i.classList.remove("highlighted"),r++}selectHighlighted(){if(this._highlightedIndex>=0&&this._highlightedIndex<this._options.length){let t=this._options[this._highlightedIndex];this._value=t.value,this.updateSelected(),this.closeOptions(),this._trigger.focus(),this.dispatchEvent(new Event("change",{bubbles:!0}))}}handleDocumentClick(t){this.contains(t.target)||this.closeOptions()}};customElements.define("accessible-select",Z);function Tt(e,t){if(e===t)return!0;let o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(let i of o)if(e[i]!==t[i])return!1;return!0}var J=class extends HTMLElement{_inputOptions;_renderedOptions=null;_inputElement=null;_previewElement=null;set inputOptions(t){this._inputOptions=t,this.render()}get inputOptions(){return this._inputOptions}connectedCallback(){this.render()}removeContent(){this._inputElement=null,this._previewElement=null,this.innerHTML=""}render(){if(this._renderedOptions&&Tt(this._renderedOptions,this._inputOptions))return;this.removeContent();let t=(o,r,i)=>{let n=this._inputElement,l=n.value,c=i?i(l):l;if(!o){r?.(c);return}let p=o(c);p.isValid?(n.classList.remove("error","shake-error"),r?.(c)):(n.classList.remove("shake-error"),n.offsetWidth,n.classList.add("error","shake-error"),p.message&&d(p.message,!0,2e3))};switch(this._inputOptions.type){case"button":{let{buttonType:o,onClick:r,contents:i}=this._inputOptions;this._inputElement=new f,this._inputElement.type=o||"primary",r&&(this._inputElement.onclick=r),this._inputElement.innerHTML=i?.toString()||"Button",this.append(this._inputElement);break}case"number":{let{type:o,step:r,value:i,onChange:n,validator:l}=this._inputOptions;this._inputElement=a("input",{type:o,step:r?.toString()||"1",value:i?.toString(),className:"input number"});let c=new f;c.innerHTML=ve,c.type="icon",c.onclick=()=>t(l,n,p=>Number.parseFloat(p)),this.append(this._inputElement,c);break}case"text":{let{type:o,value:r,onChange:i,validator:n}=this._inputOptions;this._inputElement=a("input",{type:o,value:r,className:"input text"});let l=new f;l.innerHTML=ve,l.type="icon",l.onclick=()=>t(n,i),this.append(this._inputElement,l);break}case"checkbox":{let{onChange:o,checked:r,type:i}=this._inputOptions;this._inputElement=a("input",{checked:r,type:i,className:"checkbox custom"}),this._inputElement.onchange=n=>o?.(n.target.checked),this.append(this._inputElement);break}case"select":{let{options:o,value:r,onChange:i}=this._inputOptions;this._inputElement=new Z,o&&(this._inputElement.options=o),r&&(this._inputElement.value=r),this._inputElement.onchange=n=>i?.(n.target.value),this.append(this._inputElement);break}case"color":{let{value:o,onChange:r}=this._inputOptions;this._inputElement=a("input",{type:"color",value:o,className:"input color"});let i=new f;i.innerHTML=Et,i.type="icon",i.onclick=async()=>{if(!("EyeDropper"in window)&&window.EyeDropper){d("EyeDropper API is not supported in this browser.",!0,3e3);return}try{if(!window.EyeDropper)return;let p=(await new window.EyeDropper().open()).sRGBHex;this._inputElement.value=p,r?.(p)}catch(l){l instanceof Error&&l.message!=="No color selected"&&(console.error("EyeDropper Error:",l),d("Failed to pick color with EyeDropper.",!0,3e3))}};let n=new f;n.innerHTML=ve,n.type="icon",n.onclick=()=>{t(()=>({isValid:!0}),r)},window.EyeDropper?this.append(this._inputElement,i,n):this.append(this._inputElement,n);break}case"image":{let{onChange:o}=this._inputOptions;this._inputElement=a("input",{type:"file",accept:"image/*",className:"input image",style:{display:"none",visibility:"hidden"}}),this._previewElement=a("img",{className:"image-preview",style:{borderRadius:"0.5rem"}}),this._previewElement.src="",this.prepend(this._previewElement),this._inputElement.onchange=r=>{let n=r.target.files?.[0];if(n){let l=new FileReader;l.onload=c=>{let p=c.target?.result;o?.(p),this._previewElement&&(this._previewElement.src=p)},l.readAsDataURL(n)}else o?.(null),this._previewElement&&(this._previewElement.src="")},this.append(new f({type:"primary",textContent:"Select Image",onChange:()=>{this._inputElement?.click()}}),this._inputElement);break}default:console.error("Unsupported input options:",this._inputOptions)}this._renderedOptions=this._inputOptions}};customElements.define("custom-input",J);var X=class extends HTMLElement{_isRender=!1;rendered=!1;_settings=[];sectionElements=[];connectedCallback(){!this.sectionElements.length&&this._settings.length&&this.createSectionElements(),this.render(),this.updateVisibility()}set options(t){this._settings=t,this.updateSectionElements(),this.render(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML=""}createSectionElements(){this.sectionElements=[];for(let t of this._settings){let o=new Q;o.options=t,this.sectionElements.push(o)}}updateSectionElements(){let t=new Map;for(let r of this.sectionElements){let i=r._name;t.set(i,r)}let o=[];for(let r of this._settings){let i=r.name,n=t.get(i);n||(n=new Q),n.options=r,o.push(n)}this.sectionElements=o}render(){!this._settings||this._settings.length===0||this.rendered||(this.clear(),this.append(...this.sectionElements),this.rendered=!0)}};customElements.define("settings-main",X);var Q=class extends HTMLElement{_isRender=!1;rendered=!1;_headerElement;_groupsWrapperElement;_name="";_groups=[];groupElements=[];constructor(){super(),this._headerElement=a("div",{className:"header-wrapper",style:{textAlign:"center"}}),this._groupsWrapperElement=a("div",{style:{marginTop:".25rem",display:"flex",flexDirection:"column",gap:".5rem",width:"100%"}})}connectedCallback(){!this.groupElements.length&&this._groups.length&&this.createGroupElements(),this.render(),this.updateVisibility()}set options(t){this._name=t.name,this._groups=t.groups,this._isRender=t.render,this.updateGroupElements(),this.render(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="block",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._headerElement.innerHTML="",this._groupsWrapperElement.innerHTML=""}createGroupElements(){this.groupElements=[];for(let t of this._groups){let o=new j;o.options=t,this.groupElements.push(o)}}updateGroupElements(){let t=new Map;for(let r of this.groupElements)t.set(r._key,r);let o=[];for(let r of this._groups){let i=t.get(r.key);i||(i=new j),i.options=r,o.push(i)}this.groupElements=o}render(){!this._groups||this._groups.length===0||this.rendered||(this.dataset.tabId=this._name.toLowerCase(),this.clear(),this._headerElement.append(a("h3",{textContent:this._name,className:L("title-small"),style:{fontSize:"1.25rem"}})),this._groupsWrapperElement.append(...this.groupElements),this.append(this._headerElement,this._groupsWrapperElement),this.rendered=!0)}};customElements.define("setting-section",Q);var j=class extends HTMLElement{_isRender=!1;rendered=!1;_nameContainerElement;_fieldsContainerElement;_showName=!0;_name="Section";_fields=[];_key="";fieldElements=[];constructor(){super(),this._nameContainerElement=a("div"),this._fieldsContainerElement=a("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}})}connectedCallback(){!this.fieldElements.length&&this._fields.length&&this.createFieldElements(),this.render(),this.updateVisibility()}set options(t){this._name=t.name,this._fields=t.fields,this._isRender=t.render,this._key=t.key,this._showName=t.showName??!0,this.updateFieldElements(),this.updateVisibility()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._nameContainerElement.innerHTML="",this._fieldsContainerElement.innerHTML=""}createFieldElements(){this.fieldElements=[];for(let t of this._fields){let o=new ee;o.isRender=t.render??!0,o.inputOptions=t.inputOptions,o.label=t.label,o.fieldKey=t.key,t.tooltip&&(o.tooltip=t.tooltip),this.fieldElements.push(o)}}updateFieldElements(){let t=new Map;for(let r of this.fieldElements)t.set(r.fieldKey,r);let o=[];for(let r of this._fields){let i=t.get(r.key);i?(i.isRender=r.render??!0,i.inputOptions=r.inputOptions,r.tooltip&&(i.tooltip=r.tooltip)):(i=new ee,i.isRender=r.render??!0,i.inputOptions=r.inputOptions,i.label=r.label,i.fieldKey=r.key,r.tooltip&&(i.tooltip=r.tooltip)),o.push(i)}this.fieldElements=o}render(){!this._fields||this._fields.length===0||this.rendered||(this.dataset.groupId=this._name.toLowerCase(),this.clear(),this._name&&this._showName&&(this._nameContainerElement.append(a("h4",{textContent:this._name,className:L("body-small-bold"),style:{fontSize:".8rem",marginLeft:".25rem",lineHeight:"normal"}})),this.append(this._nameContainerElement)),this._fieldsContainerElement.append(...this.fieldElements),this.append(this._fieldsContainerElement),this.rendered=!0)}};customElements.define("setting-group",j);var ee=class extends HTMLElement{_isRender;rendered;_labelContainer;_inputElement;_tooltipInstance;_label;_fieldKey="";inputOptions;constructor(){super(),this._isRender=!1,this.rendered=!1,this._label="Section",this._tooltipInstance=null,this.inputOptions=null,this._inputElement=new J,this._labelContainer=a("div",{className:"label-wrapper",style:{display:"flex",gap:"0.5rem",alignItems:"center"}})}connectedCallback(){this.rendered||this.render(),this.updateVisibility()}disconnectedCallback(){this._tooltipInstance?.dispose()}set isRender(t){this._isRender=t,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}set tooltip(t){t&&(this._tooltipInstance||(this._tooltipInstance=new Se(t)),this._tooltipInstance.content=t)}clear(){this.innerHTML=""}render(){!this.inputOptions||this.rendered||(this.dataset.fieldId=this._label.toLowerCase(),this._labelContainer.append(a("p",{textContent:this._label,className:L("body-small")})),this._tooltipInstance&&this._labelContainer.append(this._tooltipInstance.elem),this._inputElement.inputOptions=this.inputOptions,this.append(this._labelContainer,this._inputElement),this.rendered=!0)}set label(t){this._label=t,this.rendered&&this.render()}get label(){return this._label}set fieldKey(t){this._fieldKey=t}get fieldKey(){return this._fieldKey}};customElements.define("setting-field",ee);var He=e=>{let t="Invalid URL";try{let o=new URL(e);return["http:","https:"].includes(o.protocol)?{isValid:!0}:{isValid:!1,message:t}}catch{return{isValid:!1,message:t}}},te=(e,t,o)=>{let r=`Enter a number between ${t} and ${o}.`;return typeof e!="number"||Number.isNaN(e)?{isValid:!1,message:r}:e<t||e>o?{isValid:!1,message:r}:{isValid:!0}},P=e=>te(e,0,512),R=e=>te(e,0,256),b=e=>te(e,0,200),oe=e=>te(e,0,100),Lt=e=>te(e,0,10),Bt=e=>{if(!e||e.trim()==="")return{isValid:!1,message:"URL cannot be empty."};try{let t=new URL(e);return!t.hostname.endsWith("fonts.googleapis.com")&&!t.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Hostname is not a Google Fonts domain."}:t.protocol!=="http:"&&t.protocol!=="https:"?{isValid:!1,message:"Protocol must be HTTP or HTTPS."}:!t.pathname.startsWith("/css")&&!t.pathname.startsWith("/earlyaccess")&&!t.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Path is not a typical Google Fonts CSS path."}:t.hostname.endsWith("fonts.googleapis.com")&&!t.searchParams.has("family")?{isValid:!1,message:"URL does not contain the 'family' parameter."}:{isValid:!0}}catch{return{isValid:!1,message:"Invalid URL format."}}};async function Mt(e,t="Text copied to clipboard!"){if(navigator.clipboard)try{await navigator.clipboard.writeText(e),console.debug(t),d(t,!1,5e3)}catch(o){console.error("Error copying to clipboard:",o),d(`Error copying to clipboard: ${o instanceof Error?o.message:o}`,!0,5e3)}else console.error("Error copying text (navigator.clipboard not found)"),d("Error copying text (navigator.clipboard not found)",!0,5e3)}async function _e(e=!1){(!localStorage.getItem(K)||e)&&(await Ko(),setTimeout(()=>{window?.guide?(window.guide.open(),localStorage.setItem(K,"true")):console.error("Guide script loaded, but window.guide is not available.")},1e3))}async function Ko(){let e="guideScript",t=document.getElementById(e);if(t){console.debug("Guide script already mounted.");return}try{d("Please wait. Guided Tour is loading.",!1,1e3);let o=await $(Ge,ce);if(t=a("script",{id:e,type:"text/javascript",defer:!0}),!t)return;t.textContent=o,document.body.appendChild(t),console.debug("Mounted Guide script.")}catch(o){console.error("Failed to load guide script:",o),d("Failed to load Guided Tour.",!0)}}var C=null,Pt=()=>new Promise((e,t)=>{if(C){console.debug("Lucid: Database already initialized."),e();return}let o=window.indexedDB.open("LucidImageDB",1);o.onerror=r=>{console.error("Database error:",r),t(r)},o.onsuccess=()=>{C=o.result,console.debug("Lucid: Database initialized."),e()},o.onupgradeneeded=()=>{C=o.result,console.debug("Lucid: Upgrading database..."),C.objectStoreNames.contains("imageStore")||C.createObjectStore("imageStore",{keyPath:"id"}).createIndex("data","data",{unique:!1})}}),Rt=(e,t)=>new Promise((o,r)=>{let i=()=>{if(!C)return;let l=C.transaction(["imageStore"],"readwrite").objectStore("imageStore"),c={id:1,data:e},p=l.put(c);p.onsuccess=()=>{console.debug("Image added/updated successfully."),t?.(),o()},p.onerror=N=>{console.error("Error adding/updating image",N),r(N)}};C?i():Pt().then(i).catch(r)}),Ot=()=>new Promise((e,t)=>{let o=()=>{if(!C)return;let n=C.transaction(["imageStore"],"readonly").objectStore("imageStore").get(1);n.onsuccess=()=>{let l=n.result;e(l?l.data:null)},n.onerror=l=>{console.error("Error retrieving image",l),t(l)}};C?o():Pt().then(o).catch(t)});function Ue(e){let t="";return e.blur&&(t+=`blur(${e.blur}px) `),e.brightness&&(t+=`brightness(${e.brightness}%) `),e.contrast&&(t+=`contrast(${e.contrast}%) `),e.grayscale&&(t+=`grayscale(${e.grayscale}) `),e.hueRotate&&(t+=`hue-rotate(${e.hueRotate}) `),e.invert&&(t+=`invert(${e.invert}) `),e.opacity&&(t+=`opacity(${e.opacity}%) `),e.saturate&&(t+=`saturate(${e.saturate||0}%) `),e.sepia&&(t+=`sepia(${e.sepia}) `),t.trim()}var re=document.querySelector("lucid-bg-wrapper"),g=re?.querySelector("lucid-bg"),y=null,U=null,v=null,qo=()=>{y=null,v=null,g||ie(),!U&&g&&(U=a("div",{className:"solid-bg",style:{backgroundColor:"var(--solid-bg-color, var(--clr-surface))",height:"100%",width:"100%"}}),g.innerHTML="",g.appendChild(U))},Yo=()=>{U=null,v=null,g||ie(),!y&&g&&(y=a("img",{className:"static-bg",style:{display:"block",height:"100%",width:"100%",objectFit:"cover",filter:"var(--static-bg-filter)"}}),g.innerHTML="",g.appendChild(y))},Zo=()=>{if(y=null,U=null,g||ie(),!v&&g){v=a("div",{className:"animated-bg-wrapper",style:{position:"relative",height:"100%",width:"100%"}}),g.innerHTML=`
<style>
.img{ position: absolute; border-radius: 20em; width: 200%; animation: animBg 40s linear infinite;}
.img-0 { right: 30%; top: 0; z-index: 2 }
.img-1 { animation-direction: reverse; bottom: 0; left: 0; z-index: 1}
.img-2 { animation-direction: reverse; right: -50%; top: -20%; width: 300%; z-index: 0 }
@keyframes animBg { 0% { transform: rotate(0deg) translate3d(0px,0px,0px); } to { transform: rotate(1turn) translate3d(0px,0px,0px); } }
</style>
`;for(let e=0;e<3;e++){let t=a("img",{className:`img img-${e}`,style:{willChange:"transform",backgroundImage:"url(var(--image-url))"}});v.appendChild(t)}g.appendChild(v)}},At=(e=s.getState())=>{let t=e.background;switch(t.mode){case"solid":{U||qo();let{hex:o,alpha:r}=t.options.solid.color;U?.style.setProperty("--solid-bg-color",`${o}${I(r)}`);break}case"static":{if(y||Yo(),!y)return;let{filter:o,isCustomImage:r}=t.options.static;r?y.setAttribute("custom-image",""):y.removeAttribute("custom-image"),y.style.setProperty("--static-bg-filter",Ue(o)),F();break}case"animated":{if(v||Zo(),!v)return;let{filter:o}=t.options.animated;v&&(v.style.filter=Ue(o)),F();break}default:{console.error("Unexpected background mode:",t.mode),d("Unexpected error setting background.");break}}},Jo=e=>{if(g&&e){let t=new Image;t.src=e,t.onload=()=>{if(g||ie(),y&&(y.src=e??""),v){let o=v.querySelectorAll("img");for(let r of o)r.src=e??""}}}},ie=()=>{re||(re=a("div",{className:"lucid-bg-wrapper",style:{display:"block",position:"fixed",height:"100vh",width:"100vw",zIndex:"-1",top:"0",left:"0",overflow:"hidden"}}),(document.getElementById("main")??document.body).prepend(re)),g||(g=a("div",{className:"lucid-bg",style:{display:"block",height:"100%",width:"100%",overflow:"hidden"}}),re.prepend(g))},F=async()=>{let e=s.getState();if(e.background.mode==="solid")return;let t="";e.background.options.static.isCustomImage?e.customImage.type==="local"?t=await Ot():t=e.customImage.options.url.data:t=S.getState().url,Jo(t??"")};function Ht(){ie(),At(),F(),s.subscribe(e=>{At(e)},"background"),s.subscribe(()=>{F()},"customImage.type"),S.subscribe(()=>{F()})}var Fe=null,Nt=null,O=new D,Ce=()=>{Fe?.()},Ne=()=>{Nt?.()},Xo=()=>{let e=a("div",{id:"settings-container"}),t=new X;return t.isRender=!0,t.options=Ft(),s.subscribe(o=>{t.options=Ft(o)}),e.appendChild(t),e};function Vt(){O.isFloating=E.getState().isFloating,O.setContent(Xo()),E.subscribe(e=>{O.isFloating=e.isFloating},"isFloating"),document.getElementById("main")?.append(O),Fe=()=>O.open(),Nt=()=>O.close(),Ae(s.getState().position,Ce),s.subscribe(e=>{Fe&&Ae(e.position,Ce)},"position")}var Ut={floatWin:["Floating Window","Allows settings to float. Drag header to reposition."],winPos:["Window Position","Settings window opens from context menu or nav bar."],bgMode:["Mode","Select background type."],solidColor:["Solid Color","Pick solid background color."],custImg:["Custom Image","Use custom image URL for static background."],custUMVImg:["Custom Image","Use custom image URL for playlist background."],imgSrc:["Image Source","Upload image or use URL for custom background."],custImgUrl:["Custom Image URL","Enter image URL for static background."],custImgInput:["Select Custom Image","Select local image for static background."],custImgLocal:["Select Local Image","Select images for static background."],filterBlur:["Blur","Blur level of image (0-200)."],filterBlurCustom:["Blur (Custom)","Blur level for custom page background (0-200)."],filterBlurNormal:["Blur (Default)","Blur level for default page background (0-200)."],filterBlurNpv:["Blur (NPV)","Blur level for NPV page background (0-200)."],filterExtendedBlur:["Extended background Blur","Blur level of extended page background (0-200)."],filterBright:["Brightness","Brightness of image (0-200)."],filterSat:["Saturation","Saturation of image (0-200)."],dynColor:["Dynamic Color","Dynamic color themes based on artwork."],tonalColor:["Tonal Color","Tonal color scheme for UI."],custColorEnable:["Custom Color","Enable custom color to override theme color."],custColorPicker:["Select Custom Color",'Choose base theme color. Preview: <a href="https://material-foundation.github.io/material-theme-builder/">Material Theme Builder</a>'],gFontsEnable:["Google Fonts","Enable fonts from Google Fonts."],gFontsUrl:["Google Fonts URL","URL of Google Fonts stylesheet."],fontFamily:["Font Family","Font family for UI when Google Fonts disabled."],grainType:["Grain Type","Type of grain effect overlay."],winCtrlHeight:["Control Height","Height of window control buttons on Windows (0-200)."],winPanelGap:["Panel Gap","Gap between main cards."],borderThick:["Thickness","Thickness of interface border (0-10)."],borderColor:["Color","Color of application border."],borderStyle:["Style","Visual style of interface border."],pagesBgStyle:["Style","Background display on pages."],pagesImageStyle:["Image Style","Image on pages. (playlist/album art)"],homeHeaderBg:["Home Header Background","Enable/Disable Home header background."],scrollFullBg:["Scroll Fullscreen Background","Scroll background in fullscreen playlist."],scaleFullBg:["Scale Fullscreen Background","Scale background for fullscreen playlist."],scrollNpvBg:["Scroll Background","Scroll background for Now playing art playlist."],scaleNpvBg:["Scale Background","Scale background for Now playing art playlist."],scrollNormBg:["Scroll Background","Scroll background for normal playlist."],scaleNormBg:["Scale Background","Scale background for normal playlist."],scrollCusBg:["Scroll Background","Scroll background for custom playlist."],scaleCusBg:["Scale Custom Background","Scale background for custom playlist."],rsbViewMode:["View Mode","Normal or compact 'Now Playing' sidebar."],rsbSize:["Compact Sidebar Width","Width of compact 'Now Playing' sidebar (0-512px)."],rsbPos:["Position","Position of compact 'Now Playing' sidebar."],rsbBgBlur:["Blur","Background blur of compact 'Now Playing' view (0-256)."],rsbCustBgEnable:["Custom Background","Enable custom background for Now Playing view."],rsbBgColor:["Color","Background color for 'Now Playing' sidebar."],rsbBgAlpha:["Alpha","Background transparency (alpha) value (0-100)."],rsbBorderAlpha:["Border Alpha","Border transparency (alpha) value (0-100)."],playbarType:["Playbar Type","Default or Compact playbar style."],compactPbHideIcons:["Hide Extra Playbar Icons","Hides extra icons in compact playbar (on hover)."],compactPbBorderRad:["Border Radius","Border Radius of compact playbar in pixels."],normalPbBorderRad:["Border Radius","Border Radius of normal playbar in pixels."],compactPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in compact playbar in pixels."],normalPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in normal playbar in pixels."],compactPbHeight:["Height","Height of compact playbar in pixels."],normalPbHeight:["Height","Height of normal playbar in pixels."],playbarFloat:["Floating","Now playing bar is floating."],pbBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],pbBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],pbBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],showChangelog:["Show Changelog","Changelog modal after updates."],lucidTour:["Take a Lucid Tour","Guided walkthrough of Lucid theme features."],exportSettings:["Export Settings","Export settings to clipboard as JSON."],importSettings:["Import Settings","Import settings from JSON."],resetSettings:["Reset All Settings","Reset all settings to default values (irreversible)."],pagesScrollType:["Image Source","Now Playing View art or default playlist art for pages."]};function Ft(e=s.getState(),t=s){let o=(r,i,n)=>({render:n===void 0?!0:n,inputOptions:i,label:Ut[r][0],tooltip:Ut[r][1],key:r.replace(/([A-Z])/g,"-$1").toLowerCase()});return[{name:"General",render:!0,groups:[{render:!0,name:"Behavior",key:"group-behavior",showName:!1,fields:[o("lucidTour",{type:"button",buttonType:"primary",contents:"Start",onClick:()=>{localStorage.removeItem("lucid-guided-tour"),Ne(),_e(!0)}}),o("floatWin",{type:"checkbox",checked:E.getState().isFloating,onChange:r=>{E.setState(i=>({...i,isFloating:r}))}}),o("winPos",{type:"select",value:e.position,options:[{label:"Context Menu",value:"context-menu"},{label:"Navigation Bar",value:"nav"}],onChange:r=>{t.setPosition(r)}})]}]},{name:"Background",render:!0,groups:[{render:!0,name:"Mode",key:"group-background-mode",fields:[o("bgMode",{type:"select",value:e.background.mode,options:[{label:"Animated",value:"animated"},{label:"Solid Color",value:"solid"},{label:"Static Image",value:"static"}],onChange:r=>{t.setBackgroundMode(r)}})]},{name:"Background",key:"group-bg-background",render:!0,fields:[o("solidColor",{type:"color",value:e.background.options.solid.color.hex,onChange:r=>{t.setSolidBackgroundColor({hex:r})}},e.background.mode==="solid"),o("rsbBgAlpha",{type:"number",value:e.background.options.solid.color.alpha,validator:oe,onChange:r=>{t.setSolidBackgroundColor({alpha:r})}},e.background.mode==="solid"),o("custImg",{type:"checkbox",checked:e.background.options.static.isCustomImage,onChange:r=>{t.setStaticBackgroundOptions({isCustomImage:r})}},e.background.mode!=="solid"),o("imgSrc",{type:"select",value:e.customImage.type,options:[{label:"Local",value:"local"},{label:"From Url",value:"url"}],onChange:r=>{t.setCustomImageType(r)}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage),o("custImgUrl",{type:"text",value:e.customImage.options.url.data??"Enter Image URL",validator:He,onChange:r=>{t.setCustomImageOptions("url",{data:r})}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage&&e.customImage.type==="url"),o("custImgInput",{type:"image",onChange:r=>{r&&Rt(r,F)}},e.background.mode!=="solid"&&e.background.options.static.isCustomImage&&e.customImage.type==="local")]},{render:e.background.mode!=="solid",name:"Filters",key:"group-bg-filters",fields:[o("filterBlur",{type:"number",value:e.background.options.static.filter.blur,onChange:r=>{t.setStaticBackgroundFilter({blur:r})},step:1,validator:b},e.background.mode==="static"),o("filterBright",{type:"number",value:e.background.options.static.filter.brightness,onChange:r=>{t.setStaticBackgroundFilter({brightness:r})},step:1,validator:b},e.background.mode==="static"),o("filterSat",{type:"number",value:e.background.options.static.filter.saturate,onChange:r=>{t.setStaticBackgroundFilter({saturate:r})},step:.1,validator:b},e.background.mode==="static"),o("filterBlur",{type:"number",value:e.background.options.animated.filter.blur,onChange:r=>{t.setAnimatedBackgroundFilter({blur:r})},step:1,validator:b},e.background.mode==="animated"),o("filterBright",{type:"number",value:e.background.options.animated.filter.brightness,onChange:r=>{t.setAnimatedBackgroundFilter({brightness:r})},step:1,validator:b},e.background.mode==="animated"),o("filterSat",{type:"number",value:e.background.options.animated.filter.saturate,onChange:r=>{t.setAnimatedBackgroundFilter({saturate:r})},step:1,validator:b},e.background.mode==="animated")]},{render:!0,name:"Color",key:"group-color",fields:[o("dynColor",{type:"checkbox",checked:e.color.isDynamic,onChange:r=>{t.setDynamicColor(r)}}),o("tonalColor",{type:"checkbox",checked:e.color.isTonal,onChange:r=>{t.setTonalColor(r)}}),o("custColorEnable",{type:"checkbox",checked:e.color.isCustom,onChange:r=>{t.setIsCustomColor(r)}},!e.color.isDynamic),o("custColorPicker",{type:"color",value:e.color.customColor.hex,onChange:r=>{t.setCustomColor({hex:r})}},!e.color.isDynamic&&e.color.isCustom)]}]},{name:"Interface",render:!0,groups:[{render:!0,name:"Font",key:"group-font",fields:[o("gFontsEnable",{type:"checkbox",checked:e.font.isGoogleFonts,onChange:r=>{t.setFont({isGoogleFonts:r})}}),o("gFontsUrl",{type:"text",value:e.font.fontUrl||"",validator:Bt,onChange:r=>{t.setFont({fontUrl:r})}},e.font.isGoogleFonts),o("fontFamily",{type:"text",value:e.font.fontFamily||"",onChange:r=>{t.setFont({fontFamily:r})}},!e.font.isGoogleFonts)]},{render:!0,key:"group-grain-effect",name:"Grain Effect",fields:[o("grainType",{type:"select",value:e.grains.type,options:[{label:"Normal",value:"default"},{label:"Starry",value:"starry"},{label:"None",value:"none"}],onChange:r=>{t.setGrainsType(r)}})]},{render:!0,key:"group-window-controls",name:"Window",fields:[o("winPanelGap",{type:"number",step:1,value:e.pages.panelGap,validator:oe,onChange:r=>{t.setPages({panelGap:r})}}),o("winCtrlHeight",{type:"number",step:1,value:e.control.height,validator:b,onChange:r=>{t.setControlHeight(r)}},be())]},{render:!0,key:"group-border",name:"Border",fields:[o("borderThick",{type:"number",step:1,value:e.border.thickness,validator:Lt,onChange:r=>{t.setBorder({thickness:r})}}),o("borderStyle",{type:"select",options:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],onChange:r=>{t.setBorder({style:r})},value:e.border.style}),o("borderColor",{type:"color",value:e.border.color.hex,onChange:r=>{t.setBorderColor({hex:r})}}),o("rsbBorderAlpha",{type:"number",value:e.border.color.alpha,validator:oe,onChange:r=>{t.setBorderColor({alpha:r})}})]},{render:!0,key:"group-now-playing-view",name:"Now Playing View",fields:[o("rsbViewMode",{type:"select",value:e.rightSidebar.mode,options:[{label:"Normal",value:"normal"},{label:"Compact",value:"compact"}],onChange:r=>{t.setRightSidebar({mode:r})}}),o("rsbSize",{type:"number",value:e.rightSidebar.size,validator:P,onChange:r=>{t.setRightSidebar({size:r})}},e.rightSidebar.mode==="compact"),o("rsbPos",{type:"select",value:e.rightSidebar.position,options:[{label:"Top Left",value:"top left"},{label:"Top Right",value:"top right"},{label:"Bottom Left",value:"bottom left"},{label:"Bottom Right",value:"bottom right"}],onChange:r=>{t.setRightSidebar({position:r})}},e.rightSidebar.mode==="compact"),o("rsbBgBlur",{type:"number",value:e.rightSidebar.blur,validator:R,onChange:r=>{t.setRightSidebar({blur:r})}},e.rightSidebar.mode==="compact"),o("rsbCustBgEnable",{type:"checkbox",checked:e.rightSidebar.isCustomBg,onChange:r=>{t.setRightSidebar({isCustomBg:r})}}),o("rsbBgColor",{type:"color",value:e.rightSidebar.color.hex,onChange:r=>{t.setRightSidebarColor({hex:r})}},e.rightSidebar.isCustomBg),o("rsbBgAlpha",{type:"number",value:e.rightSidebar.color.alpha,validator:oe,onChange:r=>{t.setRightSidebarColor({alpha:r})}},e.rightSidebar.isCustomBg)]}]},{name:"Page Settings",render:!0,groups:[{render:!0,key:"group-page-style",name:"Page Styles",fields:[o("homeHeaderBg",{type:"checkbox",checked:e.pages.hideHomeHeader,onChange:r=>{t.setPages({hideHomeHeader:r})}}),o("pagesBgStyle",{type:"select",value:e.pages.style,onChange:r=>{t.setPageStyle(r)},options:[{label:"Default",value:"normal"},{label:"Card",value:"card"},{label:"Compact",value:"compact"},{label:"Compact Card",value:"compact-card"}]}),o("pagesImageStyle",{type:"select",value:e.pages.imageStyle,onChange:r=>{t.setPageImageStyle(r)},options:[{label:"Default",value:"default"},{label:"As Bg",value:"as-bg"},{label:"Hidden",value:"hidden"}]}),o("pagesScrollType",{type:"select",value:e.pages.umv.type,options:[{value:"normal",label:"Default"},{value:"custom",label:"Custom"},{value:"npv",label:"Now Playing Art"}],onChange:r=>{t.setUMV({type:r})}}),o("custUMVImg",{type:"text",validator:He,value:e.pages.umv.options.custom.url??"Enter a Url",onChange:r=>{t.setUMVOption("custom",{url:r})}},e.pages.umv.type==="custom")]},{key:"group-page-image-filter",name:"Page Background Image Filter",render:!0,fields:[o("filterBlurCustom",{type:"number",validator:b,value:e.pages.umv.options.custom.filter?.blur,onChange:r=>{t.setUMVFilter("custom",{blur:r})}},e.pages.umv.type==="custom"),o("filterBlurNormal",{type:"number",validator:b,value:e.pages.umv.options.normal.filter?.blur,onChange:r=>{t.setUMVFilter("normal",{blur:r})}},e.pages.umv.type==="normal"),o("filterBlurNpv",{type:"number",validator:b,value:e.pages.umv.options.npv.filter?.blur,onChange:r=>{t.setUMVFilter("npv",{blur:r})}},e.pages.umv.type==="npv"),o("filterExtendedBlur",{type:"number",validator:b,value:e.pages.umv.options.expanded.filter?.blur,onChange:r=>{t.setUMVFilter("expanded",{blur:r})}})]},{key:"group-page-bg-behavior",name:"Background Behavior",render:!0,fields:[o("scrollCusBg",{type:"checkbox",checked:e.pages.umv.options.custom.isScroll,onChange:r=>{t.setUMVOption("custom",{isScroll:r})}},e.pages.umv.type==="custom"),o("scaleCusBg",{type:"checkbox",checked:e.pages.umv.options.custom.isScaling,onChange:r=>{t.setUMVOption("custom",{isScaling:r})}},e.pages.umv.type==="custom"),o("scrollNormBg",{type:"checkbox",checked:e.pages.umv.options.normal.isScroll,onChange:r=>{t.setUMVOption("normal",{isScroll:r})}},e.pages.umv.type==="normal"),o("scaleNormBg",{type:"checkbox",checked:e.pages.umv.options.normal.isScaling,onChange:r=>{t.setUMVOption("normal",{isScaling:r})}},e.pages.umv.type==="normal"),o("scrollNpvBg",{type:"checkbox",checked:e.pages.umv.options.npv.isScroll,onChange:r=>{t.setUMVOption("npv",{isScroll:r})}},e.pages.umv.type==="npv"),o("scaleNpvBg",{type:"checkbox",checked:e.pages.umv.options.npv.isScaling,onChange:r=>{t.setUMVOption("npv",{isScaling:r})}},e.pages.umv.type==="npv"),o("scrollFullBg",{type:"checkbox",checked:e.pages.umv.options.expanded.isScroll,onChange:r=>{t.setUMVOption("expanded",{isScroll:r})}}),o("scaleFullBg",{type:"checkbox",checked:e.pages.umv.options.expanded.isScaling,onChange:r=>{t.setUMVOption("expanded",{isScaling:r})}})]}]},{name:"Playbar Settings",render:!0,groups:[{render:!0,name:"General",key:"group-playbar-general",showName:!1,fields:[o("playbarType",{type:"select",value:e.playbar.type,onChange:r=>{t.setPlaybar({type:r})},options:[{label:"Default",value:"normal"},{label:"Compact",value:"compact"}]}),o("playbarFloat",{type:"checkbox",checked:e.playbar.isFloating,onChange:r=>{t.setPlaybar({isFloating:r})}})]},{render:e.playbar.type==="compact",name:"Compact Playbar",key:"group-playbar-compact",showName:!0,fields:[o("compactPbHideIcons",{type:"checkbox",checked:e.playbar.hideIcons,onChange:r=>{t.setPlaybar({hideIcons:r})}}),o("compactPbHeight",{type:"number",value:e.playbar.options.compact.height,validator:P,onChange:r=>{t.setPlaybarOptions("compact",{height:r})}}),o("compactPbBorderRad",{type:"number",value:e.playbar.options.compact.borderRadius,validator:P,onChange:r=>{t.setPlaybarOptions("compact",{borderRadius:r})}}),o("pbBackdropBlur",{type:"number",value:e.playbar.options.compact.backdropFilter.blur,validator:R,onChange:r=>{t.setPlaybarFilter("compact",{blur:r})}},e.playbar.isFloating),o("pbBackdropSat",{type:"number",value:e.playbar.options.compact.backdropFilter.saturate,validator:R,onChange:r=>{t.setPlaybarFilter("compact",{saturate:r})}},e.playbar.isFloating),o("pbBackdropBright",{type:"number",value:e.playbar.options.compact.backdropFilter.brightness,validator:R,onChange:r=>{t.setPlaybarFilter("compact",{brightness:r})}},e.playbar.isFloating),o("compactPbImgBorderRad",{type:"number",value:e.playbar.options.compact.imageRadius,validator:P,onChange:r=>{t.setPlaybarOptions("compact",{imageRadius:r})}})]},{render:e.playbar.type==="normal",name:"Normal Playbar",key:"group-playbar-normal",showName:!0,fields:[o("normalPbHeight",{type:"number",value:e.playbar.options.normal.height,validator:P,onChange:r=>{t.setPlaybarOptions("normal",{height:r})}}),o("normalPbBorderRad",{type:"number",value:e.playbar.options.normal.borderRadius,validator:P,onChange:r=>{t.setPlaybarOptions("normal",{borderRadius:r})}}),o("pbBackdropBlur",{type:"number",value:e.playbar.options.normal.backdropFilter.blur,validator:R,onChange:r=>{t.setPlaybarFilter("normal",{blur:r})}},e.playbar.isFloating),o("pbBackdropSat",{type:"number",value:e.playbar.options.normal.backdropFilter.saturate,validator:R,onChange:r=>{t.setPlaybarFilter("normal",{saturate:r})}},e.playbar.isFloating),o("pbBackdropBright",{type:"number",value:e.playbar.options.normal.backdropFilter.brightness,validator:R,onChange:r=>{t.setPlaybarFilter("normal",{brightness:r})}},e.playbar.isFloating),o("normalPbImgBorderRad",{type:"number",value:e.playbar.options.normal.imageRadius,validator:P,onChange:r=>{t.setPlaybarOptions("normal",{imageRadius:r})}})]}]},{name:"Advanced Settings",render:!0,groups:[{render:!0,name:"App Settings",key:"group-application-settings",showName:!1,fields:[o("showChangelog",{type:"checkbox",checked:e.showChangelog,onChange:r=>{t.setChangelog(r)}}),o("exportSettings",{type:"button",buttonType:"primary",contents:"Copy Settings",onClick:()=>{Mt(t.exportSettings(),"Settings copied to clipboard!")}}),o("importSettings",{type:"text",value:"",validator:r=>{try{return ge(JSON.parse(r))?{isValid:!0}:{isValid:!1,message:"Not a valid lucid settings."}}catch{return{isValid:!1,message:"Not a valid lucid settings."}}},onChange:r=>{t.importSettings(r)}}),o("resetSettings",{type:"button",buttonType:"danger",contents:"Reset",onClick:()=>{confirm("Are you sure you want to reset all settings to default values? This action cannot be undone.")&&(t.resetState(),window.location.reload())}})]}]}]}function $t(e=s.getState().rightSidebar){e.position?document.body.setAttribute("npv-position",e.position):document.body.removeAttribute("npv-position"),e.mode?document.body.setAttribute("npv-mode",e.mode):document.body.removeAttribute("npv-mode"),document.body.style.setProperty("--npv-blur",`${e.blur}px`),e.isCustomBg?document.body.style.setProperty("--npv-bg-color",`${e.color.hex}${I(e.color.alpha)}`):document.body.style.removeProperty("--npv-bg-color");function t(o){document.body.style.setProperty("--npv-size",`${o}px`)}t(e.size)}function Dt(){$t(),s.subscribe(e=>{$t(e.rightSidebar)},"rightSidebar")}var we=null;function Gt(e=s.getState().grains){let t=e.type;we!==t&&(we&&document.body.classList.remove(`grain-${we}`),t?(document.body.setAttribute("grain-type",t),document.body.classList.add(`grain-${t}`)):document.body.removeAttribute("grain-type"),we=t)}function zt(){Gt(),s.subscribe(e=>{Gt(e.grains)},"grains")}function Qo(e,t){let o=e.split(".").map(Number),r=t.split(".").map(Number),i=Math.max(o.length,r.length);for(let n=0;n<i;n++){let l=o[n]||0,c=r[n]||0;if(l>c)return 1;if(l<c)return-1}return 0}var ne=class extends HTMLElement{_data=null;_currentVersion;hasUpdate=!1;constructor(t){super(),this._currentVersion=W,t&&(this._data=t,this.hasUpdate=this.checkForUpdate())}connectedCallback(){h("lucid-changelog").textContent=".changelog-entry,.update-available-header {  padding: 1rem 1rem;  background-color: rgba(var(--clr-on-secondary-rgb), 0.5);  color: var(--clr-secondary);  margin-bottom: 0.5rem;  border-radius: 0.5rem;}.update-available-header {  text-align: center;  font-size: 1.8em;  color: var(--clr-primary);}.changelog-entry > p {  margin-bottom: 0.5rem;}.changes-wrapper {  display: flex;  flex-wrap: wrap;  gap: 0.5rem;}.changelog-entry,.update-available-header,.change-card {  border: var(--border-thickness, 1px) var(--border-style, solid)    var(--border-color, var(--clr-surface-5, #1c1b1e));}.change-card {  flex-grow: 1;  padding: 10px;  border-radius: 0.75rem;  min-width: 10em;}.change-card:nth-child(2n) {  background-color: rgba(var(--clr-on-primary-rgb), 0.7);  color: var(--clr-primary);}.change-card:nth-child(2n + 1) {  background-color: rgba(var(--clr-on-secondary-rgb), 0.7);  color: var(--clr-secondary);}.change-card:nth-child(2n + 3) {  background-color: rgba(var(--clr-on-tertiary-rgb), 0.7);  color: var(--clr-tertiary);}.change-card li {  list-style: disc;  margin-left: 2rem;}.change-card li:marker {  right: 4px;}",this.render()}checkForUpdate(){if(this._data&&this._data.length>0&&this._currentVersion){let t=this._data[0].version;return Qo(t,this._currentVersion)>0}return!1}render(){if(this.innerHTML="",!this._data){this.innerHTML="<p>Error loading changelog data.</p>",console.error("Invalid changelog data format.");return}if(this._data.length<1){this.innerHTML="<p>No changelog entries available.</p>",console.warn("No elements present to show changelog.");return}let t=this._data.map(i=>{let n="";for(let c in i.changes)if(Object.prototype.hasOwnProperty.call(i.changes,c)){let p=i.changes[c];if(p&&p.length>0){let N=p.map(Jt=>`<li>${Jt}</li>`).join("");n+=`
                    <div class="change-card">
                      <h3 class='encore-text encore-text-small-bold'>${c}</h3>
                      <ul>${N}</ul>
                    </div>
                  `}}let l=i.desc?`<p>${i.desc}</p>`:"";return`
              <div class="changelog-entry">
                <h2>${i.version} - ${i.date}</h2>
                ${l}
                <div class="changes-wrapper">
                  ${n}
                </div>
              </div>
            `}).join(""),o="";this.hasUpdate&&(o='<h1 class="update-available-header">Update Available</h1>');let r=document.createElement("div");r.innerHTML=`
        ${o}
        <div class="changelog-entries-container">${t}</div>`,this.appendChild(r)}updateData(t){this._data=t,this.hasUpdate=this.checkForUpdate(),this.render()}};customElements.define("changelog-component",ne);async function jo(){try{let e=await $(We,pe,21600);return JSON.parse(e)}catch(e){return console.error("Error fetching changelog.",e),[]}}async function Wt(e=document.body){if(!s.getState().showChangelog)return;let t=await jo();if(typeof t=="object"&&t.length<1){console.error("Changelog data not found.");return}let o=new H;o.setHeader("Lucid Changelog");let r=new ne(t);!(localStorage.getItem(A)===W)||r.hasUpdate?(o.setContent(r),e.appendChild(o),o.open(),localStorage.setItem(A,W)):console.debug("Changelog already shown for this version.")}var Kt=()=>{window.lucid={config:()=>s.getState(),reset:()=>{s.resetState()},store:s,version:localStorage.getItem(A)??"2.1.1",settings:{openSettings:Ce,closeSettings:Ne,settingModal:O}}};function Ve(e=s.getState()){let t=e.border,o=h("lucid-border");o.textContent=":root{",o.textContent+=`--border-color:${t.color.hex}${I(t.color.alpha)};`,t.style&&(o.textContent+=`--border-style:${t.style};`),t.thickness&&(o.textContent+=`--border-thickness:${t.thickness}px;`),o.textContent+="}"}s.subscribe(Ve,"border");function qt(e){let t=e.match(/url\(["']?(.*?)["']?\)/);return t?t[1]:null}var ae=class extends HTMLElement{imgElement;transitionDuration=.5;filter="blur(0px)";transitionTimingFunction="ease-in-out";constructor(t){super(),t&&(this.imageSrc=t),Object.assign(this.style,{width:"100%",height:"100%",display:"block",willChange:"transform"}),this.imgElement=a("img",{className:"umv-img",style:{filter:this.filter,opacity:"1",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}}),this.append(this.imgElement)}setFilter(t){this.style.filter=t}set imageSrc(t){if(!t){this.style.opacity="0";return}if(this.style.opacity="1",t.trim()===""||this.imgElement.src===t)return;let o=new Image;o.onload=()=>{this._performTransition(t)},o.onerror=()=>{console.error("Failed to load image:",t)},o.src=t}_performTransition(t){if(this.imgElement.src===t)return;let o=this.imgElement,r=a("img",{className:"umv-img",style:{width:"100%",height:"100%",objectPosition:"center",position:"absolute",top:"0",left:"0",objectFit:"cover",filter:this.filter,opacity:"0",transform:"scale(1.05)",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}, transform ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}});r.src=t,this.appendChild(r),requestAnimationFrame(()=>{r.style.opacity="1",r.style.transform="scale(1)"}),o.style.opacity="0",o.style.transform="scale(0.95)",setTimeout(()=>{this.imgElement.remove(),this.imgElement=r},this.transitionDuration*1e3)}hideImage(){this.imgElement.style.opacity="0"}unhideImage(){this.imgElement.style.opacity="1"}};customElements.define("umv-image",ae);var er=".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]",tr="umv-overrides",or=".Root__main-view",Yt=".under-main-view",rr=".main-entityHeader-gradient, .XUwMufC5NCgIyRMyGXLD",ir=`
  .under-main-view { display: none; }
  umv-container {
    width: 100%;
    display: block;
    position: absolute;
    inset: 0px;
    height: 50cqh;
    -webkit-mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    transform: translate3d(0px, 0px, 0px) scale(1);
    will-change: transform;
  }
  umv-container[source="expanded"] {
    height: calc(100cqh - var(--umv-offset, 526px));
    transform: translate3d(0px, 0px, 0px) scale(1);
    -webkit-mask-image: none;
    mask-image: none;
  }
  .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset) - 1rem);
  }
  body[npb-is-floating] .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset));
  }
  .main-entityHeader-container{ height: 40cqh; }
  .main-entityHeader-backgroundColor,.main-actionBarBackground-background { background: none !important;}
  .playlist-playlist-playlistContent,.EmeHQXR87mUskYK6xEde { background-color: rgba(var(--clr-surface-1-rgb),.5) !important; }
`,se=class extends HTMLElement{umvImage;scrollElem;mainViewElement;_source;_imageUrl;_settings;_isNpv=!1;isArtist=!1;options;pageUrl;umvArtUrl;pageArtUrl;unlistenHistory;unobserveUMV;unsubscribeNPV;constructor(){super();let t=h(tr);t.textContent=ir,this.mainViewElement=null,this.umvImage=new ae,this.append(this.umvImage),this._source="normal",this._imageUrl=null,this.pageUrl="",this._settings=null,this.settings=s.getState().pages.umv,s.subscribe(o=>{this.settings=o.pages.umv},"pages.umv"),this.scrollElem=null,this.umvArtUrl=null,this.pageArtUrl=null,this.unsubscribeNPV=null}connectedCallback(){T([or],([t])=>{this.mainViewElement=t}),T([er],([t])=>{this.scrollElem=t,this._scrollEventCb=this._scrollEventCb.bind(this),this._listenScrollChange()}),this._listenForUMVChange(),this.updateImageUrlFromPage(Spicetify?.Platform?.History?.location?.pathname||"/")}disconnectedCallback(){this.scrollElem&&this.scrollElem.removeEventListener("scroll",this._scrollEventCb),this.unobserveUMV&&this.unobserveUMV(),this.unlistenHistory&&this.unlistenHistory(),this.unsubscribeNPV&&(this.unsubscribeNPV(),this.unsubscribeNPV=null)}set settings(t){this._settings=t,this.options=t.options[this._source],t.type==="npv"?this.isNpv=!0:this.isNpv=!1,this._scrollEventCb()}get settings(){return this._settings??s.getState().pages.umv}set isNpv(t){if(this._isNpv=t,!t){this.unsubscribeNPV?.(),this.unsubscribeNPV=null,this._updateImageBasedOnUrls();return}this._updateImageBasedOnUrls(),this.unsubscribeNPV=S.subscribe(()=>{this._updateImageBasedOnUrls()})}get isNpv(){return this._isNpv}set source(t){this._source=t,this.setAttribute("source",t),this.isArtist=document.body.getAttribute("path")?.startsWith("artist",1)??!1,this.options=this.settings.options[t],this.umvImage.setFilter(`blur(${this.settings.options[t].filter?.blur??0}px)`),this._scrollEventCb()}get source(){return this._source}set imageUrl(t){t!==this._imageUrl&&(this._imageUrl=t,this.umvImage.imageSrc=t)}async updateImageUrlFromPage(t){try{let o=null;if(o==="/"){this.pageArtUrl=null,this._updateImageBasedOnUrls();return}t&&(o=await at(t)),this.pageArtUrl=o,this._updateImageBasedOnUrls()}catch(o){console.error("Error updating image URL from page:",o),console.error("URL that caused the error:",t)}}_listenForPageChanges(){this.pageUrl=Spicetify?.Platform?.History?.location?.pathname||"/",this.unlistenHistory=Spicetify.Platform?.History?.listen(t=>{t?.pathname&&(this.pageUrl=t.pathname,this.umvArtUrl=null,this.pageArtUrl=null,this.updateImageUrlFromPage(t.pathname))})??(()=>{console.error("Error unloading History listener. Spicetify.Platform?.History might be undefined.")})}_observeUMVImage(){let t=document.querySelector(Yt);if(!t)return console.warn(`Element "${Yt}" not found. UMV observation will not work.`),null;let o=()=>{let i=t.querySelector(rr);if(i){let n=qt(i.style.backgroundImage);n?this.umvArtUrl=n:this.umvArtUrl=null,this._updateImageBasedOnUrls()}else this.umvArtUrl=null,this._updateImageBasedOnUrls()},r=new MutationObserver(o);r.observe(t,{childList:!0,subtree:!0}),this.unobserveUMV=()=>r.disconnect()}_listenForUMVChange(){this._listenForPageChanges(),this._observeUMVImage()}_scrollEventCb(t){if(!this.settings)return;let o=this.scrollElem?.scrollTop??t?.target?.scrollTop??0,r=this.settings.options[this.source];o<100&&document.body.style.setProperty("--changing-pixels",`${Math.random().toFixed(1)}px`),requestAnimationFrame(()=>{r.isScaling?this.umvImage.style.transform=`scale(${Math.round(Math.min(100+o/10,175))}%)`:this.umvImage.style.transform="scale(1)",r.isScroll?this.style.transform=`translate3d(0px,-${Math.min(o,window.innerHeight)}px,0px)`:this.style.transform="translate3d(0px,0px,0px)";let i=Math.min(o/10+(r.filter?.blur||0),this.isArtist?o/10:32),n=Math.max(60,100-o/window.innerHeight*40),l=Math.max(70,100-o/window.innerHeight*30);this.umvImage.setFilter(`blur(${i}px) brightness(${n}%) opacity(${l}%)`)}),o>window.innerHeight/5?this.mainViewElement?.style.setProperty("--top-bar-opacity","1"):this.mainViewElement?.style.setProperty("--top-bar-opacity","0")}_listenScrollChange(){this.scrollElem&&this.scrollElem.addEventListener("scroll",this._scrollEventCb)}_updateImageBasedOnUrls(){if(this.umvArtUrl){this.imageUrl=this.umvArtUrl,this.source="expanded";return}if(this.settings.type==="custom"){this.source="custom",this.imageUrl=this.settings.options.custom.url;return}if(this.isNpv&&this.pageArtUrl){this.imageUrl=S.getState().url,this.source="npv";return}if(this.pageArtUrl){this.imageUrl=this.pageArtUrl,this.source="normal";return}this.imageUrl=null,this.source="normal"}};customElements.define("umv-container",se);function Zt(){T([".Root__now-playing-bar",".Root__globalNav"],([o,r])=>{document.body.style.setProperty("--umv-offset",`${(o?.clientHeight||80)+(r?.clientHeight||64)}px`)});let e=new se,t=document.querySelector(".under-main-view")?.parentElement;t?t.prepend(e):document.querySelector(".main-view-container")?.prepend(e)}var nr=()=>{try{Kt(),setTimeout(Zt,500),Ve(),Ht(),qe(),ot(),zt(),Le(),gt(),bt(),vt(),Dt(),Be(),s.subscribe(e=>{Be(e.color)},"color"),Vt(),_e(),Wt()}catch(e){console.error("Unexpected Error: ",e),d("Lucid: Unexpected error. please report it to dev")}};console.time("Main fn start");nr();console.timeEnd("Main fn start");})();
})();